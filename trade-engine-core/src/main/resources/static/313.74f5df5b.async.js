(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[313],{41344:function(te,Rt,G){"use strict";var et=G(67294),V=G(12758),x=G(16980);function S(){return S=Object.assign||function(O){for(var T=1;T<arguments.length;T++){var z=arguments[T];for(var I in z)Object.prototype.hasOwnProperty.call(z,I)&&(O[I]=z[I])}return O},S.apply(this,arguments)}function b(O,T){var z=Object.keys(O);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(O);T&&(I=I.filter(function(E){return Object.getOwnPropertyDescriptor(O,E).enumerable})),z.push.apply(z,I)}return z}function _(O){for(var T=1;T<arguments.length;T++){var z=arguments[T]!=null?arguments[T]:{};T%2?b(Object(z),!0).forEach(function(I){$(O,I,z[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(z)):b(Object(z)).forEach(function(I){Object.defineProperty(O,I,Object.getOwnPropertyDescriptor(z,I))})}return O}function $(O,T,z){return T in O?Object.defineProperty(O,T,{value:z,enumerable:!0,configurable:!0,writable:!0}):O[T]=z,O}var A=function(T,z){var I=T.fieldProps,E=T.min,B=T.proFieldProps,pt=T.max;return et.createElement(V.ZP,S({mode:"edit",valueType:"digit",fieldProps:_({min:E,max:pt},I),ref:z},B))};Rt.Z=(0,x.Z)(et.forwardRef(A),{defaultProps:{width:"100%"}})},45545:function(te,Rt,G){"use strict";var et=G(55614),V=G(37455),x=G(67294),S=G(12758),b=G(10623),_=G(16980);function $(){return $=Object.assign||function(f){for(var k=1;k<arguments.length;k++){var w=arguments[k];for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(f[C]=w[C])}return f},$.apply(this,arguments)}function A(f,k){var w=Object.keys(f);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(f);k&&(C=C.filter(function(N){return Object.getOwnPropertyDescriptor(f,N).enumerable})),w.push.apply(w,C)}return w}function O(f){for(var k=1;k<arguments.length;k++){var w=arguments[k]!=null?arguments[k]:{};k%2?A(Object(w),!0).forEach(function(C){T(f,C,w[C])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(w)):A(Object(w)).forEach(function(C){Object.defineProperty(f,C,Object.getOwnPropertyDescriptor(w,C))})}return f}function T(f,k,w){return k in f?Object.defineProperty(f,k,{value:w,enumerable:!0,configurable:!0,writable:!0}):f[k]=w,f}function z(f,k){if(f==null)return{};var w=I(f,k),C,N;if(Object.getOwnPropertySymbols){var Z=Object.getOwnPropertySymbols(f);for(N=0;N<Z.length;N++)C=Z[N],!(k.indexOf(C)>=0)&&(!Object.prototype.propertyIsEnumerable.call(f,C)||(w[C]=f[C]))}return w}function I(f,k){if(f==null)return{};var w={},C=Object.keys(f),N,Z;for(Z=0;Z<C.length;Z++)N=C[Z],!(k.indexOf(N)>=0)&&(w[N]=f[N]);return w}var E=x.forwardRef(function(f,k){var w=f.fieldProps,C=f.options,N=f.radioType,Z=f.layout,Lt=f.proFieldProps,Ot=f.valueEnum,K=z(f,["fieldProps","options","radioType","layout","proFieldProps","valueEnum"]);return x.createElement(S.ZP,$({mode:"edit",valueType:N==="button"?"radioButton":"radio",ref:k,valueEnum:(0,b.h)(Ot,void 0)},K,{fieldProps:O({options:C,layout:Z},w)},Lt))}),B=x.forwardRef(function(f,k){var w=f.fieldProps,C=f.children;return x.createElement(V.ZP,$({},w,{ref:k}),C)}),pt=(0,_.Z)(B,{valuePropName:"checked",ignoreWidth:!0}),J=(0,_.Z)(E,{customLightMode:!0}),F=pt;F.Group=J,F.Button=V.ZP.Button,Rt.Z=F},41561:function(te,Rt,G){te.exports=function(et){var V={};function x(S){if(V[S])return V[S].exports;var b=V[S]={i:S,l:!1,exports:{}};return et[S].call(b.exports,b,b.exports,x),b.l=!0,b.exports}return x.m=et,x.c=V,x.d=function(S,b,_){x.o(S,b)||Object.defineProperty(S,b,{enumerable:!0,get:_})},x.r=function(S){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(S,"__esModule",{value:!0})},x.t=function(S,b){if(1&b&&(S=x(S)),8&b||4&b&&typeof S=="object"&&S&&S.__esModule)return S;var _=Object.create(null);if(x.r(_),Object.defineProperty(_,"default",{enumerable:!0,value:S}),2&b&&typeof S!="string")for(var $ in S)x.d(_,$,function(A){return S[A]}.bind(null,$));return _},x.n=function(S){var b=S&&S.__esModule?function(){return S.default}:function(){return S};return x.d(b,"a",b),b},x.o=function(S,b){return Object.prototype.hasOwnProperty.call(S,b)},x.p="",x(x.s=2)}([function(et,V){et.exports=G(67294)},function(et,V,x){"use strict";et.exports=function S(b,_){if(b===_)return!0;if(b&&_&&typeof b=="object"&&typeof _=="object"){if(b.constructor!==_.constructor)return!1;var $,A,O;if(Array.isArray(b)){if(($=b.length)!=_.length)return!1;for(A=$;A--!=0;)if(!S(b[A],_[A]))return!1;return!0}if(b.constructor===RegExp)return b.source===_.source&&b.flags===_.flags;if(b.valueOf!==Object.prototype.valueOf)return b.valueOf()===_.valueOf();if(b.toString!==Object.prototype.toString)return b.toString()===_.toString();if(($=(O=Object.keys(b)).length)!==Object.keys(_).length)return!1;for(A=$;A--!=0;)if(!Object.prototype.hasOwnProperty.call(_,O[A]))return!1;for(A=$;A--!=0;){var T=O[A];if(!S(b[T],_[T]))return!1}return!0}return b!=b&&_!=_}},function(et,V,x){"use strict";x.r(V),x.d(V,"CrosshairMode",function(){return ne}),x.d(V,"LineStyle",function(){return $}),x.d(V,"LineType",function(){return _}),x.d(V,"PriceLineSource",function(){return de}),x.d(V,"PriceScaleMode",function(){return fe}),x.d(V,"createChart",function(){return Oi}),x.d(V,"isBusinessDay",function(){return Pt}),x.d(V,"isUTCTimestamp",function(){return Yt}),x.d(V,"version",function(){return kr});var S=x(0),b=x.n(S),_,$,A,O=function(){function i(t){var e=this;this._resolutionMediaQueryList=null,this._resolutionListener=function(n){return e._onResolutionChanged()},this._canvasConfiguredListeners=[],this.canvas=t,this._canvasSize={width:this.canvas.clientWidth,height:this.canvas.clientHeight},this._configureCanvas(),this._installResolutionListener()}return i.prototype.destroy=function(){this._canvasConfiguredListeners.length=0,this._uninstallResolutionListener(),this.canvas=null},Object.defineProperty(i.prototype,"canvasSize",{get:function(){return{width:this._canvasSize.width,height:this._canvasSize.height}},enumerable:!0,configurable:!0}),i.prototype.resizeCanvas=function(t){this._canvasSize={width:t.width,height:t.height},this._configureCanvas()},Object.defineProperty(i.prototype,"pixelRatio",{get:function(){var e=this.canvas.ownerDocument.defaultView;if(e==null)throw new Error("No window is associated with the canvas");return e.devicePixelRatio},enumerable:!0,configurable:!0}),i.prototype.subscribeCanvasConfigured=function(t){this._canvasConfiguredListeners.push(t)},i.prototype.unsubscribeCanvasConfigured=function(t){this._canvasConfiguredListeners=this._canvasConfiguredListeners.filter(function(e){return e!=t})},i.prototype._configureCanvas=function(){var t=this.pixelRatio;this.canvas.style.width=this._canvasSize.width+"px",this.canvas.style.height=this._canvasSize.height+"px",this.canvas.width=this._canvasSize.width*t,this.canvas.height=this._canvasSize.height*t,this._emitCanvasConfigured()},i.prototype._emitCanvasConfigured=function(){var t=this;this._canvasConfiguredListeners.forEach(function(e){return e.call(t)})},i.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this.canvas.ownerDocument.defaultView;if(t==null)throw new Error("No window is associated with the canvas");var e=t.devicePixelRatio;this._resolutionMediaQueryList=t.matchMedia("all and (resolution: "+e+"dppx)"),this._resolutionMediaQueryList.addListener(this._resolutionListener)},i.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},i.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},i.prototype._onResolutionChanged=function(){this._configureCanvas(),this._reinstallResolutionListener()},i}();/*!
 * @license
 * TradingView Lightweight Charts v2.0.0
 * Copyright (c) 2019 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */function T(i,t){var e,n=((e={})[0]=[],e[1]=[i.lineWidth,i.lineWidth],e[2]=[2*i.lineWidth,2*i.lineWidth],e[3]=[6*i.lineWidth,6*i.lineWidth],e[4]=[i.lineWidth,4*i.lineWidth],e)[t];i.setLineDash(n)}function z(i,t,e,n){i.beginPath();var r=i.lineWidth%2?.5:0;i.moveTo(e,t+r),i.lineTo(n,t+r),i.stroke()}(A=_||(_={}))[A.Simple=0]="Simple",A[A.WithSteps=1]="WithSteps",function(i){i[i.Solid=0]="Solid",i[i.Dotted=1]="Dotted",i[i.Dashed=2]="Dashed",i[i.LargeDashed=3]="LargeDashed",i[i.SparseDotted=4]="SparseDotted"}($||($={}));var I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])})(t,e)};function E(i,t){function e(){this.constructor=i}I(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var B=function(){return(B=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function pt(){for(var i=0,t=0,e=arguments.length;t<e;t++)i+=arguments[t].length;var n=Array(i),r=0;for(t=0;t<e;t++)for(var s=arguments[t],o=0,h=s.length;o<h;o++,r++)n[r]=s[o];return n}function J(i,t){if(!i)throw new Error("Assertion failed"+(t?": "+t:""))}function F(i){if(i===void 0)throw new Error("Value is undefined");return i}function f(i){if(i===null)throw new Error("Value is null");return i}function k(i){return f(F(i))}function w(i){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var n=0,r=t;n<r.length;n++){var s=r[n];for(var o in s)s[o]!==void 0&&(typeof s[o]!="object"||i[o]===void 0?i[o]=s[o]:w(i[o],s[o]))}return i}function C(i){return typeof i=="number"&&isFinite(i)}function N(i){return typeof i=="number"&&i%1==0}function Z(i){return typeof i=="string"}function Lt(i){return!(i<=0||i>0)}function Ot(i){return typeof i=="boolean"}function K(i){var t,e,n,r=i;if(!r||typeof r!="object")return r;for(e in t=Array.isArray(r)?[]:{},r)r.hasOwnProperty(e)&&(n=r[e],t[e]=n&&typeof n=="object"?K(n):n);return t}function Hi(i){return i!==null}function Ft(i){return i===null?void 0:i}var Vt,zt,At,Bt,ee=function(){function i(){this.t=[]}return i.prototype.setRenderers=function(t){this.t=t},i.prototype.draw=function(t,e,n,r){this.t.forEach(function(s){t.save(),s.draw(t,e,n,r),t.restore()})},i}(),bt=function(){function i(){}return i.prototype.draw=function(t,e,n,r){t.save(),t.scale(e,e),this._drawImpl(t,n,r),t.restore()},i.prototype.drawBackground=function(t,e,n,r){t.save(),t.scale(e,e),this._drawBackgroundImpl(t,n,r),t.restore()},i.prototype._drawBackgroundImpl=function(t,e,n){},i}(),Ki=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._data=null,e}return E(t,i),t.prototype.setData=function(e){this._data=e},t.prototype._drawImpl=function(e){if(this._data!==null&&this._data.visibleRange!==null){var n=this._data.visibleRange,r=this._data,s=function(h){e.beginPath();for(var a=n.to-1;a>=n.from;--a){var u=r.items[a];e.moveTo(u.x,u.y),e.arc(u.x,u.y,h,0,2*Math.PI)}e.fill()};e.fillStyle=r.backColor,s(r.radius+2),e.fillStyle=r.lineColor,s(r.radius)}},t}(bt),qi={from:0,to:1},Xi=function(){function i(t,e){this.i=new ee,this.s=[],this.u=[],this.o=!0,this.l=t,this.v=e,this.i.setRenderers(this.s)}return i.prototype.update=function(t){var e=this,n=this.l.serieses();n.length!==this.s.length&&(this.u=n.map(function(){return{items:[{x:0,y:0,time:0,price:0}],lineColor:"",backColor:e.l.options().layout.backgroundColor,radius:0,visibleRange:null}}),this.s=this.u.map(function(r){var s=new Ki;return s.setData(r),s}),this.i.setRenderers(this.s)),this.o=!0},i.prototype.renderer=function(t,e,n){return this.o&&(this.M(),this.o=!1),this.i},i.prototype.M=function(){var t=this,e=this.l.serieses(),n=this.v.appliedIndex(),r=this.l.timeScale();e.forEach(function(s,o){var h=t.u[o],a=s.markerDataAtIndex(n);if(a!==null){var u=f(s.firstValue());h.lineColor=s.barColorer().barStyle(n).barColor,h.backColor=t.l.options().layout.backgroundColor,h.radius=a.radius,h.items[0].price=a.price,h.items[0].y=s.priceScale().priceToCoordinate(a.price,u.value),h.items[0].time=n,h.items[0].x=r.indexToCoordinate(n),h.visibleRange=qi}else h.visibleRange=null})},i}(),Ji=function(){function i(t){this.m=t}return i.prototype.draw=function(t,e,n,r){if(this.m!==null){var s=this.m.vertLine.visible,o=this.m.horzLine.visible;if(s||o){t.save();var h=Math.round(this.m.x*e),a=Math.round(this.m.y*e),u=Math.ceil(this.m.w*e),l=Math.ceil(this.m.h*e);t.lineCap="butt",s&&h>=0&&(t.lineWidth=Math.floor(this.m.vertLine.lineWidth*e),t.strokeStyle=this.m.vertLine.color,t.fillStyle=this.m.vertLine.color,T(t,this.m.vertLine.lineStyle),function(c,p,d,y){c.beginPath();var v=c.lineWidth%2?.5:0;c.moveTo(p+v,0),c.lineTo(p+v,y),c.stroke()}(t,h,0,l)),o&&a>=0&&(t.lineWidth=Math.floor(this.m.horzLine.lineWidth*e),t.strokeStyle=this.m.horzLine.color,t.fillStyle=this.m.horzLine.color,T(t,this.m.horzLine.lineStyle),z(t,a,0,u)),t.restore()}}},i}(),Zi=function(){function i(t){this.o=!0,this.p={vertLine:{lineWidth:1,lineStyle:0,color:"",visible:!1},horzLine:{lineWidth:1,lineStyle:0,color:"",visible:!1},w:0,h:0,x:0,y:0},this.g=new Ji(this.p),this.k=t}return i.prototype.update=function(){this.o=!0},i.prototype.renderer=function(t,e){return this.o&&this.M(),this.g},i.prototype.M=function(){var t=this.k.visible(),e=f(this.k.pane()),n=e.model().options().crosshair,r=this.p;r.horzLine.visible=t&&this.k.horzLineVisible(e),r.vertLine.visible=t&&this.k.vertLineVisible(),r.horzLine.lineWidth=n.horzLine.width,r.horzLine.lineStyle=n.horzLine.style,r.horzLine.color=n.horzLine.color,r.vertLine.lineWidth=n.vertLine.width,r.vertLine.lineStyle=n.vertLine.style,r.vertLine.color=n.vertLine.color,r.w=e.width(),r.h=e.height(),r.x=this.k.appliedX(),r.y=this.k.appliedY()},i}(),De={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function tt(i){return Lt(t=i)||t<0?0:t>255?255:Math.round(t);var t}function Re(i){return Lt(t=i)||t<0?0:t>1?1:Math.round(1e4*t)/1e4;var t}function ie(i){var t=function(e){(e=e.toLowerCase())in De&&(e=De[e]);var n,r,s=(n=e,(r=At.re.exec(n))!==null?At.parse(r):null);if(s!==null)return s;var o=function(u){var l=zt.re.exec(u);return l!==null?zt.parse(l):null}(e);if(o!==null)return o;var h=function(u){var l=Vt.re.exec(u);return l!==null?Vt.parse(l):null}(e);if(h!==null)return h;var a=function(u){var l=Bt.re.exec(u);return l!==null?Bt.parse(l):null}(e);return a!==null?[a[0],a[1],a[2]]:null}(i);if(t!==null)return t;throw new Error("Passed color string "+i+" does not match any of the known color representations")}function Le(i,t){if(t<0||t>255)throw new Error("invalid threshold value, valid values are [0, 255]");return function(e){return .199*e[0]+.687*e[1]+.114*e[2]}(i)>=t?"white":"black"}function St(i){return Le(ie(i),160)==="black"?"white":"black"}function Qi(i,t,e,n,r,s){i.fillRect(t,e,s,r),i.fillRect(t+s,e,n-2*s,s),i.fillRect(t+s,e+r-s,n-2*s,s),i.fillRect(t+n-s,e,s,r)}function rt(i,t,e){i.save(),i.scale(t,t),e(),i.restore()}function It(i,t,e,n,r,s){i.save(),i.globalCompositeOperation="copy",i.fillStyle=s,i.fillRect(t,e,n,r),i.restore()}(function(i){i.re=/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/,i.parse=function(t){return[tt(parseInt(t[1]+t[1],16)),tt(parseInt(t[2]+t[2],16)),tt(parseInt(t[3]+t[3],16))]}})(Vt||(Vt={})),function(i){i.re=/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,i.parse=function(t){return[tt(parseInt(t[1],16)),tt(parseInt(t[2],16)),tt(parseInt(t[3],16))]}}(zt||(zt={})),function(i){i.re=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,i.parse=function(t){return[tt(parseInt(t[1],10)),tt(parseInt(t[2],10)),tt(parseInt(t[3],10))]}}(At||(At={})),function(i){i.re=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/,i.parse=function(t){return[tt(parseInt(t[1],10)),tt(parseInt(t[2],10)),tt(parseInt(t[3],10)),Re(parseFloat(t[4]))]}}(Bt||(Bt={}));var ne,Oe=function(){function i(t,e){this.setData(t,e)}return i.prototype.setData=function(t,e){this.m=t,this.N=e},i.prototype.draw=function(t,e,n,r,s,o){if(this.m.visible){t.font=e.font;var h=this.m.tickVisible?e.tickLength:0,a=e.borderSize,u=e.paddingTop,l=e.paddingBottom,c=e.paddingInner,p=e.paddingOuter,d=this.m.text,y=Math.ceil(n.measureText(t,d)),v=e.baselineOffset,m=e.fontSize+u+l,g=Math.ceil(.5*m),M=a+y+c+p+h,R=this.N.coordinate;this.N.fixedCoordinate&&(R=this.N.fixedCoordinate);var P,L,Q=(R=Math.round(R))-g,ct=Q+m,mt=s==="right",gt=mt?r:0,Wi=Math.ceil(r*o),Te=gt;if(t.fillStyle=function(Ee){return function(Ar){return Ar.indexOf("#")===0}(Ee)?Ee:"rgba("+(Gt=[(ke=ie(Ee))[0],ke[1],ke[2],Re(1)])[0]+", "+Gt[1]+", "+Gt[2]+", "+Gt[3]+")";var Gt,ke}(this.N.background),t.lineWidth=1,t.lineCap="butt",d){mt?(P=gt-h,L=(Te=gt-M)+p):(Te=gt+M,P=gt+h,L=gt+a+h+c);var Ui=Math.max(1,Math.floor(o)),ji=Math.max(1,Math.floor(a*o)),Qt=mt?Wi:0,Dt=Math.round(Q*o),Yi=Math.round(Te*o),Pe=Math.round(R*o)-Math.floor(.5*o),_e=Pe+Ui+(Pe-Dt),zr=Math.round(P*o);t.save(),t.beginPath(),t.moveTo(Qt,Dt),t.lineTo(Yi,Dt),t.lineTo(Yi,_e),t.lineTo(Qt,_e),t.fill(),t.fillStyle=this.m.borderColor,t.fillRect(mt?Wi-ji:0,Dt,ji,_e-Dt),this.m.tickVisible&&(t.fillStyle=this.N.color,t.fillRect(Qt,Pe,zr-Qt,Ui)),t.textAlign="left",t.fillStyle=this.N.color,rt(t,o,function(){t.fillText(d,L,ct-l-v)}),t.restore()}}},i.prototype.height=function(t,e){return this.m.visible?t.fontSize+t.paddingTop+t.paddingBottom:0},i}(),re=function(){function i(t){this.S={coordinate:0,color:"#FFF",background:"#000"},this.D={text:"",visible:!1,tickVisible:!0,borderColor:""},this.C={text:"",visible:!1,tickVisible:!1,borderColor:""},this.o=!0,this.T=new(t||Oe)(this.D,this.S),this.L=new(t||Oe)(this.C,this.S)}return i.prototype.text=function(){return this.D.text},i.prototype.background=function(){return this.S.background},i.prototype.color=function(){return St(this.background())},i.prototype.coordinate=function(){return this.A(),this.S.coordinate},i.prototype.update=function(){this.o=!0},i.prototype.height=function(t,e){return e===void 0&&(e=!1),Math.max(this.T.height(t,e),this.L.height(t,e))},i.prototype.getFixedCoordinate=function(){return this.S.fixedCoordinate||0},i.prototype.setFixedCoordinate=function(t){this.S.fixedCoordinate=t},i.prototype.isVisible=function(){return this.A(),this.D.visible||this.C.visible},i.prototype.isAxisLabelVisible=function(){return this.A(),this.D.visible},i.prototype.isPaneLabelVisible=function(){return this.A(),this.C.visible},i.prototype.renderer=function(){return this.A(),this.T.setData(this.D,this.S),this.L.setData(this.C,this.S),this.T},i.prototype.paneRenderer=function(){return this.A(),this.T.setData(this.D,this.S),this.L.setData(this.C,this.S),this.L},i.prototype.A=function(){this.o&&(this._updateRendererData(this.D,this.C,this.S),this.o=!1)},i}(),Gi=function(i){function t(e,n,r){var s=i.call(this)||this;return s.k=e,s.B=n,s.V=r,s}return E(t,i),t.prototype._updateRendererData=function(e,n,r){e.visible=!1;var s=this.k.options().horzLine;if(s.labelVisible){var o=this.B.firstValue();if(this.k.visible()&&!this.B.isEmpty()&&o!==null){r.background=s.labelBackgroundColor,r.color=St(s.labelBackgroundColor);var h=this.V(this.B);r.coordinate=h.coordinate,e.text=this.B.formatPrice(h.price,o),e.visible=!0}}},t}(re),tn=/[1-9]/g,en=function(){function i(){this.m=null}return i.prototype.setData=function(t){this.m=t},i.prototype.draw=function(t,e,n){var r=this;if(this.m!==null&&this.m.visible!==!1&&this.m.text.length!==0){t.font=e.font;var s=Math.round(e.widthCache.measureText(t,this.m.text,tn));if(!(s<=0)){t.save();var o=e.paddingHorizontal,h=s+2*o,a=h/2,u=this.m.width,l=this.m.coordinate,c=Math.floor(l-a)+.5;c<0?(l+=Math.abs(0-c),c=Math.floor(l-a)+.5):c+h>u&&(l-=Math.abs(u-(c+h)),c=Math.floor(l-a)+.5);var p=c+h,d=0+e.borderSize+e.paddingTop+e.fontSize+e.paddingBottom;t.fillStyle=this.m.background;var y=Math.round(c*n),v=Math.round(0*n),m=Math.round(p*n),g=Math.round(d*n);t.fillRect(y,v,m-y,g-v);var M=Math.round(this.m.coordinate*n),R=v,P=Math.round((R+e.borderSize+e.tickLength)*n);t.fillStyle=this.m.color;var L=Math.max(1,Math.floor(n)),Q=Math.floor(.5*n);t.fillRect(M-Q,R,L,P-R);var ct=d-e.baselineOffset-e.paddingBottom;t.textAlign="left",t.fillStyle=this.m.color,rt(t,n,function(){t.fillText(f(r.m).text,c+o,ct)}),t.restore()}}},i}(),nn=function(i){function t(e,n,r){var s=i.call(this)||this;return s.o=!0,s.g=new en,s.p={visible:!1,background:"#4c525e",color:"white",text:"",width:0,coordinate:NaN},s.v=e,s.F=n,s.V=r,s}return E(t,i),t.prototype.update=function(){this.o=!0},t.prototype.renderer=function(){return this.o&&(this.M(),this.o=!1),this.g.setData(this.p),this.g},t.prototype.M=function(){var e=this.p;e.visible=!1;var n=this.v.options().vertLine;if(n.labelVisible){var r=this.F.timeScale();if(!r.isEmpty()){var s=r.indexToUserTime(this.v.appliedIndex());e.width=r.width();var o=this.V();o.time&&(e.coordinate=o.coordinate,e.text=r.formatDateTime(f(s)),e.visible=!0,e.background=n.labelBackgroundColor,e.color=St(n.labelBackgroundColor))}}},t}(function(){function i(){this._text="",this._background="#585858",this._coordinate=0}return i.prototype.text=function(){return this._text},i.prototype.background=function(){return this._background},i.prototype.color=function(){return Le(ie(this._background),150)==="black"?"white":"black"},i.prototype.coordinate=function(){return this._coordinate},i}()),se=function(){function i(){this._priceScale=null,this.P=0}return i.prototype.zorder=function(){return this.P},i.prototype.setZorder=function(t){this.P=t},i.prototype.priceScale=function(){return this._priceScale},i.prototype.setPriceScale=function(t){this._priceScale=t},i.prototype.priceAxisViews=function(t,e){return[]},i.prototype.paneViews=function(t){return[]},i.prototype.timeAxisViews=function(){return[]},i}();(function(i){i[i.Normal=0]="Normal",i[i.Magnet=1]="Magnet"})(ne||(ne={}));var rn=function(i){function t(e,n){var r,s,o=i.call(this)||this;o.I=null,o.O=NaN,o.R=0,o.W=!0,o.U=new Map,o.q=!1,o.j=NaN,o.H=NaN,o.Y=NaN,o.K=NaN,o.F=e,o.$=n,o._=new Xi(e,o),o.X=(r=function(){return o.O},s=function(){return o.H},function(a){var u=s(),l=r();if(a===f(o.I).defaultPriceScale())return{price:l,coordinate:u};var c=f(a.firstValue());return{price:a.coordinateToPrice(u,c),coordinate:u}});var h=function(){return{time:o.F.timeScale().indexToUserTime(o.R),coordinate:o.appliedX()}};return o.Z=new nn(o,e,h),o.J=new Zi(o),o}return E(t,i),t.prototype.index=function(){return this.R},t.prototype.options=function(){return this.$},t.prototype.saveOriginCoord=function(e,n){this.Y=e,this.K=n},t.prototype.clearOriginCoord=function(){this.Y=NaN,this.K=NaN},t.prototype.originCoordX=function(){return this.Y},t.prototype.originCoordY=function(){return this.K},t.prototype.setPosition=function(e,n,r){this.q||(this.q=!0),this.W=!0,this.G(e,n,r)},t.prototype.appliedIndex=function(){return this.R},t.prototype.appliedX=function(){return this.j},t.prototype.appliedY=function(){return this.H},t.prototype.visible=function(){return this.W},t.prototype.clearPosition=function(){this.W=!1,this.tt(),this.O=NaN,this.j=NaN,this.H=NaN,this.I=null,this.clearOriginCoord()},t.prototype.paneViews=function(e){return this.I!==null?[this.J,this._]:[]},t.prototype.horzLineVisible=function(e){return e===this.I&&this.$.horzLine.visible},t.prototype.vertLineVisible=function(){return this.$.vertLine.visible},t.prototype.priceAxisViews=function(e,n){this.W&&this.I===e||this.U.clear();var r=[];return this.I===e&&r.push(this.it(this.U,n,this.X)),r},t.prototype.timeAxisViews=function(){return this.W?[this.Z]:[]},t.prototype.pane=function(){return this.I},t.prototype.updateAllViews=function(){this.U.forEach(function(e){return e.update()}),this.Z.update(),this._.update()},t.prototype.nt=function(e){return e&&!e.defaultPriceScale().isEmpty()?e.defaultPriceScale():null},t.prototype.G=function(e,n,r){this.st(e,n,r)&&this.updateAllViews()},t.prototype.st=function(e,n,r){var s=this.j,o=this.H,h=this.O,a=this.R,u=this.I,l=this.nt(r);this.R=e,this.j=isNaN(e)?NaN:this.F.timeScale().indexToCoordinate(e),this.I=r;var c=l!==null?l.firstValue():null;return l!==null&&c!==null?(this.O=n,this.H=l.priceToCoordinate(n,c)):(this.O=NaN,this.H=NaN),s!==this.j||o!==this.H||a!==this.R||h!==this.O||u!==this.I},t.prototype.tt=function(){var e=this.F.serieses().map(function(r){return r.bars().lastIndex()}).filter(Hi),n=e.length===0?null:Math.max.apply(Math,e);this.R=n!==null?n:NaN},t.prototype.it=function(e,n,r){var s=e.get(n);return s===void 0&&(s=new Gi(this,n,r),e.set(n,s)),s},t}(se);function it(i,t){if(!C(i))return"n/a";if(!N(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?i.toString():("0000000000000000"+i.toString()).slice(-t)}var Fe,Nt=function(){function i(t,e,n,r){if(e||(e=1),C(t)&&N(t)||(t=100),t<0)throw new TypeError("invalid base");this.B=t,this.ht=e,this.rt=r,n&&r!==void 0&&r>0&&r!==2&&r!==4&&r!==8||(this.ut=n,this.et())}return i.prototype.format=function(t){var e=t<0?"\u2212":"";return t=Math.abs(t),this.ut?e+this.ot(t):e+this.ft(t)},i.prototype.et=function(){if(this._fractionalLength=0,this.B>0&&this.ht>0){var t=this.B;for(this.ut&&this.rt&&(t/=this.rt);t>1;)t/=10,this._fractionalLength++}},i.prototype.ft=function(t){var e;e=this.ut?Math.pow(10,this._fractionalLength||0):this.B/this.ht;var n=Math.floor(t),r="",s=this._fractionalLength!==void 0?this._fractionalLength:NaN;if(e>1){var o=+(Math.round(t*e)-n*e).toFixed(this._fractionalLength);o>=e&&(o-=e,n+=1),r="."+it(+o.toFixed(this._fractionalLength)*this.ht,s)}else n=Math.round(n*e)/e,s>0&&(r="."+it(0,s));return n.toFixed(0)+r},i.prototype.ot=function(t){var e=this.B/this.ht,n=Math.floor(t),r=Math.round(t*e)-n*e;if(r===e&&(r=0,n+=1),!this._fractionalLength)throw new Error("_fractionalLength is not calculated");var s="";if(this.rt){var o=r%this.rt;s=it(r=(r-o)/this.rt,this._fractionalLength)+"'"+(this.rt===2?["0","5"][o]:this.rt===8?["0","1","2","3","4","5","6","7"][o]:["0","2","5","7"][o])}else s=it(r*this.ht,this._fractionalLength);return n.toString()+"'"+s},i}(),Ve=function(i){function t(e){return e===void 0&&(e=100),i.call(this,e)||this}return E(t,i),t.prototype.format=function(e){return i.prototype.format.call(this,e)+"%"},t}(Nt),W=function(){function i(){this.at=[]}return i.prototype.subscribe=function(t,e,n){var r={callback:t,linkedObject:e,singleshot:n===!0};this.at.push(r)},i.prototype.unsubscribe=function(t){var e=this.at.findIndex(function(n){return t===n.callback});e>-1&&this.at.splice(e,1)},i.prototype.unsubscribeAll=function(t){this.at=this.at.filter(function(e){return e.linkedObject===t})},i.prototype.fire=function(t,e){var n=pt(this.at);this.at=this.at.filter(function(r){return!r.singleshot}),n.forEach(function(r){return r.callback(t,e)})},i.prototype.hasListeners=function(){return this.at.length>0},i.prototype.destroy=function(){this.at=[]},i}(),st=function(i){function t(e){var n=i.call(this)||this;return n.F=e,n}return E(t,i),t.prototype.model=function(){return this.F},t.prototype.minMove=function(){return 0},t.prototype.autoscaleInfo=function(e,n){return null},t}(se),ht=function(){function i(t,e){this.ct=t,this.lt=e}return i.prototype.equals=function(t){return t!==null&&this.ct===t.ct&&this.lt===t.lt},i.prototype.clone=function(){return new i(this.ct,this.lt)},i.prototype.minValue=function(){return this.ct},i.prototype.setMinValue=function(t){this.ct=t},i.prototype.maxValue=function(){return this.lt},i.prototype.setMaxValue=function(t){this.lt=t},i.prototype.length=function(){return this.lt-this.ct},i.prototype.isEmpty=function(){return this.lt===this.ct||Number.isNaN(this.lt)||Number.isNaN(this.ct)},i.prototype.merge=function(t){return t===null?this:new i(Math.min(this.minValue(),t.minValue()),Math.max(this.maxValue(),t.maxValue()))},i.prototype.apply=function(t,e){this.ct=Math.min(this.ct,t),this.lt=Math.max(this.lt,e)},i.prototype.set=function(t,e){this.ct=t,this.lt=e},i.prototype.scaleAroundCenter=function(t){if(C(t)&&this.lt-this.ct!=0){var e=.5*(this.lt+this.ct),n=this.lt-e,r=this.ct-e;n*=t,r*=t,this.lt=e+n,this.ct=e+r}},i.prototype.shift=function(t){C(t)&&(this.lt+=t,this.ct+=t)},i.prototype.containsStrictly=function(t){return t.minValue()>this.ct&&t.maxValue()<this.lt},i}();function oe(i,t,e){return Math.min(Math.max(i,t),e)}function $t(i,t,e){return t-i<=e}function ze(i){return i<=0?NaN:Math.log(i)/Math.log(10)}function he(i){var t=Math.ceil(i);return t%2!=0?t-1:t}function Ae(i){var t=Math.ceil(i);return t%2==0?t-1:t}function ft(i,t){var e=100*(i-t)/t;return t<0?-e:e}function sn(i,t){var e=ft(i.minValue(),t),n=ft(i.maxValue(),t);return new ht(e,n)}function wt(i,t){var e=100*(i-t)/t+100;return t<0?-e:e}function on(i,t){var e=wt(i.minValue(),t),n=wt(i.maxValue(),t);return new ht(e,n)}function Wt(i){var t=Math.abs(i);if(t<1e-8)return 0;var e=ze(t+1e-4)+4;return i<0?-e:e}function Mt(i){var t=Math.abs(i);if(t<1e-8)return 0;var e=Math.pow(10,t-4)-1e-4;return i<0?-e:e}function Be(i){if(i===null)return null;var t=Wt(i.minValue()),e=Wt(i.maxValue());return new ht(t,e)}(function(i){i[i.LogicalOffset=4]="LogicalOffset",i[i.CoordOffset=1e-4]="CoordOffset"})(Fe||(Fe={}));var ae=function(){function i(t,e){if(this.vt=t,this.dt=e,function(r){if(r<0)return!1;for(var s=r;s>1;s/=10)if(s%10!=0)return!1;return!0}(this.vt))this.Mt=[2,2.5,2];else{this.Mt=[];for(var n=this.vt;n!==1;){if(n%2==0)this.Mt.push(2),n/=2;else{if(n%5!=0)throw new Error("unexpected base");this.Mt.push(2),this.Mt.push(2.5),n/=5}if(this.Mt.length>100)throw new Error("something wrong with base")}}}return i.prototype.tickSpan=function(t,e,n){for(var r,s=this.vt===0?0:1/this.vt,o=Math.pow(10,Math.max(0,Math.ceil(ze(t-e)))),h=0,a=this.dt[0];;){var u=$t(o,s,1e-9)&&o>s+1e-9,l=$t(o,n*a,1e-9),c=$t(o,1,1e-9);if(!(u&&l&&c))break;o/=a,a=this.dt[++h%this.dt.length]}if(o<=s+1e-9&&(o=s),o=Math.max(1,o),this.Mt.length>0&&(r=o,Math.abs(r-1)<1e-9))for(h=0,a=this.Mt[0];$t(o,n*a,1e-9)&&o>s+1e-9;)o/=a,a=this.Mt[++h%this.Mt.length];return o},i}(),Ie=function(){function i(t,e,n,r){this.wt=[],this.B=t,this.vt=e,this.bt=n,this.pt=r}return i.prototype.setBase=function(t){if(t<0)throw new Error("base < 0");this.vt=t},i.prototype.tickSpan=function(t,e){if(t<e)throw new Error("high < low");var n=this.B.height(),r=(t-e)*this.gt()/n,s=new ae(this.vt,[2,2.5,2]),o=new ae(this.vt,[2,2,2.5]),h=new ae(this.vt,[2.5,2,2]),a=[];return a.push(s.tickSpan(t,e,r)),a.push(o.tickSpan(t,e,r)),a.push(h.tickSpan(t,e,r)),function(u){if(u.length<1)throw Error("array is empty");for(var l=u[0],c=1;c<u.length;++c)u[c]<l&&(l=u[c]);return l}(a)},i.prototype.rebuildTickMarks=function(){var t=this.B,e=t.firstValue();if(e!==null){var n=t.height(),r=this.bt(n-1,e),s=this.bt(0,e),o=this.B.options().entireTextOnly?this.yt()/2:0,h=o,a=n-1-o,u=Math.max(r,s),l=Math.min(r,s);if(u!==l){for(var c=this.tickSpan(u,l),p=u%c,d=u>=l?1:-1,y=null,v=0,m=u-(p+=p<0?c:0);m>l;m-=c){var g=this.pt(m,e,!0);y!==null&&Math.abs(g-y)<this.gt()||g<h||g>a||(v<this.wt.length?(this.wt[v].coord=g,this.wt[v].label=t.formatLogical(m)):this.wt.push({coord:g,label:t.formatLogical(m)}),v++,y=g,t.isLog()&&(c=this.tickSpan(m*d,l)))}this.wt.length=v}else this.wt=[]}else this.wt=[]},i.prototype.marks=function(){return this.wt},i.prototype.yt=function(){return this.B.fontSize()},i.prototype.gt=function(){return Math.ceil(2.5*this.yt())},i}(),hn=function(){function i(t){this.kt=t}return i.prototype.format=function(t){var e="";return t<0&&(e="-",t=-t),t<995?e+this.Nt(t):t<999995?e+this.Nt(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.Nt(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.Nt(t/1e9)+"B")},i.prototype.Nt=function(t){var e=Math.pow(10,this.kt);return((t=Math.round(t*e)/e)>=1e-15&&t<1?t.toFixed(this.kt).replace(/\.?0+$/,""):String(t)).replace(/(\.[1-9]*)0+$/,function(n,r){return r})},i}();function Ne(i,t,e,n){if(t.length!==0){var r=t[n.from].x,s=t[n.from].y;i.moveTo(r,s);for(var o=n.from+1;o<n.to;++o){var h=t[o];if(e===1){var a=t[o-1].y,u=h.x;i.lineTo(u,a)}i.lineTo(h.x,h.y)}}}var an=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._data=null,e}return E(t,i),t.prototype.setData=function(e){this._data=e},t.prototype._drawImpl=function(e){if(this._data!==null&&this._data.items.length!==0&&this._data.visibleRange!==null){e.lineCap="butt",e.strokeStyle=this._data.lineColor,e.lineWidth=this._data.lineWidth,T(e,this._data.lineStyle),e.lineWidth=1,e.beginPath(),e.moveTo(this._data.items[this._data.visibleRange.from].x,this._data.bottom),e.lineTo(this._data.items[this._data.visibleRange.from].x,this._data.items[this._data.visibleRange.from].y),Ne(e,this._data.items,this._data.lineType,this._data.visibleRange),e.lineTo(this._data.items[this._data.visibleRange.to-1].x,this._data.bottom),e.lineTo(this._data.items[this._data.visibleRange.from].x,this._data.bottom),e.closePath();var n=e.createLinearGradient(0,0,0,this._data.bottom);n.addColorStop(0,this._data.topColor),n.addColorStop(1,this._data.bottomColor),e.fillStyle=n,e.fill()}},t}(bt),$e=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._data=null,e}return E(t,i),t.prototype.setData=function(e){this._data=e},t.prototype._drawImpl=function(e){this._data!==null&&this._data.items.length!==0&&this._data.visibleRange!==null&&(e.lineCap="square",e.lineWidth=this._data.lineWidth,T(e,this._data.lineStyle),e.strokeStyle=this._data.lineColor,e.lineJoin="miter",e.beginPath(),Ne(e,this._data.items,this._data.lineType,this._data.visibleRange),e.stroke())},t}(bt);function We(i,t,e,n,r){n===void 0&&(n=0),r===void 0&&(r=i.length);for(var s=r-n;0<s;){var o=s>>1,h=n+o;e(i[h],t)?(n=h+1,s-=o+1):s=o}return n}function ue(i,t,e,n,r){n===void 0&&(n=0),r===void 0&&(r=i.length);for(var s=r-n;0<s;){var o=s>>1,h=n+o;e(t,i[h])?s=o:(n=h+1,s-=o+1)}return n}function un(i,t){return i.time<t}function ln(i,t){return i<t.time}function le(i,t,e){var n=t.firstBar(),r=t.lastBar(),s=We(i,n,un),o=ue(i,r,ln);if(!e)return{from:s,to:o};var h=s,a=o;return s>0&&s<i.length&&i[s].time>=n&&(h=s-1),o>0&&o<i.length&&i[o-1].time<=r&&(a=o+1),{from:h,to:a}}var Ue,ce=function(){function i(t,e,n){this._invalidated=!0,this._dataInvalidated=!0,this._items=[],this._itemsVisibleRange=null,this._series=t,this._model=e,this.St=n}return i.prototype.update=function(t){this._invalidated=!0,t==="data"&&(this._dataInvalidated=!0)},i.prototype._makeValid=function(){this._dataInvalidated&&(this._fillRawPoints(),this._dataInvalidated=!1),this._invalidated&&(this._updatePoints(),this._invalidated=!1)},i.prototype._clearVisibleRange=function(){this._itemsVisibleRange=null},i.prototype._updatePoints=function(){var t=this._series.priceScale(),e=this._model.timeScale();if(this._clearVisibleRange(),!e.isEmpty()&&!t.isEmpty()){var n=e.visibleBars();if(n!==null&&this._series.data().bars().size()!==0){var r=this._series.firstValue();r!==null&&(this._itemsVisibleRange=le(this._items,n,this.St),this._convertToCoordinates(t,e,r.value))}}},i}(),je=function(i){function t(e,n){return i.call(this,e,n,!0)||this}return E(t,i),t.prototype._convertToCoordinates=function(e,n,r){n.indexesToCoordinates(this._items,Ft(this._itemsVisibleRange)),e.pointsArrayToCoordinates(this._items,r,Ft(this._itemsVisibleRange))},t.prototype._createRawItemBase=function(e,n){return{time:e,price:n,x:NaN,y:NaN}},t.prototype._fillRawPoints=function(){var e=this,n=this._series.barFunction(),r=[],s=this._series.barColorer();this._series.bars().each(function(o,h){var a=n(h.value),u=e._createRawItem(o,a,s);return r.push(u),!1}),this._items=r},t}(ce),cn=function(i){function t(e,n){var r=i.call(this,e,n)||this;return r.g=new ee,r.xt=new an,r.Dt=new $e,r.g.setRenderers([r.xt,r.Dt]),r}return E(t,i),t.prototype.renderer=function(e,n){this._makeValid();var r=this._series.options(),s={lineType:r.lineType,items:this._items,lineColor:r.lineColor,lineStyle:r.lineStyle,lineWidth:r.lineWidth,topColor:r.topColor,bottomColor:r.bottomColor,bottom:e,visibleRange:this._itemsVisibleRange};return this.xt.setData(s),this.Dt.setData(s),this.g},t.prototype._createRawItem=function(e,n){return this._createRawItemBase(e,n)},t}(je),pn=function(){function i(){this.m=null,this.Ct=0,this.Tt=0}return i.prototype.setData=function(t){this.m=t},i.prototype.draw=function(t,e,n,r){if(this.m!==null&&this.m.bars.length!==0&&this.m.visibleRange!==null){this.Ct=Math.max(1,Math.floor(function(ct,mt){return Math.floor(.3*ct*mt)}(this.m.barSpacing,e))),this.Ct>=2&&Math.floor(e)%2!=this.Ct%2&&this.Ct--,this.Tt=this.m.thinBars?Math.min(this.Ct,Math.floor(e)):this.Ct;for(var s=null,o=this.m.visibleRange.from;o<this.m.visibleRange.to;++o){var h=this.m.bars[o];s!==h.color&&(t.fillStyle=h.color,s=h.color);var a=Math.floor(.5*this.Tt),u=Math.round(h.x*e),l=u-a,c=this.Tt,p=l+c-1,d=Math.round(h.highY*e)-a,y=Math.round(h.lowY*e)+a,v=Math.max(y-d,this.Tt);t.fillRect(l,d,c,v);var m=Math.ceil(1.5*this.Ct);if(this.Tt<=this.Ct){if(this.m.openVisible){var g=u-m,M=Math.max(d,Math.round(h.openY*e)-a),R=M+c-1;R>d+v-1&&(M=(R=d+v-1)-c+1),t.fillRect(g,M,l-g,R-M+1)}var P=u+m,L=Math.max(d,Math.round(h.closeY*e)-a),Q=L+c-1;Q>d+v-1&&(L=(Q=d+v-1)-c+1),t.fillRect(p+1,L,P-p,Q-L+1)}}}},i}(),Ye=function(i){function t(e,n){return i.call(this,e,n,!1)||this}return E(t,i),t.prototype._convertToCoordinates=function(e,n,r){n.indexesToCoordinates(this._items,Ft(this._itemsVisibleRange)),e.barPricesToCoordinates(this._items,r,Ft(this._itemsVisibleRange))},t.prototype._createDefaultItem=function(e,n,r){return{time:e,open:n.value[0],high:n.value[1],low:n.value[2],close:n.value[3],x:NaN,openY:NaN,highY:NaN,lowY:NaN,closeY:NaN}},t.prototype._fillRawPoints=function(){var e=this,n=[],r=this._series.barColorer();this._series.bars().each(function(s,o){var h=e._createRawItem(s,o,r);return n.push(h),!1}),this._items=n},t}(ce),fn=function(i){function t(e,n){var r=i.call(this,e,n)||this;return r.g=new pn,r}return E(t,i),t.prototype.renderer=function(e,n){this._makeValid();var r=this._series.options(),s={bars:this._items,barSpacing:this._model.timeScale().barSpacing(),openVisible:r.openVisible,thinBars:r.thinBars,visibleRange:this._itemsVisibleRange};return this.g.setData(s),this.g},t.prototype._createRawItem=function(e,n,r){return B(B({},this._createDefaultItem(e,n,r)),{color:r.barStyle(e).barColor})},t}(Ye);(function(i){i[i.BarBorderWidth=1]="BarBorderWidth"})(Ue||(Ue={}));var dn=function(){function i(){this.m=null,this.Ct=0}return i.prototype.setData=function(t){this.m=t},i.prototype.draw=function(t,e,n,r){if(this.m!==null&&this.m.bars.length!==0&&this.m.visibleRange!==null){this.Ct=function(h,a){var u=Math.floor(.8*h*a),l=Math.floor(h*a),c=Math.min(u,l-1);return Math.max(1,c)}(this.m.barSpacing,e),this.Ct>=2&&Math.floor(e)%2!=this.Ct%2&&this.Ct--;var s=this.m.bars;this.m.wickVisible&&this.Et(t,s,this.m.visibleRange,e),this.m.borderVisible&&this.Lt(t,s,this.m.visibleRange,this.m.barSpacing,e);var o=this.At(e);(!this.m.borderVisible||this.Ct>2*o)&&this.Bt(t,s,this.m.visibleRange,e)}},i.prototype.Et=function(t,e,n,r){if(this.m!==null){var s="",o=Math.min(Math.floor(r),Math.floor(this.m.barSpacing*r));o=Math.min(o,this.Ct);for(var h=Math.floor(.5*o),a=n.from;a<n.to;a++){var u=e[a];u.wickColor!==s&&(t.fillStyle=u.wickColor,s=u.wickColor);var l=Math.round(Math.min(u.openY,u.closeY)*r),c=Math.round(Math.max(u.openY,u.closeY)*r),p=Math.round(u.highY*r),d=Math.round(u.lowY*r),y=Math.round(r*u.x);t.fillRect(y-h,p,o,l-p),t.fillRect(y-h,c+1,o,d-c)}}},i.prototype.At=function(t){var e=Math.floor(1*t);this.Ct<=2*e&&(e=Math.floor(.5*(this.Ct-1)));var n=Math.max(1,e);return this.Ct<=2*n?Math.floor(1*t):n},i.prototype.Lt=function(t,e,n,r,s){for(var o="",h=this.At(s),a=n.from;a<n.to;a++){var u=e[a];u.borderColor!==o&&(t.fillStyle=u.borderColor,o=u.borderColor);var l=Math.round(u.x*s)-Math.floor(.5*this.Ct),c=l+this.Ct-1,p=Math.round(Math.min(u.openY,u.closeY)*s),d=Math.round(Math.max(u.openY,u.closeY)*s);r>2*h?Qi(t,l,p,c-l+1,d-p+1,h):t.fillRect(l,p,c-l+1,d-p+1)}},i.prototype.Bt=function(t,e,n,r){if(this.m!==null)for(var s="",o=this.At(r),h=n.from;h<n.to;h++){var a=e[h],u=Math.round(Math.min(a.openY,a.closeY)*r),l=Math.round(Math.max(a.openY,a.closeY)*r),c=Math.round(a.x*r)-Math.floor(.5*this.Ct),p=c+this.Ct-1;if(this.m.borderVisible&&(c+=o,u+=o,p-=o,l-=o),!(u>l)){if(a.color!==s){var d=a.color;t.fillStyle=d,s=d}t.fillRect(c,u,p-c+1,l-u+1)}}},i}(),vn=function(i){function t(e,n){var r=i.call(this,e,n)||this;return r.g=new dn,r}return E(t,i),t.prototype.renderer=function(e,n){this._makeValid();var r=this._series.options(),s={bars:this._items,barSpacing:this._model.timeScale().barSpacing(),wickVisible:r.wickVisible,borderVisible:r.borderVisible,visibleRange:this._itemsVisibleRange};return this.g.setData(s),this.g},t.prototype._createRawItem=function(e,n,r){var s=r.barStyle(e);return B(B({},this._createDefaultItem(e,n,r)),{color:s.barColor,wickColor:s.barWickColor,borderColor:s.barBorderColor})},t}(Ye),yn=function(){function i(){this.m=null,this.zt=[]}return i.prototype.setData=function(t){this.m=t,this.zt=[]},i.prototype.draw=function(t,e,n,r){if(this.m!==null&&this.m.items.length!==0&&this.m.visibleRange!==null){this.zt.length||this.Vt(e);for(var s=Math.round(this.m.histogramBase*e),o=Math.max(1,Math.floor(e)),h=this.m.visibleRange.from;h<this.m.visibleRange.to;h++){var a=this.m.items[h],u=this.zt[h-this.m.visibleRange.from],l=Math.round(a.y*e);t.fillStyle=a.color,t.fillRect(u.left,l,u.right-u.left+1,s-l+o)}}},i.prototype.Vt=function(t){if(this.m!==null&&this.m.items.length!==0&&this.m.visibleRange!==null){var e=Math.ceil(this.m.barSpacing*t)<=3?0:Math.max(1,Math.floor(t)),n=Math.round(this.m.barSpacing*t)-e;this.zt=new Array(this.m.visibleRange.to-this.m.visibleRange.from);for(var r=this.m.visibleRange.from;r<this.m.visibleRange.to;r++){var s,o=this.m.items[r],h=Math.round(o.x*t),a=void 0,u=void 0;n%2?(a=h-(s=(n-1)/2),u=h+s):(a=h-(s=n/2),u=h+s-1),this.zt[r-this.m.visibleRange.from]={left:a,right:u,roundedCenter:h,center:o.x*t,time:o.time}}for(r=this.m.visibleRange.from+1;r<this.m.visibleRange.to;r++){var l=this.zt[r-this.m.visibleRange.from],c=this.zt[r-this.m.visibleRange.from-1];l.time===c.time+1&&l.left-c.right!==e+1&&(c.roundedCenter>c.center?c.right=l.left-e-1:l.left=c.right+e+1)}var p=Math.ceil(this.m.barSpacing*t);for(r=this.m.visibleRange.from;r<this.m.visibleRange.to;r++){(l=this.zt[r-this.m.visibleRange.from]).right<l.left&&(l.right=l.left);var d=l.right-l.left+1;p=Math.min(d,p)}if(e>0&&p<4)for(r=this.m.visibleRange.from;r<this.m.visibleRange.to;r++)(d=(l=this.zt[r-this.m.visibleRange.from]).right-l.left+1)>p&&(l.roundedCenter>l.center?l.right-=1:l.left+=1)}else this.zt=[]},i}();function He(i){return{items:[],barSpacing:i,histogramBase:NaN,visibleRange:null}}var Ke,mn=function(i){function t(e,n){var r=i.call(this,e,n,!1)||this;return r.i=new ee,r.Ft=He(0),r.Pt=new Int32Array(0),r.g=new yn,r}return E(t,i),t.prototype.renderer=function(e,n){return this._makeValid(),this.i},t.prototype._fillRawPoints=function(){var e=this,n=this._model.timeScale().barSpacing(),r=this._series.palette();this.Ft=He(n);var s=this._series.barFunction();this.Pt=new Int32Array(this._series.bars().size());var o=0,h=0,a=0,u=this._series.options().color;this._series.bars().each(function(l,c){var p=s(c.value),d=c.value[4],y=function(m,g,M){return{time:m,price:g,x:NaN,y:NaN,color:M}}(l,p,d!=null?r.colorByIndex(d):u),v=d==null?0:d+1;return++h<e.Ft.items.length?e.Ft.items[h]=y:e.Ft.items.push(y),e._items[a++]={time:l,x:0},e.Pt[o++]=v,!1}),this.g.setData(this.Ft),this.i.setRenderers([this.g])},t.prototype._clearVisibleRange=function(){i.prototype._clearVisibleRange.call(this),this.Ft.visibleRange=null},t.prototype._convertToCoordinates=function(e,n,r){if(this._itemsVisibleRange!==null){var s=n.barSpacing(),o=f(n.visibleBars()),h=e.priceToCoordinate(this._series.options().base,r);n.indexesToCoordinates(this.Ft.items),e.pointsArrayToCoordinates(this.Ft.items,r),this.Ft.histogramBase=h,this.Ft.visibleRange=le(this.Ft.items,o,!1),this.Ft.barSpacing=s,this.g.setData(this.Ft)}},t}(ce),gn=function(i){function t(e,n){var r=i.call(this,e,n)||this;return r.Dt=new $e,r}return E(t,i),t.prototype.renderer=function(e,n){this._makeValid();var r=this._series.options(),s={items:this._items,lineColor:r.color,lineStyle:r.lineStyle,lineType:r.lineType,lineWidth:r.lineWidth,visibleRange:this._itemsVisibleRange};return this.Dt.setData(s),this.Dt},t.prototype._createRawItem=function(e,n){return this._createRawItemBase(e,n)},t}(je),bn=/[2-9]/g,Ut=function(){function i(t){t===void 0&&(t=50),this.It=0,this.Ot=1,this.Rt=1,this.Wt={},this.Ut={},this.qt=t}return i.prototype.reset=function(){this.It=0,this.Ut={},this.Ot=1,this.Rt=1,this.Wt={}},i.prototype.measureText=function(t,e,n){var r=n||bn,s=String(e).replace(r,"0");if(this.Ut[s])return this.Ut[s].width;if(this.It===this.qt){var o=this.Wt[this.Rt];delete this.Wt[this.Rt],delete this.Ut[o],this.Rt++,this.It--}var h=t.measureText(s).width;return h===0&&e.length?0:(this.Ut[s]={width:h,tick:this.Ot},this.Wt[this.Ot]=s,this.It++,this.Ot++,h)},i}(),Sn=function(){function i(t){this.jt=null,this.Ht=null,this.Yt="right",this.Kt=0,this.$t=t}return i.prototype.setParams=function(t,e,n,r){this.jt=t,this.Ht=e,this.Kt=n,this.Yt=r},i.prototype.draw=function(t,e){this.Ht!==null&&this.jt!==null&&this.jt.draw(t,this.Ht,this.$t,this.Kt,this.Yt,e)},i}(),wn=function(){function i(t,e,n){this._t=t,this.$t=new Ut(50),this.Xt=e,this.l=n,this.Zt=-1,this.g=new Sn(this.$t)}return i.prototype.update=function(){this._t.update()},i.prototype.renderer=function(t,e){var n=this.l.paneForSource(this.Xt);if(n===null||this.Xt.priceScale()===null)return null;var r=n.priceScalePosition();if(r==="overlay")return null;var s=this.l.priceAxisRendererOptions();return s.fontSize!==this.Zt&&(this.Zt=s.fontSize,this.$t.reset()),this.g.setParams(this._t.paneRenderer(),s,e,r),this.g},i}(),Mn=function(){function i(){this.m=null}return i.prototype.setData=function(t){this.m=t},i.prototype.draw=function(t,e,n,r){if(this.m!==null&&this.m.visible!==!1){var s=Math.round(this.m.y*e);if(!(s<0||s>Math.ceil(this.m.height*e))){var o=Math.ceil(this.m.width*e);t.lineCap="butt",t.strokeStyle=this.m.color,t.lineWidth=Math.floor(this.m.lineWidth*e),T(t,this.m.lineStyle),z(t,s,0,o)}}},i}(),pe=function(){function i(t){this._lineRendererData={width:0,height:0,y:0,color:"rgba(0, 0, 0, 0)",lineWidth:1,lineStyle:0,visible:!1},this._lineRenderer=new Mn,this.o=!0,this._series=t,this._model=t.model(),this._lineRenderer.setData(this._lineRendererData)}return i.prototype.update=function(){this.o=!0},i.prototype.renderer=function(t,e){return this.o&&(this._updateImpl(t,e),this.o=!1),this._lineRenderer},i}(),xn=function(i){function t(e){return i.call(this,e)||this}return E(t,i),t.prototype._updateImpl=function(e,n){this._lineRendererData.visible=!1;var r=this._series.priceScale(),s=r.mode().mode;if(s===2||s===3){var o=this._series.options();if(o.baseLineVisible){var h=this._series.firstValue();h!==null&&(this._lineRendererData.visible=!0,this._lineRendererData.y=r.priceToCoordinate(h.value,h.value),this._lineRendererData.width=n,this._lineRendererData.height=e,this._lineRendererData.color=o.baseLineColor,this._lineRendererData.lineWidth=o.baseLineWidth,this._lineRendererData.lineStyle=o.baseLineStyle)}}},t}(pe);function xt(i,t){return Ae(Math.min(Math.max(i,12),30)*t)}function Ct(i,t){switch(i){case"arrowDown":case"arrowUp":return xt(t,1);case"circle":return xt(t,.8);case"square":return xt(t,.7)}}function qe(i){return he(xt(i,1))}function Xe(i){return Math.max(xt(i,.1),3)}function Je(i,t,e,n,r){var s=Ct("square",e),o=(s-1)/2,h=i-o,a=t-o;return n>=h&&n<=h+s&&r>=a&&r<=a+s}function Ze(i,t,e,n,r,s){var o=(Ct("arrowUp",s)-1)/2,h=(Ae(s/2)-1)/2;t.fillStyle=r,t.beginPath(),i?(t.moveTo(e-o,n),t.lineTo(e,n-o),t.lineTo(e+o,n),t.lineTo(e+h,n),t.lineTo(e+h,n+o),t.lineTo(e-h,n+o),t.lineTo(e-h,n)):(t.moveTo(e-o,n),t.lineTo(e,n+o),t.lineTo(e+o,n),t.lineTo(e+h,n),t.lineTo(e+h,n-o),t.lineTo(e-h,n-o),t.lineTo(e-h,n)),t.fill()}(function(i){i[i.MinShapeSize=12]="MinShapeSize",i[i.MaxShapeSize=30]="MaxShapeSize",i[i.MinShapeMargin=3]="MinShapeMargin"})(Ke||(Ke={}));var Cn=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.m=null,e}return E(t,i),t.prototype.setData=function(e){this.m=e},t.prototype.hitTest=function(e,n){if(this.m===null||this.m.visibleRange===null)return null;for(var r=this.m.visibleRange.from;r<this.m.visibleRange.to;r++){var s=this.m.items[r];if(Pn(s,e,n))return{hitTestData:s.internalId,externalId:s.externalId}}return null},t.prototype._drawImpl=function(e,n,r){if(this.m!==null&&this.m.visibleRange!==null)for(var s=this.m.visibleRange.from;s<this.m.visibleRange.to;s++)Tn(this.m.items[s],e)},t}(bt);function Tn(i,t){switch(i.shape){case"arrowDown":return void Ze(!1,t,i.x,i.y,i.color,i.size);case"arrowUp":return void Ze(!0,t,i.x,i.y,i.color,i.size);case"circle":return void function(e,n,r,s,o){var h=(Ct("circle",o)-1)/2;e.fillStyle=s,e.beginPath(),e.arc(n,r,h,0,2*Math.PI,!1),e.fill()}(t,i.x,i.y,i.color,i.size);case"square":return void function(e,n,r,s,o){var h=Ct("square",o),a=(h-1)/2,u=n-a,l=r-a;e.fillStyle=s,e.fillRect(u,l,h,h)}(t,i.x,i.y,i.color,i.size)}i.shape}function Pn(i,t,e){switch(i.shape){case"arrowDown":case"arrowUp":return function(n,r,s,o,h,a){return Je(r,s,o,h,a)}(0,i.x,i.y,i.size,t,e);case"circle":return function(n,r,s,o,h){var a=2+Ct("circle",s)/2,u=n-o,l=r-h;return Math.sqrt(u*u+l*l)<=a}(i.x,i.y,i.size,t,e);case"square":return Je(i.x,i.y,i.size,t,e)}i.shape}function _n(i,t,e,n,r,s,o,h){var a=C(e)?e:e.close,u=C(e)?e:e.high,l=C(e)?e:e.low,c=qe(o.barSpacing());switch(i.size=c,t.position){case"inBar":return void(i.y=s.priceToCoordinate(a,h));case"aboveBar":return i.y=s.priceToCoordinate(u,h)-c/2-n.aboveBar,void(n.aboveBar+=c+r);case"belowBar":return i.y=s.priceToCoordinate(l,h)+c/2+n.belowBar,void(n.belowBar+=c+r)}t.position}var Qe,En=function(){function i(t,e){this.o=!0,this.Jt=!0,this.Gt=!0,this.Qt=null,this.g=new Cn,this.ti=t,this.F=e,this.m={items:[],visibleRange:null}}return i.prototype.update=function(t){this.o=!0,this.Gt=!0,t==="data"&&(this.Jt=!0)},i.prototype.renderer=function(t,e,n){return this.o&&this._makeValid(),this.g.setData(this.m),this.g},i.prototype.autoScaleMargins=function(){if(this.Gt){if(this.ti.indexedMarkers().length>0){var t=this.F.timeScale().barSpacing(),e=Xe(t),n=1.5*qe(t)+2*e;this.Qt={above:n,below:n}}else this.Qt=null;this.Gt=!1}return this.Qt},i.prototype._makeValid=function(){var t=this.ti.priceScale(),e=this.F.timeScale(),n=this.ti.indexedMarkers();this.Jt&&(this.m.items=n.map(function(d){return{time:d.time,x:0,y:0,size:0,shape:d.shape,color:d.color,internalId:d.internalId,externalId:d.id}}),this.Jt=!1),this.m.visibleRange=null;var r=e.visibleBars();if(r!==null){var s=this.ti.firstValue();if(s!==null&&this.m.items.length!==0){var o=NaN,h=Xe(e.barSpacing()),a={aboveBar:h,belowBar:h};this.m.visibleRange=le(this.m.items,r,!0);for(var u=this.m.visibleRange.from;u<this.m.visibleRange.to;u++){var l=n[u];l.time!==o&&(a.aboveBar=h,a.belowBar=h,o=l.time);var c=this.m.items[u];c.x=e.indexToCoordinate(l.time);var p=this.ti.dataAt(l.time);p!==null&&_n(c,l,p,a,h,t,e,s.value)}this.o=!1}}},i}(),kn=function(i){function t(e){return i.call(this,e)||this}return E(t,i),t.prototype._updateImpl=function(e,n){var r=this._lineRendererData;r.visible=!1;var s=this._series.options();if(s.priceLineVisible){var o=this._series.lastValueData(void 0,s.priceLineSource===0);o.noData||(r.visible=!0,r.y=o.coordinate,r.color=this._series.priceLineColor(o.color),r.width=n,r.height=e,r.lineWidth=s.priceLineWidth,r.lineStyle=s.priceLineStyle)}},t}(pe),Dn=function(i){function t(e,n){var r=i.call(this)||this;return r.k=e,r.m=n,r}return E(t,i),t.prototype._getSource=function(){return this.k},t.prototype._getData=function(){return this.m},t.prototype._updateRendererData=function(e,n,r){e.visible=!1,n.visible=!1;var s=this.k.options(),o=s.lastValueVisible,h=this.k.title()!=="",a=s.seriesLastValueMode===0,u=this.k.lastValueData(void 0,!1);u.noData||(o&&(e.text=this._axisText(u,o,a),e.visible=e.text.length!==0),(h||a)&&(n.text=this._paneText(u,o,h,a),n.visible=n.text.length>0),r.background=this.k.priceLineColor(u.color),r.color=St(r.background),r.coordinate=u.coordinate,n.borderColor=this.k.model().options().layout.backgroundColor,e.borderColor=r.background)},t.prototype._paneText=function(e,n,r,s){var o="",h=this.k.title();return r&&h.length!==0&&(o+=h+" "),n&&s&&(o+=this.k.priceScale().isPercentage()?e.formattedPriceAbsolute:e.formattedPricePercentage),o.trim()},t.prototype._axisText=function(e,n,r){return n?r?this.k.priceScale().isPercentage()?e.formattedPricePercentage:e.formattedPriceAbsolute:e.text:""},t}(re),Rn=function(i){function t(e,n){var r=i.call(this,e)||this;return r.ii=n,r}return E(t,i),t.prototype._updateImpl=function(e,n){var r=this._lineRendererData;r.visible=!1;var s=this.ii.yCoord();if(s!==null){var o=this.ii.options();r.visible=!0,r.y=s,r.color=o.color,r.width=n,r.height=e,r.lineWidth=o.lineWidth,r.lineStyle=o.lineStyle}},t}(pe),Ln=function(i){function t(e,n){var r=i.call(this)||this;return r.ti=e,r.ii=n,r}return E(t,i),t.prototype._updateRendererData=function(e,n,r){e.visible=!1,n.visible=!1;var s=this.ii.options();if(s.axisLabelVisible){var o=this.ii.yCoord();o!==null&&(e.text=this.ti.priceScale().formatPriceAbsolute(s.price),e.visible=!0,r.background=s.color,r.color=St(s.color),r.coordinate=o)}},t}(re),On=function(){function i(t,e){this.ti=t,this.$=e,this.ni=new Rn(t,this),this._t=new Ln(t,this)}return i.prototype.applyOptions=function(t){w(this.$,t),this.update(),this.ti.model().lightUpdate()},i.prototype.options=function(){return this.$},i.prototype.paneView=function(){return this.ni},i.prototype.priceAxisView=function(){return this._t},i.prototype.update=function(){this.ni.update(),this._t.update()},i.prototype.yCoord=function(){var t=this.ti,e=t.priceScale();if(t.model().timeScale().isEmpty()||e.isEmpty())return null;var n=t.firstValue();return n===null?null:e.priceToCoordinate(this.$.price,n.value)},i}(),Fn=function(){function i(){this.si=0,this.hi=new Map,this.ri=new Map}return i.prototype.colorByIndex=function(t){return F(this.ri.get(t))},i.prototype.addColor=function(t){var e=this.hi.get(t);return e===void 0&&(e=this.si++,this.hi.set(t,e),this.ri.set(e,t)),e},i.prototype.clear=function(){this.si=0,this.hi.clear(),this.ri.clear()},i.prototype.size=function(){return this.ri.size},i}(),Tt={barColor:"",barBorderColor:"",barWickColor:""},Vn=function(){function i(t){this.ti=t}return i.prototype.barStyle=function(t,e){var n=this.ti.seriesType(),r=this.ti.options();switch(n){case"Line":return this.ui(r);case"Area":return this.ei(r);case"Bar":return this.oi(r,t,e);case"Candlestick":return this.fi(r,t,e);case"Histogram":return this.ai(r,t,e)}throw new Error("Unknown chart style")},i.prototype.oi=function(t,e,n){var r=B({},Tt),s=t.upColor,o=t.downColor,h=s,a=o,u=f(this.ci(e,n)),l=k(u.value[0])<=k(u.value[3]);return r.barColor=l?s:o,r.barBorderColor=l?h:a,r},i.prototype.fi=function(t,e,n){var r=B({},Tt),s=t.upColor,o=t.downColor,h=t.borderUpColor,a=t.borderDownColor,u=t.wickUpColor,l=t.wickDownColor,c=f(this.ci(e,n)),p=k(c.value[0])<=k(c.value[3]);return r.barColor=p?s:o,r.barBorderColor=p?h:a,r.barWickColor=p?u:l,r},i.prototype.ei=function(t){return B(B({},Tt),{barColor:t.lineColor})},i.prototype.ui=function(t){return B(B({},Tt),{barColor:t.color})},i.prototype.ai=function(t,e,n){var r=B({},Tt),s=f(this.ci(e,n)).value[4];if(s!=null){var o=f(this.ti.palette());r.barColor=o.colorByIndex(s)}else r.barColor=t.color;return r},i.prototype.li=function(){return this.ti.bars()},i.prototype.ci=function(t,e){return e!==void 0?e.value:this.li().valueAt(t)},i}();(function(i){i[i.NearestLeft=-1]="NearestLeft",i[i.Exact=0]="Exact",i[i.NearestRight=1]="NearestRight"})(Qe||(Qe={}));var Ge,zn=function(){function i(t,e){t===void 0&&(t=null),e===void 0&&(e=null),this.vi=[],this.di=0,this.Mi=0,this.wi=!1,this.bi=new Map,this.mi=new Map,this.pi=new Map,this.gi=t||new Map,this.yi=e}return i.prototype.clear=function(){this.vi=[],this.di=0,this.Mi=0,this.wi=!1,this.bi.clear(),this.mi.clear(),this.pi.clear()},i.prototype.first=function(){return this.size()>0?this.vi[this.di]:null},i.prototype.last=function(){return this.size()>0?this.vi[this.Mi-1]:null},i.prototype.firstIndex=function(){return this.size()>0?this.ki(this.di):null},i.prototype.lastIndex=function(){return this.size()>0?this.ki(this.Mi-1):null},i.prototype.size=function(){return this.Mi-this.di},i.prototype.isEmpty=function(){return this.size()===0},i.prototype.contains=function(t){return this.Ni(t,0)!==null},i.prototype.valueAt=function(t){return this.search(t)},i.prototype.add=function(t,e,n){if(this.wi)return!1;var r={index:t,value:n,time:e},s=this.Ni(t,0);return this.mi.clear(),this.pi.clear(),s===null?(this.vi.splice(this.Si(t),0,r),this.di=0,this.Mi=this.vi.length,!0):(this.vi[s]=r,!1)},i.prototype.search=function(t,e,n){e===void 0&&(e=0);var r=this.Ni(t,e,n);if(r===null)return null;var s=this.xi(r);return{index:this.ki(r),time:s.time,value:s.value}},i.prototype.each=function(t){for(var e=this.di;e<this.Mi&&!t(this.ki(e),this.xi(e));++e);},i.prototype.range=function(t,e){var n=new i(this.gi,this.yi);return n.vi=this.vi,n.di=this.Si(t),n.Mi=this.Di(e),n.wi=!0,n},i.prototype.minMaxOnRangeCached=function(t,e,n){if(this.isEmpty())return null;for(var r=null,s=0,o=n;s<o.length;s++){var h=o[s];r=jt(r,this.Ci(t,e,h))}return r},i.prototype.merge=function(t){return this.wi||t.length===0?null:this.isEmpty()||t[t.length-1].index<this.vi[0].index?this.Ti(t):t[0].index>this.vi[this.vi.length-1].index?this.Ei(t):t.length===1&&t[0].index===this.vi[this.vi.length-1].index?(this.Li(t[0]),t[0]):this.Ai(t)},i.prototype.remove=function(t){if(this.wi)return null;var e=this.Ni(t,1);if(e===null)return null;var n=this.vi.splice(e);return this.Mi=this.vi.length,this.bi.clear(),this.mi.clear(),this.pi.clear(),n.length>0?n[0]:null},i.prototype.ki=function(t){return this.vi[t].index},i.prototype.xi=function(t){return this.vi[t]},i.prototype.Ni=function(t,e,n){var r=this.Bi(t);if(r===null&&e!==0)switch(e){case-1:return this.zi(t,n);case 1:return this.Vi(t,n);default:throw new TypeError("Unknown search mode")}if(!n||r===null||e===0)return r;switch(e){case-1:return this.Fi(r);case 1:return this.Pi(r);default:throw new TypeError("Unknown search mode")}},i.prototype.Pi=function(t){for(var e=f(this.yi);t<this.Mi&&e(this.xi(t).value);)t+=1;return t===this.Mi?null:t},i.prototype.Fi=function(t){for(var e=f(this.yi);t>=this.di&&e(this.xi(t).value);)t-=1;return t<this.di?null:t},i.prototype.zi=function(t,e){var n=this.Si(t);n>this.di&&(n-=1);var r=n!==this.Mi&&this.ki(n)<t?n:null;return e&&r!==null?this.Fi(r):r},i.prototype.Vi=function(t,e){var n=this.Di(t),r=n!==this.Mi&&t<this.ki(n)?n:null;return e&&r!==null?this.Pi(r):r},i.prototype.Bi=function(t){var e=this.Si(t);return e===this.Mi||t<this.vi[e].index?null:e},i.prototype.Si=function(t){return We(this.vi,t,function(e,n){return e.index<n},this.di,this.Mi)},i.prototype.Di=function(t){return ue(this.vi,t,function(e,n){return n.index>e},this.di,this.Mi)},i.prototype.Ii=function(t,e,n){var r=null,s=this.gi.get(n.name);if(s===void 0)throw new Error('Plot "'+n.name+'" is not registered');for(var o=t;o<e;o++){var h=s(this.vi[o].value);h==null||Number.isNaN(h)||(r===null?r={min:h,max:h}:(h<r.min&&(r.min=h),h>r.max&&(r.max=h)))}return r},i.prototype.Oi=function(t){var e=Math.floor(t.index/30);this.bi.forEach(function(n){return n.delete(e)})},i.prototype.Ti=function(t){return J(!this.wi,"collection should not be readonly"),J(t.length!==0,"plotRows should not be empty"),this.mi.clear(),this.pi.clear(),this.bi.clear(),this.vi=t.concat(this.vi),this.di=0,this.Mi=this.vi.length,t[0]},i.prototype.Ei=function(t){return J(!this.wi,"collection should not be readonly"),J(t.length!==0,"plotRows should not be empty"),this.mi.clear(),this.pi.clear(),this.bi.clear(),this.vi=this.vi.concat(t),this.di=0,this.Mi=this.vi.length,t[0]},i.prototype.Li=function(t){J(!this.isEmpty(),"plot list should not be empty"),J(this.vi[this.Mi-1].index===t.index,"last row index should match new row index"),this.Oi(t),this.mi.delete(t.index),this.pi.delete(t.index),this.vi[this.Mi-1]=t},i.prototype.Ai=function(t){return J(t.length!==0,"plot rows should not be empty"),this.mi.clear(),this.pi.clear(),this.bi.clear(),this.vi=function(e,n){for(var r=function(c,p){for(var d=c.length,y=p.length,v=d+y,m=0,g=0;m<d&&g<y;)c[m].index<p[g].index?m++:c[m].index>p[g].index?g++:(m++,g++,v--);return v}(e,n),s=new Array(r),o=0,h=0,a=e.length,u=n.length,l=0;o<a&&h<u;)e[o].index<n[h].index?(s[l]=e[o],o++):e[o].index>n[h].index?(s[l]=n[h],h++):(s[l]=n[h],o++,h++),l++;for(;o<a;)s[l]=e[o],o++,l++;for(;h<u;)s[l]=n[h],h++,l++;return s}(this.vi,t),this.di=0,this.Mi=this.vi.length,t[0]},i.prototype.Ci=function(t,e,n){if(this.isEmpty())return null;var r=null,s=f(this.firstIndex()),o=f(this.lastIndex()),h=t-n.offset,a=e-n.offset;h=Math.max(h,s),a=Math.min(a,o);var u=30*Math.ceil(h/30),l=Math.max(u,30*Math.floor(a/30)),c=this.Si(h),p=this.Di(Math.min(a,u,e));r=jt(r,this.Ii(c,p,n));var d=this.bi.get(n.name);d===void 0&&(d=new Map,this.bi.set(n.name,d));for(var y=Math.max(u+1,h);y<l;y+=30){var v=Math.floor(y/30),m=d.get(v);if(m===void 0){var g=this.Si(30*v),M=this.Di(30*(v+1)-1);m=this.Ii(g,M,n),d.set(v,m)}r=jt(r,m)}return c=this.Si(l),p=this.Di(a),jt(r,this.Ii(c,p,n))},i}();function jt(i,t){return i===null?t:t===null?i:{min:Math.min(i.min,t.min),max:Math.max(i.max,t.max)}}(function(i){i[i.Open=0]="Open",i[i.High=1]="High",i[i.Low=2]="Low",i[i.Close=3]="Close",i[i.Color=4]="Color"})(Ge||(Ge={}));var An={open:function(t){return t[0]},high:function(t){return t[1]},low:function(t){return t[2]},close:function(t){return t[3]},hl2:function(t){return(t[1]+t[2])/2},hlc3:function(t){return(t[1]+t[2]+t[3])/3},ohlc4:function(t){return(t[0]+t[1]+t[2]+t[3])/4}},Bn=["open","high","low","close","hl2","hlc3","ohlc4"];function ti(i){return An[i]}var fe,In=function(){function i(){var t;this.Ri=new zn((t=new Map,Bn.forEach(function(e,n){t.set(e,ti(e))}),t))}return i.prototype.bars=function(){return this.Ri},i.prototype.size=function(){return this.Ri.size()},i.prototype.each=function(t){this.Ri.each(t)},i.prototype.clear=function(){this.Ri.clear()},i.prototype.isEmpty=function(){return this.Ri.isEmpty()},i.prototype.first=function(){return this.Ri.first()},i.prototype.last=function(){return this.Ri.last()},i.prototype.search=function(t,e){return this.bars().search(t,e)},i.prototype.valueAt=function(t){return this.search(t)},i}(),at=function(i){function t(e,n,r){var s=i.call(this,e)||this;s.m=new In,s.ni=new kn(s),s.Wi=[],s.Ui=new xn(s),s.qi=!1,s.ji=null,s.Hi=new Fn,s.Yi=[],s.Ki=[],s.$=n,s.$i=r;var o=new Dn(s,{model:e});return s.U=[o],s._i=new wn(o,s,e),s.Xi(),s.Zi(),s.Ji=s.barFunction(),s.Gi(),s}return E(t,i),t.prototype.destroy=function(){},t.prototype.endOfData=function(){return this.qi},t.prototype.priceLineColor=function(e){return this.$.priceLineColor||e},t.prototype.lastValueData=function(e,n,r){var s={noData:!0},o=this.priceScale();if(this.model().timeScale().isEmpty()||o.isEmpty()||this.data().isEmpty())return s;var h,a,u=this.model().timeScale().visibleBars(),l=this.firstValue();if(u===null||l===null)return s;if(n){var c=this.data().bars().last();if(c===null)return s;h=c,a=c.index}else{var p=this.data().bars().search(u.lastBar(),-1);if(p===null||(h=this.data().bars().valueAt(p.index))===null)return s;a=p.index}var d=e!==void 0?h.value[e]:this.Ji(h.value),y=this.barColorer().barStyle(a,{value:h}),v=o.priceToCoordinate(d,l.value);return{noData:!1,price:r?d:void 0,text:o.formatPrice(d,l.value),formattedPriceAbsolute:o.formatPriceAbsolute(d),formattedPricePercentage:o.formatPricePercentage(d,l.value),color:y.barColor,coordinate:v,index:a}},t.prototype.data=function(){return this.m},t.prototype.barColorer=function(){return this.ji!==null||(this.ji=new Vn(this)),this.ji},t.prototype.options=function(){return this.$},t.prototype.applyOptions=function(e){var n=this.$.overlay;w(this.$,e),this.$.overlay=n,n&&this._priceScale!==null&&e.scaleMargins!==void 0&&this._priceScale.applyOptions({scaleMargins:this.$.scaleMargins}),e.priceFormat!==void 0&&this.Xi(),this.model().updateSource(this)},t.prototype.clearData=function(){this.m.clear(),this.Hi.clear(),this.Gi()},t.prototype.updateData=function(e,n){n===void 0&&(n=!1),n&&this.m.clear(),this.m.bars().merge(e),this.Qi(),this.J.update("data"),this._.update("data");var r=this.model().paneForSource(this);this.model().recalculatePane(r),this.model().updateSource(this),this.model().updateCrosshair(),this.model().lightUpdate()},t.prototype.setMarkers=function(e){this.Yi=e.map(function(r){return B({},r)}),this.Qi();var n=this.model().paneForSource(this);this._.update("data"),this.model().recalculatePane(n),this.model().updateSource(this),this.model().updateCrosshair(),this.model().lightUpdate()},t.prototype.markers=function(){return this.Yi},t.prototype.indexedMarkers=function(){return this.Ki},t.prototype.createPriceLine=function(e){var n=new On(this,e);return this.Wi.push(n),this.model().updateSource(this),n},t.prototype.removePriceLine=function(e){var n=this.Wi.indexOf(e);n!==-1&&this.Wi.splice(n,1),this.model().updateSource(this)},t.prototype.palette=function(){return this.Hi},t.prototype.seriesType=function(){return this.$i},t.prototype.firstValue=function(){var e=this.firstBar();return e===null?null:{value:this.Ji(e.value),timePoint:e.time}},t.prototype.firstBar=function(){var e=this.model().timeScale().visibleBars();if(e===null)return null;var n=e.firstBar();return this.data().search(n,1)},t.prototype.bars=function(){return this.m.bars()},t.prototype.nearestIndex=function(e,n){var r=this.nearestData(e,n);return r?r.index:null},t.prototype.nearestData=function(e,n){return N(e)?this.data().search(e,n):null},t.prototype.dataAt=function(e){var n=this.data().valueAt(e);return n===null?null:this.$i==="Bar"||this.$i==="Candlestick"?{open:n.value[0],high:n.value[1],low:n.value[2],close:n.value[3]}:this.barFunction()(n.value)},t.prototype.paneViews=function(){var e=[];this.priceScale()===this.model().mainPriceScale()&&e.push(this.Ui);for(var n=0,r=this.Wi;n<r.length;n++){var s=r[n];e.push(s.paneView())}return e.push(this.J),e.push(this.ni),e.push(this._i),e.push(this._),e},t.prototype.priceAxisViews=function(e,n){for(var r=pt(this.U),s=0,o=this.Wi;s<o.length;s++){var h=o[s];r.push(h.priceAxisView())}return r},t.prototype.autoscaleInfo=function(e,n){if(!N(e)||!N(n)||this.data().isEmpty())return null;var r,s=this.$i==="Line"||this.$i==="Area"||this.$i==="Histogram"?"close":null,o=(r=s!==null?this.data().bars().minMaxOnRangeCached(e,n,[{name:s,offset:0}]):this.data().bars().minMaxOnRangeCached(e,n,[{name:"low",offset:0},{name:"high",offset:0}]))!==null?new ht(r.min,r.max):null;if(this.seriesType()==="Histogram"){var h=this.$.base,a=new ht(h,h);o=o!==null?o.merge(a):a}return{priceRange:o,margins:this._.autoScaleMargins()}},t.prototype.minMove=function(){return this.$.priceFormat.minMove},t.prototype.formatter=function(){return this.tn},t.prototype.barFunction=function(){return this.Ji},t.prototype.updateAllViews=function(){this.J.update(),this._.update();for(var e=0,n=this.U;e<n.length;e++)n[e].update();for(var r=0,s=this.Wi;r<s.length;r++)s[r].update();this.ni.update(),this.Ui.update()},t.prototype.setPriceScale=function(e){this._priceScale!==e&&(this._priceScale=e)},t.prototype.priceScale=function(){return f(this._priceScale)},t.prototype.markerDataAtIndex=function(e){if(this.$i!=="Line"&&this.$i!=="Area"||!this.$.crosshairMarkerVisible)return null;var n=this.m.valueAt(e);return n===null?null:{price:this.Ji(n.value),radius:this.in()}},t.prototype.title=function(){return this.$.title},t.prototype.in=function(){switch(this.$i){case"Line":case"Area":return this.$.crosshairMarkerRadius}return 0},t.prototype.Xi=function(){switch(this.$.priceFormat.type){case"custom":this.tn={format:this.$.priceFormat.formatter};break;case"volume":this.tn=new hn(this.$.priceFormat.precision);break;case"percent":this.tn=new Ve(this.$.priceFormat.precision);break;default:var e=Math.pow(10,this.$.priceFormat.precision);this.tn=new Nt(e,this.$.priceFormat.minMove*e,!1,void 0)}this._priceScale!==null&&this._priceScale.updateFormatter()},t.prototype.Zi=function(){this.Ji=ti("close")},t.prototype.Qi=function(){var e=this.model().timeScale().points();this.Ki=this.Yi.map(function(n,r){return{time:f(e.indexOf(n.time.timestamp,!0)),position:n.position,shape:n.shape,color:n.color,id:n.id,internalId:r}})},t.prototype.Gi=function(){switch(this._=new En(this,this.model()),this.$i){case"Bar":this.J=new fn(this,this.model());break;case"Candlestick":this.J=new vn(this,this.model());break;case"Line":this.J=new gn(this,this.model());break;case"Area":this.J=new cn(this,this.model());break;case"Histogram":this.J=new mn(this,this.model());break;default:throw Error("Unknown chart style assigned: "+this.$i)}},t}(st);function ei(i){return i.slice().sort(function(t,e){return f(t.zorder())-f(e.zorder())})}(function(i){i[i.Normal=0]="Normal",i[i.Logarithmic=1]="Logarithmic",i[i.Percentage=2]="Percentage",i[i.IndexedTo100=3]="IndexedTo100"})(fe||(fe={}));var ii,de,ni,ri=new Ve,si=new Nt(100,1),Nn=function(){function i(t,e,n){this.nn=0,this.sn=null,this.hn=new W,this.rn=null,this.un=null,this.en=new W,this.on={isValid:!1,visibleBars:null},this.fn=0,this.an=0,this.cn=new W,this.ln=new W,this.vn=[],this.dn=null,this.Mn=!1,this.wn=null,this.bn=null,this.mn=null,this.pn=null,this.tn=si,this.gn=new W,this.$=t,this.yn=e,this.kn=n,this.Nn=new Ie(this,100,this.Sn.bind(this),this.xn.bind(this))}return i.prototype.options=function(){return this.$},i.prototype.applyOptions=function(t){if(w(this.$,t),this.updateFormatter(),t.mode!==void 0&&this.setMode({mode:t.mode}),this.gn.fire(),t.scaleMargins!==void 0){var e=F(t.scaleMargins.top),n=F(t.scaleMargins.bottom);if(e<0||e>1)throw new Error("Invalid top margin - expect value between 0 and 1, given="+e);if(n<0||n>1||e+n>1)throw new Error("Invalid bottom margin - expect value between 0 and 1, given="+n);if(e+n>1)throw new Error("Invalid margins - sum of margins must be less than 1, given="+(e+n));this.Dn(),this.bn=null}},i.prototype.optionsChanged=function(){return this.gn},i.prototype.isAutoScale=function(){return this.$.autoScale},i.prototype.isLog=function(){return this.$.mode===1},i.prototype.isPercentage=function(){return this.$.mode===2},i.prototype.isIndexedTo100=function(){return this.$.mode===3},i.prototype.mode=function(){return{autoScale:this.$.autoScale,isInverted:this.$.invertScale,mode:this.$.mode}},i.prototype.setMode=function(t){var e=this.mode(),n=null;t.autoScale!==void 0&&(this.$.autoScale=t.autoScale),t.mode!==void 0&&(this.$.mode=t.mode,t.mode!==2&&t.mode!==3||(this.$.autoScale=!0),this.on.isValid=!1),e.mode===1&&t.mode!==e.mode&&(function(s){if(s===null)return!1;var o=Mt(s.minValue()),h=Mt(s.maxValue());return isFinite(o)&&isFinite(h)}(this.rn)?(n=function(s){if(s===null)return null;var o=Mt(s.minValue()),h=Mt(s.maxValue());return new ht(o,h)}(this.rn))!==null&&this.setPriceRange(n):this.$.autoScale=!0),t.mode===1&&t.mode!==e.mode&&(n=Be(this.rn))!==null&&this.setPriceRange(n);var r=e.mode!==this.$.mode;r&&(e.mode===2||this.isPercentage())&&this.updateFormatter(),r&&(e.mode===3||this.isIndexedTo100())&&this.updateFormatter(),t.isInverted!==void 0&&e.isInverted!==t.isInverted&&(this.$.invertScale=t.isInverted,this.Cn()),this.ln.fire(e,this.mode())},i.prototype.modeChanged=function(){return this.ln},i.prototype.fontSize=function(){return this.yn.fontSize},i.prototype.height=function(){return this.nn},i.prototype.setHeight=function(t){this.nn!==t&&(this.nn=t,this.Dn(),this.bn=null)},i.prototype.internalHeight=function(){if(this.sn)return this.sn;var t=this.height()-this.Tn()-this.En();return this.sn=t,t},i.prototype.internalHeightChanged=function(){return this.hn},i.prototype.priceRange=function(){return this.Ln(),this.rn},i.prototype.priceRangeChanged=function(){return this.en},i.prototype.setPriceRange=function(t,e,n){var r=this.rn;(e||r===null&&t!==null||r!==null&&!r.equals(t))&&(this.bn=null,this.rn=t,n||this.en.fire(r,t))},i.prototype.isEmpty=function(){return this.Ln(),this.nn===0||!this.rn||this.rn.isEmpty()},i.prototype.invertedCoordinate=function(t){return this.isInverted()?t:this.height()-1-t},i.prototype.priceToCoordinate=function(t,e){return this.isPercentage()?t=ft(t,e):this.isIndexedTo100()&&(t=wt(t,e)),this.xn(t,e)},i.prototype.pointsArrayToCoordinates=function(t,e,n){this.Ln();for(var r=this.En(),s=f(this.priceRange()),o=s.minValue(),h=s.maxValue(),a=this.internalHeight()-1,u=this.isInverted(),l=a/(h-o),c=n===void 0?0:n.from,p=n===void 0?t.length:n.to,d=this.An(),y=c;y<p;y++){var v=t[y],m=v.price;if(!isNaN(m)){var g=m;d!==null&&(g=d(v.price,e));var M=r+l*(g-o),R=u?M:this.nn-1-M;v.y=R}}},i.prototype.barPricesToCoordinates=function(t,e,n){this.Ln();for(var r=this.En(),s=f(this.priceRange()),o=s.minValue(),h=s.maxValue(),a=this.internalHeight()-1,u=this.isInverted(),l=a/(h-o),c=n===void 0?0:n.from,p=n===void 0?t.length:n.to,d=this.An(),y=c;y<p;y++){var v=t[y],m=v.open,g=v.high,M=v.low,R=v.close;d!==null&&(m=d(v.open,e),g=d(v.high,e),M=d(v.low,e),R=d(v.close,e));var P=r+l*(m-o),L=u?P:this.nn-1-P;v.openY=L,P=r+l*(g-o),L=u?P:this.nn-1-P,v.highY=L,P=r+l*(M-o),L=u?P:this.nn-1-P,v.lowY=L,P=r+l*(R-o),L=u?P:this.nn-1-P,v.closeY=L}},i.prototype.coordinateToPrice=function(t,e){var n=this.Sn(t,e);return this.logicalToPrice(n,e)},i.prototype.logicalToPrice=function(t,e){var n=t;return this.isPercentage()?n=function(r,s){return s<0&&(r=-r),r/100*s+s}(n,e):this.isIndexedTo100()&&(n=function(r,s){return r-=100,s<0&&(r=-r),r/100*s+s}(n,e)),n},i.prototype.dataSources=function(){return this.vn},i.prototype.orderedSources=function(){if(this.dn)return this.dn;for(var t=[],e=0;e<this.vn.length;e++){var n=this.vn[e];n.zorder()===null&&n.setZorder(e+1),t.push(n)}return t=ei(t),this.dn=t,this.dn},i.prototype.hasSeries=function(){return this.Mn},i.prototype.addDataSource=function(t){this.vn.indexOf(t)===-1&&(t instanceof at&&(this.Mn=!0),this.vn.push(t),this.wn=null,this.updateFormatter(),this.invalidateSourcesCache())},i.prototype.removeDataSource=function(t){var e=this.vn.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this.vn.splice(e,1),t instanceof at&&(this.Mn=!1),this.mainSource()||this.setMode({autoScale:!0}),this.wn=null,this.updateFormatter(),this.invalidateSourcesCache()},i.prototype.mainSource=function(){if(this.wn!==null)return this.wn;for(var t=null,e=0;e<this.vn.length;e++){var n=this.vn[e];if(n instanceof at){t=n;break}t===null&&n instanceof st&&(t=n)}return this.wn=t,this.wn},i.prototype.firstValue=function(){for(var t=null,e=0,n=this.vn;e<n.length;e++){var r=n[e];if(r instanceof st){var s=r.firstValue();if(s===null)continue;(t===null||s.timePoint<t.timePoint)&&(t=s)}}return t===null?null:t.value},i.prototype.isInverted=function(){return this.$.invertScale},i.prototype.marks=function(){return this.bn||(this.Nn.rebuildTickMarks(),this.bn=this.Nn.marks(),this.cn.fire()),this.bn},i.prototype.onMarksChanged=function(){return this.cn},i.prototype.startScale=function(t){this.isPercentage()||this.isIndexedTo100()||this.mn===null&&this.un===null&&(this.isEmpty()||(this.mn=this.nn-t,this.un=f(this.priceRange()).clone()))},i.prototype.scaleTo=function(t){if(!this.isPercentage()&&!this.isIndexedTo100()&&this.mn!==null){this.setMode({autoScale:!1}),(t=this.nn-t)<0&&(t=0);var e=(this.mn+.2*(this.nn-1))/(t+.2*(this.nn-1)),n=f(this.un).clone();e=Math.max(e,.1),n.scaleAroundCenter(e),this.setPriceRange(n)}},i.prototype.endScale=function(){this.isPercentage()||this.isIndexedTo100()||(this.mn=null,this.un=null)},i.prototype.startScroll=function(t){this.isAutoScale()||this.pn===null&&this.un===null&&(this.isEmpty()||(this.pn=t,this.un=f(this.priceRange()).clone()))},i.prototype.scrollTo=function(t){if(!this.isAutoScale()&&this.pn!==null){var e=f(this.priceRange()).length()/(this.internalHeight()-1),n=t-this.pn;this.isInverted()&&(n*=-1);var r=n*e,s=f(this.un).clone();s.shift(r),this.setPriceRange(s,!0),this.bn=null}},i.prototype.endScroll=function(){this.isAutoScale()||this.pn!==null&&(this.pn=null,this.un=null)},i.prototype.formatter=function(){return this.tn||this.updateFormatter(),this.tn},i.prototype.formatPrice=function(t,e){switch(this.$.mode){case 2:return this.formatter().format(ft(t,e));case 3:return this.formatter().format(wt(t,e));default:return this.Bn(t)}},i.prototype.formatLogical=function(t){switch(this.$.mode){case 2:case 3:return this.formatter().format(t);default:return this.Bn(t)}},i.prototype.formatPriceAbsolute=function(t){return this.Bn(t,this.zn())},i.prototype.formatPricePercentage=function(t,e){return t=ft(t,e),ri.format(t)},i.prototype.sourcesForAutoScale=function(){return this.vn.filter(function(t){return t instanceof st})},i.prototype.recalculatePriceRange=function(t){this.on={visibleBars:t,isValid:!1}},i.prototype.updateAllViews=function(){this.vn.forEach(function(t){return t.updateAllViews()})},i.prototype.updateFormatter=function(){this.bn=null;var t=this.mainSource(),e=100;t!==null&&(e=Math.round(1/t.minMove())),this.tn=si,this.isPercentage()?(this.tn=ri,e=100):this.isIndexedTo100()?(this.tn=new Nt(100,1),e=100):t!==null&&(this.tn=t.formatter()),this.Nn=new Ie(this,e,this.Sn.bind(this),this.xn.bind(this)),this.Nn.rebuildTickMarks()},i.prototype.invalidateSourcesCache=function(){this.dn=null},i.prototype.Tn=function(){return this.isInverted()?this.$.scaleMargins.bottom*this.height()+this.an:this.$.scaleMargins.top*this.height()+this.fn},i.prototype.En=function(){return this.isInverted()?this.$.scaleMargins.top*this.height()+this.fn:this.$.scaleMargins.bottom*this.height()+this.an},i.prototype.Ln=function(){this.on.isValid||(this.on.isValid=!0,this.Vn())},i.prototype.Dn=function(){this.sn=null,this.hn.fire()},i.prototype.xn=function(t,e){if(this.Ln(),this.isEmpty())return 0;t=this.isLog()&&t?Wt(t):t;var n=f(this.priceRange()),r=this.En()+(this.internalHeight()-1)*(t-n.minValue())/n.length();return this.invertedCoordinate(r)},i.prototype.Sn=function(t,e){if(this.Ln(),this.isEmpty())return 0;var n=this.invertedCoordinate(t),r=f(this.priceRange()),s=r.minValue()+r.length()*((n-this.En())/(this.internalHeight()-1));return this.isLog()?Mt(s):s},i.prototype.Cn=function(){this.bn=null,this.Nn.rebuildTickMarks()},i.prototype.zn=function(){return f(this.mainSource()).formatter()},i.prototype.Vn=function(){var t=this.on.visibleBars;if(t!==null){for(var e=null,n=0,r=0,s=0,o=this.sourcesForAutoScale();s<o.length;s++){var h=o[s],a=h.firstValue();if(a!==null){var u=h.autoscaleInfo(t.firstBar(),t.lastBar()),l=u&&u.priceRange;if(l!==null){switch(this.$.mode){case 1:l=Be(l);break;case 2:l=sn(l,a.value);break;case 3:l=on(l,a.value)}e=e===null?l:e.merge(f(l)),u!==null&&u.margins!==null&&(n=Math.max(n,u.margins.above),r=Math.max(n,u.margins.below))}}}if(n===this.fn&&r===this.an||(this.fn=n,this.an=r,this.bn=null,this.Dn()),e!==null){if(e.minValue()===e.maxValue()){var c=this.mainSource(),p=5*(c===null||this.isPercentage()||this.isIndexedTo100()?1:c.minMove());e=new ht(e.minValue()-p,e.maxValue()+p)}this.setPriceRange(e)}else this.rn===null&&this.setPriceRange(new ht(-.5,.5));this.on.isValid=!0}},i.prototype.An=function(){return this.isPercentage()?ft:this.isIndexedTo100()?wt:this.isLog()?Wt:null},i.prototype.Bn=function(t,e){return this.kn.priceFormatter===void 0?(e===void 0&&(e=this.formatter()),e.format(t)):this.kn.priceFormatter(t)},i}();function oi(i){i.borderColor!==void 0&&(i.borderUpColor=i.borderColor,i.borderDownColor=i.borderColor),i.wickColor!==void 0&&(i.wickUpColor=i.wickColor,i.wickDownColor=i.wickColor)}function Pt(i){return!C(i)&&!Z(i)}function Yt(i){return C(i)}function dt(i,t,e){return e!==void 0?e+=" ":e="",t===void 0&&(t="'Trebuchet MS', Roboto, Ubuntu, sans-serif"),""+e+i+"px "+t}(function(i){i[i.LastPriceAndPercentageValue=0]="LastPriceAndPercentageValue",i[i.LastValueAccordingToScale=1]="LastValueAccordingToScale"})(ii||(ii={})),function(i){i[i.LastBar=0]="LastBar",i[i.LastVisible=1]="LastVisible"}(de||(de={})),function(i){i[i.BorderSize=1]="BorderSize",i[i.TickLength=4]="TickLength"}(ni||(ni={}));var hi,$n=function(){function i(t){this.Ht={borderSize:1,tickLength:4,fontSize:NaN,font:"",fontFamily:"",color:"",paddingBottom:0,paddingInner:0,paddingOuter:0,paddingTop:0,baselineOffset:0},this.l=t}return i.prototype.options=function(){var t=this.Ht,e=this.Zt(),n=this.Fn();return t.fontSize===e&&t.fontFamily===n||(t.fontSize=e,t.fontFamily=n,t.font=dt(e,n),t.paddingTop=Math.floor(e/3.5),t.paddingBottom=t.paddingTop,t.paddingInner=Math.max(Math.ceil(e/2-t.tickLength/2),0),t.paddingOuter=Math.ceil(e/2+t.tickLength/2),t.baselineOffset=Math.round(e/10)),t.color=this.Pn(),this.Ht},i.prototype.Pn=function(){return this.l.options().layout.textColor},i.prototype.Zt=function(){return this.l.options().layout.fontSize},i.prototype.Fn=function(){return this.l.options().layout.fontFamily},i}(),Wn=function(){function i(){this.m=null}return i.prototype.setData=function(t){this.m=t},i.prototype.draw=function(t,e,n,r){var s=this;if(this.m!==null){var o=Math.floor(e);t.lineWidth=o;var h=Math.ceil(this.m.h*e),a=Math.ceil(this.m.w*e);(function(u,l){u.save(),u.lineWidth%2&&u.translate(.5,.5),l(),u.restore()})(t,function(){var u=f(s.m);if(u.vertLinesVisible){t.strokeStyle=u.vertLinesColor,T(t,u.vertLineStyle),t.beginPath();for(var l=0,c=u.timeMarks;l<c.length;l++){var p=c[l],d=Math.round(p.coord*e);t.moveTo(d,-o),t.lineTo(d,h+o)}t.stroke()}if(u.horzLinesVisible){t.strokeStyle=u.horzLinesColor,T(t,u.horzLineStyle),t.beginPath();for(var y=0,v=u.priceMarks;y<v.length;y++){var m=v[y],g=Math.round(m.coord*e);t.moveTo(-o,g),t.lineTo(a+o,g)}t.stroke()}})}},i}(),Un=function(){function i(t){this.g=new Wn,this.o=!0,this.I=t}return i.prototype.update=function(){this.o=!0},i.prototype.renderer=function(t,e){if(this.o){var n=this.I.model().options().grid,r={h:t,w:e,horzLinesVisible:n.horzLines.visible,vertLinesVisible:n.vertLines.visible,horzLinesColor:n.horzLines.color,vertLinesColor:n.vertLines.color,horzLineStyle:n.horzLines.style,vertLineStyle:n.vertLines.style,priceMarks:this.I.defaultPriceScale().marks(),timeMarks:this.I.model().timeScale().marks()||[]};this.g.setData(r),this.o=!1}return this.g},i}(),jn=function(){function i(){this.In=new WeakMap,this.o=!0}return i.prototype.paneViews=function(t){var e=this.In.get(t);return e===void 0&&(e=[new Un(t)],this.In.set(t,e)),this.o&&(e.forEach(function(n){return n.update()}),this.o=!1),e},i.prototype.invalidate=function(){this.o=!0},i}();(function(i){i[i.None=0]="None",i[i.Cursor=1]="Cursor",i[i.Light=2]="Light",i[i.Full=3]="Full"})(hi||(hi={}));var ot=function(){function i(t){this.On=new Map,this.Rn=!1,this.Wn=!1,this.Un=null,this.qn=t}return i.prototype.invalidatePane=function(t,e){var n=function(r,s){return r===void 0?s:{level:Math.max(r.level,s.level),autoScale:r.autoScale||s.autoScale}}(this.On.get(t),e);this.On.set(t,n)},i.prototype.invalidateAll=function(t){this.qn=Math.max(this.qn,t)},i.prototype.fullInvalidation=function(){return this.qn},i.prototype.invalidateForPane=function(t){var e=this.On.get(t);return e===void 0?{level:this.qn}:{level:Math.max(this.qn,e.level),autoScale:e.autoScale}},i.prototype.setFitContent=function(){this.Wn=!0,this.Un=null},i.prototype.getFitContent=function(){return this.Wn},i.prototype.setTargetTimeRange=function(t){this.Un=t,this.Wn=!1},i.prototype.getTargetTimeRange=function(){return this.Un},i.prototype.merge=function(t){var e=this;this.Rn=this.Rn||t.Rn,t.Wn&&this.setFitContent(),t.Un&&this.setTargetTimeRange(t.Un),this.qn=Math.max(this.qn,t.qn),t.On.forEach(function(n,r){e.invalidatePane(r,n)})},i}(),Yn=function(){function i(t){this.$=t}return i.prototype.align=function(t,e,n){var r=t;if(this.$.mode===0)return r;var s=n.defaultPriceScale(),o=s.firstValue();if(o===null)return r;var h=s.priceToCoordinate(t,o),a=n.dataSources().filter(function(l){return l instanceof at}).reduce(function(l,c){if(n.isOverlay(c))return l;var p=c.priceScale(),d=c.bars();if(p.isEmpty()||!d.contains(e))return l;var y=d.valueAt(e);if(y===null)return l;var v=[y.value[3]],m=k(c.firstValue());return l.concat(v.map(function(g){return p.priceToCoordinate(g,m.value)}))},[]);if(a.length===0)return r;a.sort(function(l,c){return Math.abs(l-h)-Math.abs(c-h)});var u=a[0];return s.coordinateToPrice(u,o)},i}(),Hn=function(){function i(t,e){this.vn=[],this.jn=[],this.nn=0,this.Kt=0,this.Hn=1e3,this.Yn=null,this.dn=null,this.Kn=new W,this.$n=t,this.F=e,this.model().mainPriceScaleOptionsChanged().subscribe(this.onPriceScaleOptionsChanged.bind(this),this),this._n=this.Xn()}return i.prototype.onPriceScaleOptionsChanged=function(){this._n.applyOptions(this.F.options().priceScale)},i.prototype.destroy=function(){this.model().mainPriceScaleOptionsChanged().unsubscribeAll(this),this._n.modeChanged().unsubscribeAll(this),this.vn.forEach(function(t){t.destroy&&t.destroy()}),this.Kn.fire()},i.prototype.stretchFactor=function(){return this.Hn},i.prototype.setStretchFactor=function(t){this.Hn=t},i.prototype.model=function(){return this.F},i.prototype.width=function(){return this.Kt},i.prototype.height=function(){return this.nn},i.prototype.setWidth=function(t){this.Kt=t,this.updateAllViews()},i.prototype.setHeight=function(t){var e=this;this.nn=t,this._n.setHeight(t),this.vn.forEach(function(n){if(e.isOverlay(n)){var r=n.priceScale();r!==null&&r.setHeight(t)}}),this.updateAllViews()},i.prototype.dataSources=function(){return this.vn},i.prototype.isOverlay=function(t){var e=t.priceScale();return e===null||this._n!==e},i.prototype.addDataSource=function(t,e,n){var r=this.Zn().minZOrder-1;this.Jn(t,e,r)},i.prototype.removeDataSource=function(t){var e=this.vn.indexOf(t);J(e!==-1,"removeDataSource: invalid data source"),this.vn.splice(e,1),t===this.Yn&&(this.Yn=null);var n=this.jn.indexOf(t);n!==-1&&this.jn.splice(n,1);var r=t.priceScale();if(r&&r.dataSources().indexOf(t)>=0&&r.removeDataSource(t),r&&r.mainSource()===null){var s=r.dataSources().length;J(s===0,"Invalid priceScale state: empty mainSource but non-empty data sources="+s),r!==this._n&&r.modeChanged().unsubscribeAll(this)}t instanceof st&&this.Gn(),r&&t instanceof st&&(r.invalidateSourcesCache(),this.recalculatePriceScale(r)),this.dn=null},i.prototype.priceScalePosition=function(){var t=this.F.options().priceScale.position;return t==="none"?"overlay":t},i.prototype.startScalePrice=function(t,e){t.startScale(e)},i.prototype.scalePriceTo=function(t,e){t.scaleTo(e),this.updateAllViews()},i.prototype.endScalePrice=function(t){t.endScale()},i.prototype.startScrollPrice=function(t,e){t.startScroll(e)},i.prototype.scrollPriceTo=function(t,e){t.scrollTo(e),this.updateAllViews()},i.prototype.endScrollPrice=function(t){t.endScroll()},i.prototype.setPriceAutoScale=function(t,e){t.setMode({autoScale:e}),this.$n.isEmpty()?t.setPriceRange(null):this.recalculatePriceScale(t)},i.prototype.updateAllViews=function(){this.vn.forEach(function(t){t.updateAllViews()})},i.prototype.defaultPriceScale=function(){var t=this.mainDataSource(),e=t!==null?t.priceScale():null;return e===null&&(e=this._n),e},i.prototype.mainDataSource=function(){return this.Yn},i.prototype.recalculatePriceScale=function(t){t!==null&&t.isAutoScale()&&this.Qn(t)},i.prototype.resetPriceScale=function(t){var e=this.$n.visibleBars();t.setMode({autoScale:!0}),e!==null&&t.recalculatePriceRange(e),this.updateAllViews()},i.prototype.momentaryAutoScale=function(){this.Qn(this._n)},i.prototype.recalculate=function(){var t=this;this.recalculatePriceScale(this._n),this.vn.forEach(function(e){t.isOverlay(e)&&t.recalculatePriceScale(e.priceScale())}),this.updateAllViews(),this.F.lightUpdate()},i.prototype.isEmpty=function(){return this.Yn===null},i.prototype.containsSeries=function(){return this.vn.some(function(t){return t instanceof at})},i.prototype.orderedSources=function(){return this.dn===null&&(this.dn=ei(this.vn)),this.dn},i.prototype.onDestroyed=function(){return this.Kn},i.prototype.ts=function(t,e){return e!=="overlay"?this._n:this.Xn(!0)},i.prototype.Qn=function(t){var e=t.sourcesForAutoScale();if(e&&e.length>0&&!this.$n.isEmpty()){var n=this.$n.visibleBars();n!==null&&t.recalculatePriceRange(n)}t.updateAllViews()},i.prototype.Zn=function(){var t=this.orderedSources();if(t.length===0)return{minZOrder:0,maxZOrder:0};for(var e=0,n=0,r=0;r<t.length;r++){var s=t[r].zorder();s!==null&&(s<e&&(e=s),s>n&&(n=s))}return{minZOrder:e,maxZOrder:n}},i.prototype.Jn=function(t,e,n){var r="overlay",s=null;if(!e){var o=this.model().options().priceScale.position;r=o==="none"?"overlay":o}t instanceof st&&(s=this.ts(t,r)),this.vn.push(t),e&&this.jn.push(t),s!==null&&(s.addDataSource(t),t.setPriceScale(s)),t.setZorder(n),this.Gn(),t instanceof st&&this.recalculatePriceScale(s),this.dn=null},i.prototype.ns=function(t,e,n){e.mode!==n.mode&&this.Qn(t)},i.prototype.Gn=function(){if(this.Yn===null||this.jn.indexOf(this.Yn)!==-1){for(var t=0,e=this.vn;t<e.length;t++)if((s=e[t])instanceof st&&!this.isOverlay(s))return void this.ss(s);for(var n=0,r=this.jn;n<r.length;n++){var s;if((s=r[n])instanceof st)return void this.ss(s)}}},i.prototype.ss=function(t){var e=f(t.priceScale());this.defaultPriceScale().modeChanged().unsubscribeAll(this),e.modeChanged().subscribe(this.ns.bind(this,e),this),this.Yn=t},i.prototype.Xn=function(t){var e=K(this.F.options().priceScale);t&&(e.autoScale=!0,e.mode=0);var n=new Nn(e,this.F.options().layout,this.F.options().localization);return n.setHeight(this.height()),n},i}(),ai=function(t){return t.getUTCFullYear()},D=function(t){return it(function(e){return e.getUTCDate()}(t),2)},vt=function(t,e){return new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(e,{month:"long"})},yt=function(t,e){return new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(e,{month:"short"})},U=function(t){return it(function(e){return e.getUTCMonth()+1}(t),2)},Y=function(t){return it(ai(t)%100,2)},H=function(t){return it(ai(t),4)},Kn={"'yy MMM dd":function(t,e){return"'"+Y(t)+" "+yt(t,e)+" "+D(t)},"'yy MMMM dd":function(t,e){return"'"+Y(t)+" "+vt(t,e)+" "+D(t)},"yyyy MMM dd":function(t,e){return H(t)+" "+yt(t,e)+" "+D(t)},"yyyy MMMM dd":function(t,e){return H(t)+" "+vt(t,e)+" "+D(t)},"dd MMM 'yy":function(t,e){return D(t)+" "+yt(t,e)+" '"+Y(t)},"dd MMMM 'yy":function(t,e){return D(t)+" "+vt(t,e)+" '"+Y(t)},"dd MMM yyyy":function(t,e){return D(t)+" "+yt(t,e)+" "+H(t)},"dd MMMM yyyy":function(t,e){return D(t)+" "+vt(t,e)+" "+H(t)},"MMM dd, 'yy":function(t,e){return yt(t,e)+" "+D(t)+", '"+Y(t)},"MMMM dd, 'yy":function(t,e){return vt(t,e)+" "+D(t)+", '"+Y(t)},"MMM dd, yyyy":function(t,e){return yt(t,e)+" "+D(t)+", "+H(t)},"MMMM dd, yyyy":function(t,e){return vt(t,e)+" "+D(t)+", "+H(t)},"yyyy-MM-dd":function(t,e){return H(t)+"-"+U(t)+"-"+D(t)},"yy-MM-dd":function(t,e){return Y(t)+"-"+U(t)+"-"+D(t)},"yy/MM/dd":function(t,e){return Y(t)+"/"+U(t)+"/"+D(t)},"yyyy/MM/dd":function(t,e){return H(t)+"/"+U(t)+"/"+D(t)},"yy.MM.dd":function(t,e){return Y(t)+"."+U(t)+"."+D(t)},"yyyy.MM.dd":function(t,e){return H(t)+"."+U(t)+"."+D(t)},"dd-MM-yyyy":function(t,e){return D(t)+"-"+U(t)+"-"+H(t)},"dd-MM-yy":function(t,e){return D(t)+"-"+U(t)+"-"+Y(t)},"dd/MM/yy":function(t,e){return D(t)+"/"+U(t)+"/"+Y(t)},"dd/MM/yyyy":function(t,e){return D(t)+"/"+U(t)+"/"+H(t)},"dd.MM.yy":function(t,e){return D(t)+"."+U(t)+"."+Y(t)},"dd.MM.yyyy":function(t,e){return D(t)+"."+U(t)+"."+H(t)},"MM-dd-yy":function(t,e){return U(t)+"-"+D(t)+"-"+Y(t)},"MM-dd-yyyy":function(t,e){return U(t)+"-"+D(t)+"-"+H(t)},"MM/dd/yy":function(t,e){return U(t)+"/"+D(t)+"/"+Y(t)},"MM/dd/yyyy":function(t,e){return U(t)+"/"+D(t)+"/"+H(t)},"MM.dd.yy":function(t,e){return U(t)+"."+D(t)+"."+Y(t)},"MM.dd.yyyy":function(t,e){return U(t)+"."+D(t)+"."+H(t)}},ui=function(){function i(t,e){t===void 0&&(t="yyyy-MM-dd"),e===void 0&&(e="default"),this.hs=Kn[t],this.rs=e}return i.prototype.format=function(t){return this.hs(t,this.rs)},i}(),qn=function(){function i(t){this.us=t||"%h:%m:%s"}return i.prototype.format=function(t){return this.us.replace("%h",it(t.getUTCHours(),2)).replace("%m",it(t.getUTCMinutes(),2)).replace("%s",it(t.getUTCSeconds(),2))},i}(),Xn={dateFormat:"yyyy-MM-dd",timeFormat:"%h:%m:%s",dateTimeSeparator:" ",locale:"default"},Jn=function(){function i(t){t===void 0&&(t={});var e=B(B({},Xn),t);this.es=new ui(e.dateFormat,e.locale),this.os=new qn(e.timeFormat),this.fs=e.dateTimeSeparator}return i.prototype.format=function(t){return""+this.es.format(t)+this.fs+this.os.format(t)},i}(),ve=function(){function i(t,e){J(t<=e,"The last bar in the bars range should be greater than or equal to the first bar"),this.as=t,this.cs=e}return i.prototype.firstBar=function(){return this.as},i.prototype.lastBar=function(){return this.cs},i.prototype.count=function(){return this.cs-this.as+1},i.prototype.contains=function(t){return this.as<=t&&t<=this.cs},i.prototype.equals=function(t){return this.as===t.firstBar()&&this.cs===t.lastBar()},i}(),Zn=function(){function i(t,e){e===void 0&&(e=50),this.It=0,this.Ot=1,this.Rt=1,this.Ut=new Map,this.Wt=new Map,this.ls=t,this.qt=e}return i.prototype.format=function(t){var e=this.Ut.get(t.valueOf());if(e!==void 0)return e.string;if(this.It===this.qt){var n=this.Wt.get(this.Rt);this.Wt.delete(this.Rt),this.Ut.delete(F(n)),this.Rt++,this.It--}var r=this.ls(t);return this.Ut.set(t.valueOf(),{string:r,tick:this.Ot}),this.Wt.set(this.Ot,t.valueOf()),this.It++,this.Ot++,r},i}();function Qn(i,t){return i.index-t.index}var li,ci,Gn=function(){function i(){this.vs=1/0,this.ds=-1/0,this.Ms=new Map,this.ws=[],this.bs=new W,this.Ut=null,this.ms=NaN}return i.prototype.reset=function(){this.Ms.clear(),this.ws=[],this.vs=1/0,this.ds=-1/0,this.Ut=null,this.bs.fire()},i.prototype.merge=function(t){for(var e=this.ws,n={},r=0,s=t;r<s.length;r++){var o=s[r],h=o.index,a=o.span,u=this.Ms.get(o.index);if(u){if(u.index===o.index&&u.span===o.span){u.time=o.time;continue}this.ps(u)}this.Ms.set(h,o),this.vs>h&&(this.vs=h),this.ds<h&&(this.ds=h),(l=e[a])===void 0&&(l=[],e[a]=l),l.push(o),n[a]=!0}for(a=e.length;a--;){var l;(l=e[a])!==void 0&&(l.length===0&&delete e[a],n[a]&&l.sort(Qn))}this.Ut=null,this.bs.fire()},i.prototype.indexToTime=function(t){var e=this.Ms.get(t);return e===void 0?null:e.time},i.prototype.nearestIndex=function(t){for(var e=this.vs,n=this.ds;n-e>2;){if(1e3*F(this.Ms.get(e)).time.timestamp===t)return e;if(1e3*F(this.Ms.get(n)).time.timestamp===t)return n;var r=Math.round((e+n)/2);1e3*F(this.Ms.get(r)).time.timestamp>t?n=r:e=r}return e},i.prototype.build=function(t,e){var n=Math.ceil(e/t);if(this.ms===n&&this.Ut)return this.Ut;this.ms=n;for(var r=[],s=this.ws.length;s--;)if(this.ws[s]){var o=r;r=[];for(var h=o.length,a=0,u=F(this.ws[s]),l=u.length,c=1/0,p=-1/0,d=0;d<l;d++){for(var y=u[d],v=y.index;a<h;){var m=o[a],g=m.index;if(!(g<v)){c=g;break}a++,r.push(m),p=g,c=1/0}c-v>=n&&v-p>=n&&(r.push(y),p=v)}for(;a<h;a++)r.push(o[a])}return this.Ut=r,this.Ut},i.prototype.ps=function(t){var e=t.index;if(this.Ms.get(e)===t){this.Ms.delete(e),e<=this.vs&&this.vs++,e>=this.ds&&this.ds--,this.ds<this.vs&&(this.vs=1/0,this.ds=-1/0);var n=F(this.ws[t.span]),r=n.indexOf(t);r!==-1&&n.splice(r,1)}},i}(),pi=function(){function i(){this.vi=[]}return i.prototype.clear=function(){this.vi=[]},i.prototype.size=function(){return this.vi.length},i.prototype.firstIndex=function(){return this.gs(0)},i.prototype.lastIndex=function(){return this.gs(this.vi.length-1)},i.prototype.merge=function(t,e){if(e.length!==0)if(this.vi.length!==0){var n=t;if(n<0){var r=Math.abs(n);if(e.length<r)return;this.vi=new Array(r).concat(this.vi);for(var s=0;s<e.length;++s)this.vi[t+s]=e[s]}else{for(var o=n;o<this.vi.length&&o-n<e.length;++o)this.vi[o]=e[o-n];var h=n+e.length;if(h>this.vi.length){r=h-this.vi.length;for(var a=o;a<o+r;++a)this.vi.push(e[a-n])}}}else this.vi=e},i.prototype.valueAt=function(t){var e=this.ys(t);return e!==null?this.vi[e]:null},i.prototype.indexOf=function(t,e){if(this.vi.length<1)return null;if(t>this.vi[this.vi.length-1].timestamp)return e?this.vi.length-1:null;for(var n=0;n<this.vi.length;++n){if(t===this.vi[n].timestamp)return n;if(t<this.vi[n].timestamp)return e?n:null}return null},i.prototype.closestIndexLeft=function(t){var e=this.vi;if(!e.length||Number.isNaN(t.timestamp))return null;var n=e.length-1;if(t>=e[n])return n;var r=0,s=e[r];if(t<s)return null;if(t===s)return r;for(;n>r+1;){var o=r+n>>1,h=e[o];if(h.timestamp>t.timestamp)n=o;else{if(!(h.timestamp<t.timestamp))return h.timestamp===t.timestamp?o:null;r=o}}return r},i.prototype.gs=function(t){return 0<=t&&t<this.size()?t:null},i.prototype.ys=function(t){return 0<=t&&t<this.size()?t:null},i}();(function(i){i[i.DefaultAnimationDuration=400]="DefaultAnimationDuration",i[i.MinBarSpacing=.5]="MinBarSpacing",i[i.MinVisibleBarsCount=2]="MinVisibleBarsCount"})(li||(li={})),function(i){i[i.Minute=20]="Minute",i[i.Hour=30]="Hour",i[i.Day=40]="Day",i[i.Week=50]="Week",i[i.Month=60]="Month",i[i.Year=70]="Year"}(ci||(ci={}));var tr=function(){function i(t,e,n){this.Kt=0,this.ks=null,this.Ns=new pi,this.pn=null,this.mn=null,this.Ss=new Gn,this.xs=new Map,this.Ds=null,this.Cs=!0,this.Ts=new W,this.Es=new W,this.Ls=null,this.As=null,this.Bs=null,this.zs=[],this.$=e,this.kn=n,this.Vs=e.rightOffset,this.Fs=e.barSpacing,this.F=t,this.Ps()}return i.prototype.options=function(){return this.$},i.prototype.applyLocalizationOptions=function(t){w(this.kn,t),this.Is(),this.Ps()},i.prototype.applyOptions=function(t,e){w(this.$,t),this.$.fixLeftEdge?this.Os():this.Ls=null,t.barSpacing!==void 0&&this.setBarSpacing(t.barSpacing),t.rightOffset!==void 0&&this.setRightOffset(t.rightOffset),this.Is(),this.Ps(),this.Es.fire()},i.prototype.isEmpty=function(){return this.Kt===0||this.Ns.size()===0},i.prototype.visibleBars=function(){return this.Cs&&(this.Cs=!1,this.Rs()),this.Ds},i.prototype.tickMarks=function(){return this.Ss},i.prototype.points=function(){return this.Ns},i.prototype.width=function(){return this.Kt},i.prototype.setWidth=function(t){if(isFinite(t)&&!(t<=0)&&this.Kt!==t){if(this.$.lockVisibleTimeRangeOnResize&&this.Kt){var e=this.Fs*t/this.Kt;this.Ws(e)}if(this.Ls!==null&&f(this.visibleBars()).firstBar()<=this.Ls){var n=this.Kt-t;this.Vs-=Math.round(n/this.Fs)+1}this.Kt=t,this.Cs=!0,this.Us(),this.qs()}},i.prototype.indexToCoordinate=function(t){if(this.isEmpty()||!N(t))return 0;var e=this.baseIndex()+this.Vs-t;return this.Kt-(e+.5)*this.Fs},i.prototype.indexesToCoordinates=function(t,e){for(var n=this.baseIndex(),r=e===void 0?0:e.from,s=e===void 0?t.length:e.to,o=r;o<s;o++){var h=t[o].time,a=n+this.Vs-h,u=this.Kt-(a+.5)*this.Fs;t[o].x=u}},i.prototype.indexToUserTime=function(t){return this.Ss.indexToTime(t)},i.prototype.coordinateToIndex=function(t){return Math.ceil(this.js(t))},i.prototype.setRightOffset=function(t){this.Cs=!0,this.Vs=t,this.qs(),this.F.recalculateAllPanes(),this.F.lightUpdate()},i.prototype.barSpacing=function(){return this.Fs},i.prototype.setBarSpacing=function(t){this.Ws(t),this.qs(),this.F.recalculateAllPanes(),this.F.lightUpdate()},i.prototype.rightOffset=function(){return this.Vs},i.prototype.marks=function(){if(this.isEmpty())return null;if(this.Bs!==null)return this.Bs;for(var t=this.Fs,e=5*(this.F.options().layout.fontSize+4),n=Math.round(e/t),r=f(this.visibleBars()),s=Math.max(r.firstBar(),r.firstBar()-n),o=Math.max(r.lastBar(),r.lastBar()-n),h=0,a=0,u=this.Ss.build(t,e);a<u.length;a++){var l=u[a];if(s<=l.index&&l.index<=o){var c=this.Ss.indexToTime(l.index);if(c!==null){if(h<this.zs.length){var p=this.zs[h];p.coord=this.indexToCoordinate(l.index),p.label=this.Hs(c,l.span),p.span=l.span,p.major=!1}else this.zs.push({coord:this.indexToCoordinate(l.index),label:this.Hs(c,l.span),span:l.span,major:!1});h++}}}return this.zs.length=h,this.Bs=this.zs,this.zs},i.prototype.reset=function(){this.Cs=!0,this.Ns=new pi,this.pn=null,this.mn=null,this.Ys(),this.Ss.reset(),this.Ls=null},i.prototype.restoreDefault=function(){this.Cs=!0,this.setBarSpacing(this.$.barSpacing),this.setRightOffset(this.$.rightOffset)},i.prototype.fixLeftEdge=function(){return this.$.fixLeftEdge},i.prototype.setBaseIndex=function(t){this.Cs=!0,this.ks=t,this.qs(),this.Os()},i.prototype.zoom=function(t,e){var n=this.js(t),r=this.barSpacing(),s=r+e*(r/10);this.setBarSpacing(s),this.$.rightBarStaysOnScroll||this.setRightOffset(this.rightOffset()+(n-this.js(t)))},i.prototype.startScale=function(t){this.pn&&this.endScroll(),this.mn===null&&this.As===null&&(this.isEmpty()||(this.mn=t,this.Ks()))},i.prototype.scaleTo=function(t){if(this.As!==null){var e=oe(this.Kt-t,0,this.Kt),n=oe(this.Kt-f(this.mn),0,this.Kt);e!==0&&n!==0&&this.setBarSpacing(this.As.barSpacing*e/n)}},i.prototype.endScale=function(){this.mn!==null&&(this.mn=null,this.Ys())},i.prototype.startScroll=function(t){this.pn===null&&this.As===null&&(this.isEmpty()||(this.pn=t,this.Ks()))},i.prototype.scrollTo=function(t){if(this.Cs=!0,this.pn!==null){var e=(this.pn-t)/this.barSpacing();this.Vs=f(this.As).rightOffset+e,this.Cs=!0,this.qs()}},i.prototype.endScroll=function(){this.pn!==null&&(this.pn=null,this.Ys())},i.prototype.scrollToRealTime=function(){this.scrollToOffsetAnimated(this.$.rightOffset)},i.prototype.scrollToOffsetAnimated=function(t,e){var n=this;if(e===void 0&&(e=400),!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");var r=this.Vs,s=new Date().getTime(),o=function h(){var a=(new Date().getTime()-s)/e,u=a>=1,l=u?t:r+(t-r)*a;n.setRightOffset(l),u||setTimeout(h,20)};o()},i.prototype.update=function(t,e,n){if(this.Cs=!0,e.length>0){var r=this.Ns.size();this.Ns.merge(t,e),this.Vs<0&&this.Ns.size()===r+1&&(this.Vs-=1,this.Cs=!0)}this.Ss.merge(n),this.qs()},i.prototype.visibleBarsChanged=function(){return this.Ts},i.prototype.optionsApplied=function(){return this.Es},i.prototype.baseIndex=function(){return this.ks||0},i.prototype.setVisibleRange=function(t){var e=t.count();this.Ws(this.Kt/e),this.Vs=t.lastBar()-this.baseIndex(),this.qs(),this.Cs=!0,this.F.recalculateAllPanes(),this.F.lightUpdate()},i.prototype.fitContent=function(){var t=this.Ns.firstIndex(),e=this.Ns.lastIndex();t!==null&&e!==null&&this.setVisibleRange(new ve(t,e+this.$.rightOffset))},i.prototype.setTimePointsRange=function(t){var e=this.points(),n=e.firstIndex(),r=e.lastIndex();if(n!==null&&r!==null){var s=f(e.valueAt(n)).timestamp,o=f(e.valueAt(r)).timestamp,h=new ve(f(e.indexOf(Math.max(s,t.from.timestamp),!0)),f(e.indexOf(Math.min(o,t.to.timestamp),!0)));this.setVisibleRange(h)}},i.prototype.formatDateTime=function(t){return this.kn.timeFormatter!==void 0?this.kn.timeFormatter(t.businessDay||t.timestamp):this.$s.format(new Date(1e3*t.timestamp))},i.prototype._s=function(t){return(this.Kt+1-t)/this.Fs},i.prototype.js=function(t){var e=this._s(t),n=this.baseIndex()+this.Vs-e;return Math.round(1e6*n)/1e6},i.prototype.Ws=function(t){var e=this.Fs;this.Fs=t,this.Us(),e!==this.Fs&&(this.Cs=!0,this.Xs())},i.prototype.Rs=function(){if(this.isEmpty())this.Zs(null);else{var t=this.baseIndex(),e=Math.ceil(this.Kt/this.Fs)-1,n=Math.round(this.Vs+t),r=n-e;this.Zs(new ve(r,n))}},i.prototype.Us=function(){if(this.Fs<.5&&(this.Fs=.5,this.Cs=!0),this.Kt!==0){var t=.5*this.Kt;this.Fs>t&&(this.Fs=t,this.Cs=!0)}},i.prototype.qs=function(){var t=this.Js();this.Vs>t&&(this.Vs=t,this.Cs=!0);var e=this.Gs();e!==null&&this.Vs<e&&(this.Vs=e,this.Cs=!0)},i.prototype.Gs=function(){var t=this.Ns.firstIndex(),e=this.ks;if(t===null||e===null)return null;if(this.Ls!==null){var n=this.Kt/this.Fs;return this.Ls-e+n-1}return t-e-1+Math.min(2,this.Ns.size())},i.prototype.Js=function(){return this.Kt/this.Fs-Math.min(2,this.Ns.size())},i.prototype.Ks=function(){this.As={barSpacing:this.barSpacing(),rightOffset:this.rightOffset()}},i.prototype.Ys=function(){this.As=null},i.prototype.Hs=function(t,e){var n=this,r=this.xs.get(e);return r===void 0&&(r=new Zn(function(s){return n.Qs(s,e)}),this.xs.set(e,r)),t.businessDay===void 0?r.format(new Date(1e3*t.timestamp)):r.format(new Date(Date.UTC(t.businessDay.year,t.businessDay.month-1,t.businessDay.day)))},i.prototype.Qs=function(t,e){var n={},r=this.$.timeVisible;return e<20&&r?(n.hour12=!1,n.hour="2-digit",n.minute="2-digit",this.$.secondsVisible&&(n.second="2-digit")):e<40&&r?(n.hour12=!1,n.hour="2-digit",n.minute="2-digit"):e<50||e<60?n.day="numeric":e<70?n.month="short":n.year="numeric",new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()).toLocaleString(this.kn.locale,n)},i.prototype.Zs=function(t){if(t!==null||this.Ds!==null){var e=this.Ds;this.Ds=t,(this.Ds===null||e!==null&&!this.Ds.equals(e))&&this.Ts.fire(),this.Xs()}},i.prototype.Xs=function(){this.Bs=null},i.prototype.Is=function(){this.Xs(),this.xs.clear()},i.prototype.Ps=function(){var t=this.kn.dateFormat;this.$.timeVisible?this.$s=new Jn({dateFormat:t,timeFormat:this.$.secondsVisible?"%h:%m:%s":"%h:%m",dateTimeSeparator:"   ",locale:this.kn.locale}):this.$s=new ui(t,this.kn.locale)},i.prototype.Os=function(){if(this.$.fixLeftEdge){var t=this.Ns.firstIndex();if(t!==null&&this.Ls!==t){this.Ls=t;var e=f(this.visibleBars()).firstBar()-t;if(e<0){var n=this.Vs-e-1;this.setRightOffset(n)}}}},i}(),er=function(i){function t(e){var n=i.call(this)||this;return n.th=new Map,n.m=e,n}return E(t,i),t.prototype._drawImpl=function(e){},t.prototype._drawBackgroundImpl=function(e){if(this.m.visible){e.save();for(var n=0,r=0,s=this.m.lines;r<s.length;r++)if((l=s[r]).text.length!==0){e.font=l.font;var o=this.ih(e,l.text);o>this.m.width?l.zoom=this.m.width/o:l.zoom=1,n+=l.lineHeight*l.zoom}var h=0;switch(this.m.vertAlign){case"top":h=0;break;case"center":h=Math.max((this.m.height-n)/2,0);break;case"bottom":h=Math.max(this.m.height-n,0)}e.fillStyle=this.m.color;for(var a=0,u=this.m.lines;a<u.length;a++){var l=u[a];e.save();var c=0;switch(this.m.horzAlign){case"left":e.textAlign="left",c=l.lineHeight/2;break;case"center":e.textAlign="center",c=this.m.width/2;break;case"right":e.textAlign="right",c=this.m.width-1-l.lineHeight/2}e.translate(c,h),e.textBaseline="top",e.font=l.font,e.scale(l.zoom,l.zoom),e.fillText(l.text,0,l.vertOffset),e.restore(),h+=l.lineHeight*l.zoom}e.restore()}},t.prototype.ih=function(e,n){var r=this.nh(e.font),s=r.get(n);return s===void 0&&(s=e.measureText(n).width,r.set(n,s)),s},t.prototype.nh=function(e){var n=this.th.get(e);return n===void 0&&(n=new Map,this.th.set(e,n)),n},t}(bt),ir=function(){function i(t){this.o=!0,this.p={visible:!1,color:"",height:0,width:0,lines:[],vertAlign:"center",horzAlign:"center"},this.g=new er(this.p),this.k=t}return i.prototype.update=function(){this.o=!0},i.prototype.renderer=function(t,e){return this.o&&(this.M(t,e),this.o=!1),this.g},i.prototype.M=function(t,e){var n=this.k.options(),r=this.p;r.visible=n.visible,r.visible&&(r.color=n.color,r.width=e,r.height=t,r.horzAlign=n.horzAlign,r.vertAlign=n.vertAlign,r.lines=[{text:n.text,font:dt(n.fontSize),lineHeight:1.2*n.fontSize,vertOffset:0,zoom:0}])},i}(),nr=function(i){function t(e,n){var r=i.call(this)||this;return r.$=n,r.J=new ir(r),r}return E(t,i),t.prototype.paneViews=function(){return[this.J]},t.prototype.options=function(){return this.$},t.prototype.updateAllViews=function(){this.J.update()},t}(se),rr=function(){function i(t,e){this.sh=[],this.hh=[],this.Kt=0,this.rh=null,this.uh=null,this.eh=new W,this.oh=new W,this.fh=t,this.$=e,this.ah=new $n(this),this.$n=new tr(this,e.timeScale,this.$.localization),this.lh=new jn,this.v=new rn(this,e.crosshair),this.vh=new Yn(e.crosshair),this.dh=new nr(this,e.watermark),this.createPane(),this.sh[0].setStretchFactor(2e3),this.sh[0].addDataSource(this.dh,!0,!1)}return i.prototype.fullUpdate=function(){this.Mh(new ot(3))},i.prototype.lightUpdate=function(){this.Mh(new ot(2))},i.prototype.updateSource=function(t){var e=this.wh(t);this.Mh(e)},i.prototype.hoveredSource=function(){return this.uh},i.prototype.setHoveredSource=function(t){var e=this.uh;this.uh=t,e!==null&&this.updateSource(e.source),t!==null&&this.updateSource(t.source)},i.prototype.options=function(){return this.$},i.prototype.applyOptions=function(t){w(this.$,t),t.priceScale!==void 0&&(this.mainPriceScale().applyOptions(t.priceScale),this.eh.fire()),t.timeScale!==void 0&&this.$n.applyOptions(t.timeScale),t.localization!==void 0&&(this.$n.applyLocalizationOptions(t.localization),this.mainPriceScale().updateFormatter()),this.fullUpdate()},i.prototype.updateAllPaneViews=function(){this.sh.forEach(function(t){return t.updateAllViews()}),this.updateCrosshair()},i.prototype.timeScale=function(){return this.$n},i.prototype.panes=function(){return this.sh},i.prototype.gridSource=function(){return this.lh},i.prototype.watermarkSource=function(){return this.dh},i.prototype.crosshairSource=function(){return this.v},i.prototype.crosshairMoved=function(){return this.oh},i.prototype.width=function(){return this.Kt},i.prototype.setPaneHeight=function(t,e){t.setHeight(e),this.recalculateAllPanes(),this.lightUpdate()},i.prototype.setWidth=function(t){this.Kt=t,this.$n.setWidth(this.Kt),this.sh.forEach(function(e){return e.setWidth(t)}),this.recalculateAllPanes()},i.prototype.createPane=function(t){var e=new Hn(this.$n,this);t!==void 0?this.sh.splice(t,0,e):this.sh.push(e);var n=t===void 0?this.sh.length-1:t,r=new ot(3);return r.invalidatePane(n,{level:0,autoScale:!0}),this.invalidate(r),e},i.prototype.startScalePrice=function(t,e,n){t.startScalePrice(e,n)},i.prototype.scalePriceTo=function(t,e,n){t.scalePriceTo(e,n),this.updateCrosshair(),this.Mh(this.bh(t,2))},i.prototype.endScalePrice=function(t,e){t.endScalePrice(e),this.Mh(this.bh(t,2))},i.prototype.startScrollPrice=function(t,e,n){e.isAutoScale()||t.startScrollPrice(e,n)},i.prototype.scrollPriceTo=function(t,e,n){e.isAutoScale()||(t.scrollPriceTo(e,n),this.updateCrosshair(),this.Mh(this.bh(t,2)))},i.prototype.endScrollPrice=function(t,e){e.isAutoScale()||(t.endScrollPrice(e),this.Mh(this.bh(t,2)))},i.prototype.setPriceAutoScale=function(t,e,n){t.setPriceAutoScale(e,n),this.Mh(this.bh(t,2))},i.prototype.resetPriceScale=function(t,e){t.resetPriceScale(e),this.Mh(this.bh(t,2))},i.prototype.startScaleTime=function(t){this.$n.startScale(t)},i.prototype.zoomTime=function(t,e){var n=this.timeScale();if(!n.isEmpty()&&e!==0){var r=n.width();t=Math.max(1,Math.min(t,r)),n.zoom(t,e),this.updateCrosshair(),this.recalculateAllPanes(),this.lightUpdate()}},i.prototype.scrollChart=function(t){this.startScrollTime(0),this.scrollTimeTo(t),this.endScrollTime()},i.prototype.scaleTimeTo=function(t){this.$n.scaleTo(t),this.recalculateAllPanes(),this.updateCrosshair(),this.lightUpdate()},i.prototype.endScaleTime=function(){this.$n.endScale(),this.lightUpdate()},i.prototype.startScrollTime=function(t){this.rh=t,this.$n.startScroll(t)},i.prototype.scrollTimeTo=function(t){var e=!1;return this.rh!==null&&Math.abs(t-this.rh)>20&&(this.rh=null,e=!0),this.$n.scrollTo(t),this.recalculateAllPanes(),this.updateCrosshair(),this.lightUpdate(),e},i.prototype.endScrollTime=function(){this.$n.endScroll(),this.lightUpdate(),this.rh=null},i.prototype.resetTimeScale=function(){this.$n.restoreDefault(),this.recalculateAllPanes(),this.updateCrosshair(),this.lightUpdate()},i.prototype.invalidate=function(t){this.fh&&this.fh(t),this.lh.invalidate(),this.lightUpdate()},i.prototype.dataSources=function(){return this.sh.reduce(function(t,e){return t.concat(e.dataSources())},[])},i.prototype.serieses=function(){return this.hh},i.prototype.setAndSaveCurrentPosition=function(t,e,n){this.v.saveOriginCoord(t,e);var r=NaN,s=this.$n.coordinateToIndex(t),o=this.$n.visibleBars();if(o!==null&&(s=Math.min(Math.max(o.firstBar(),s),o.lastBar())),n.mainDataSource()!==null){var h=n.defaultPriceScale(),a=h.firstValue();a!==null&&(r=h.coordinateToPrice(e,a)),r=this.vh.align(r,s,n)}this.v.setPosition(s,r,n),this.mh(),this.oh.fire(this.v.appliedIndex(),{x:t,y:e})},i.prototype.clearCurrentPosition=function(){this.crosshairSource().clearPosition(),this.mh(),this.oh.fire(null,null)},i.prototype.updateCrosshair=function(){var t=this.v.pane();if(t!==null){var e=this.v.originCoordX(),n=this.v.originCoordY();this.setAndSaveCurrentPosition(e,n,t)}},i.prototype.updateTimeScale=function(t,e,n,r){r&&this.$n.reset(),this.$n.update(t,e,n)},i.prototype.updateTimeScaleBaseIndex=function(t){var e=this.hh.reduce(function(a,u){var l=u.bars();if(l.isEmpty())return a;var c=f(l.lastIndex());return a===void 0?c:Math.max(c,a)},void 0);if(e!==void 0){var n=this.$n,r=n.baseIndex(),s=n.visibleBars();if(s!==null){var o=s.contains(r);if(t!==void 0&&t>0&&!o){var h=e-r;n.setRightOffset(n.rightOffset()-h)}}n.setBaseIndex(e)}this.updateCrosshair(),this.recalculateAllPanes(),this.lightUpdate()},i.prototype.recalculatePane=function(t){t!==null&&t.recalculate()},i.prototype.paneForSource=function(t){var e=this.sh.find(function(n){return n.orderedSources().includes(t)});return e===void 0?null:e},i.prototype.recalculateAllPanes=function(){this.sh.forEach(function(t){return t.recalculate()}),this.updateAllPaneViews()},i.prototype.destroy=function(){this.sh.forEach(function(t){return t.destroy()}),this.sh.length=0,this.$.localization.priceFormatter=void 0,this.$.localization.timeFormatter=void 0},i.prototype.setPriceAutoScaleForAllMainSources=function(){this.sh.map(function(t){return t.mainDataSource()}).forEach(function(t){t!==null&&f(t.priceScale()).setMode({autoScale:!0})})},i.prototype.rendererOptionsProvider=function(){return this.ah},i.prototype.priceAxisRendererOptions=function(){return this.ah.options()},i.prototype.mainPriceScaleOptionsChanged=function(){return this.eh},i.prototype.mainPriceScale=function(){return this.sh[0].defaultPriceScale()},i.prototype.createSeries=function(t,e){var n=this.sh[0],r=this.ph(e,t,n);return this.hh.push(r),this.hh.length===1?this.fullUpdate():this.lightUpdate(),r},i.prototype.removeSeries=function(t){var e=this.paneForSource(t),n=this.hh.indexOf(t);J(n!==-1,"Series not found"),this.hh.splice(n,1),f(e).removeDataSource(t),t.destroy&&t.destroy()},i.prototype.fitContent=function(){var t=new ot(2);t.setFitContent(),this.Mh(t)},i.prototype.setTargetTimeRange=function(t){var e=new ot(2);e.setTargetTimeRange(t),this.Mh(e)},i.prototype.bh=function(t,e){var n=new ot(e);if(t!==null){var r=this.sh.indexOf(t);n.invalidatePane(r,{level:e})}return n},i.prototype.wh=function(t,e){return e===void 0&&(e=2),this.bh(this.paneForSource(t),e)},i.prototype.Mh=function(t){this.fh&&this.fh(t),this.lh.invalidate()},i.prototype.mh=function(){this.Mh(new ot(1))},i.prototype.ph=function(t,e,n){var r=new at(this,t,e);return n.addDataSource(r,Boolean(t.overlay),!1),t.overlay&&r.applyOptions(t),r},i}(),j=function(){function i(t,e){this.w=t,this.h=e}return i.prototype.equals=function(t){return this.w===t.w&&this.h===t.h},i}();function Ht(i){return i.ownerDocument&&i.ownerDocument.defaultView&&i.ownerDocument.defaultView.devicePixelRatio||1}function nt(i){var t=f(i.getContext("2d"));return t.setTransform(1,0,0,1,0,0),t}function fi(i){var t=i.createElement("canvas");return function(e){e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.msUserSelect="none",e.style.MozUserSelect="none",e.style.webkitTapHighlightColor="transparent"}(t),t}function ye(i,t){var e=fi(i),n=Ht(e);return e.style.width=t.w+"px",e.style.height=t.h+"px",e.width=t.w*n,e.height=t.h*n,e}function ut(i,t){var e=fi(f(i.ownerDocument));i.appendChild(e);var n=new O(e);return n.resizeCanvas({width:t.w,height:t.h}),n}var di,sr=!!navigator.maxTouchPoints||!!navigator.msMaxTouchPoints||"ontouchstart"in window||Boolean(window.DocumentTouch&&document instanceof window.DocumentTouch),Kt="onorientationchange"in window&&sr,or=/Android/i.test(navigator.userAgent),hr=/iPhone|iPad|iPod|AppleWebKit.+Mobile/i.test(navigator.userAgent),vi=or||hr;(function(i){i[i.ResetClick=500]="ResetClick",i[i.LongTap=240]="LongTap"})(di||(di={}));var qt=function(){function i(t,e,n){this.gh=0,this.yh=null,this.kh=null,this.Nh=!1,this.Sh=null,this.xh=!1,this.Dh=!1,this.Ch=null,this.Th=null,this.Eh=null,this.Lh=null,this.Ah=0,this.Bh=!1,this.zh=!1,this.Vh=!1,this.Fh=t,this.Ph=e,this.$=n,this.Ih()}return i.prototype.destroy=function(){this.Ch!==null&&(this.Ch(),this.Ch=null),this.Th!==null&&(this.Th(),this.Th=null),this.Eh!==null&&(this.Eh(),this.Eh=null),this.Oh(),this.Rh()},i.prototype.Wh=function(t){var e=this;this.Th&&this.Th();var n=this.Uh.bind(this);this.Th=function(){e.Fh.removeEventListener("mousemove",n)},this.Fh.addEventListener("mousemove",n),lt(t)&&this.Uh(t);var r=this.qh(t);this.jh(r,this.Ph.mouseEnterEvent)},i.prototype.Rh=function(){this.yh!==null&&clearTimeout(this.yh),this.gh=0,this.yh=null},i.prototype.Uh=function(t){if(!this.Vh||lt(t)){var e=this.qh(t);this.jh(e,this.Ph.mouseMoveEvent)}},i.prototype.Hh=function(t){if((!("button"in t)||t.button===0)&&this.Lh===null){var e=lt(t);if(!this.zh||!e){this.Bh=!0;var n=this.qh(t),r=k(this.Sh),s=Math.abs(r.x-n.pageX),o=Math.abs(r.y-n.pageY),h=s+o>5;if(h||!e){if(h&&!this.xh&&e){var a=.5*s,u=o>=a&&!this.$.treatVertTouchDragAsPageScroll,l=a>o&&!this.$.treatHorzTouchDragAsPageScroll;u||l||(this.zh=!0)}h&&(this.xh=!0,this.Dh=!0,e&&this.Oh()),this.zh||(this.jh(n,this.Ph.pressedMouseMoveEvent),e&&me(t))}}}},i.prototype.Yh=function(t){if(!("button"in t)||t.button===0){var e=this.qh(t);this.Oh(),this.Sh=null,this.Vh=!1,this.Eh&&(this.Eh(),this.Eh=null),lt(t)&&this.Kh(t),this.jh(e,this.Ph.mouseUpEvent),++this.gh,this.yh&&this.gh>1?(this.jh(e,this.Ph.mouseDoubleClickEvent),this.Rh()):this.Dh||this.jh(e,this.Ph.mouseClickEvent),lt(t)&&(me(t),this.Kh(t),t.touches.length===0&&(this.Nh=!1))}},i.prototype.Oh=function(){this.kh!==null&&(clearTimeout(this.kh),this.kh=null)},i.prototype.$h=function(t){if(!("button"in t)||t.button===0){var e=this.qh(t);this.Dh=!1,this.xh=!1,this.zh=!1,lt(t)&&this.Wh(t),this.Sh={x:e.pageX,y:e.pageY},this.Eh&&(this.Eh(),this.Eh=null);var n=this.Hh.bind(this),r=this.Yh.bind(this),s=this.Fh.ownerDocument.documentElement;this.Eh=function(){s.removeEventListener("touchmove",n),s.removeEventListener("touchend",r),s.removeEventListener("mousemove",n),s.removeEventListener("mouseup",r)},s.addEventListener("touchmove",n,{passive:!1}),s.addEventListener("touchend",r,{passive:!1}),this.Oh(),lt(t)&&t.touches.length===1?this.kh=setTimeout(this._h.bind(this,t),240):(s.addEventListener("mousemove",n),s.addEventListener("mouseup",r)),this.Vh=!0,this.jh(e,this.Ph.mouseDownEvent),this.yh||(this.gh=0,this.yh=setTimeout(this.Rh.bind(this),500))}},i.prototype.Ih=function(){var t=this;this.Fh.addEventListener("mouseenter",this.Wh.bind(this)),this.Fh.addEventListener("touchcancel",this.Oh.bind(this));var e=this.Fh.ownerDocument,n=function(s){t.Ph.mouseDownOutsideEvent&&(s.target&&t.Fh.contains(s.target)||t.Ph.mouseDownOutsideEvent())};this.Ch=function(){e.removeEventListener("mousedown",n),e.removeEventListener("touchstart",n)},e.addEventListener("mousedown",n),e.addEventListener("touchstart",n,{passive:!0}),this.Fh.addEventListener("mouseleave",this.Kh.bind(this)),this.Fh.addEventListener("touchstart",this.$h.bind(this),{passive:!0}),Kt||this.Fh.addEventListener("mousedown",this.$h.bind(this)),this.Xh(),this.Fh.addEventListener("touchmove",function(){},{passive:!1})},i.prototype.Xh=function(){var t=this;this.Ph.pinchStartEvent===void 0&&this.Ph.pinchEvent===void 0&&this.Ph.pinchEndEvent===void 0||(this.Fh.addEventListener("touchstart",function(e){return t.Zh(e.touches)},{passive:!0}),this.Fh.addEventListener("touchmove",function(e){if(e.touches.length===2&&t.Lh!==null&&t.Ph.pinchEvent!==void 0){var n=mi(e.touches[0],e.touches[1])/t.Ah;t.Ph.pinchEvent(t.Lh,n),me(e)}},{passive:!1}),this.Fh.addEventListener("touchend",function(e){t.Zh(e.touches)}))},i.prototype.Zh=function(t){t.length===1&&(this.Bh=!1),t.length!==2||this.Bh||this.Nh?this.Jh():this.Gh(t)},i.prototype.Gh=function(t){var e=yi(this.Fh);this.Lh={x:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,y:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.Ah=mi(t[0],t[1]),this.Ph.pinchStartEvent!==void 0&&this.Ph.pinchStartEvent(),this.Oh()},i.prototype.Jh=function(){this.Lh!==null&&(this.Lh=null,this.Ph.pinchEndEvent!==void 0&&this.Ph.pinchEndEvent())},i.prototype.Kh=function(t){this.Th&&this.Th();var e=this.qh(t);this.jh(e,this.Ph.mouseLeaveEvent)},i.prototype._h=function(t){var e=this.qh(t);this.jh(e,this.Ph.longTapEvent),this.Dh=!0,this.Nh=!0},i.prototype.jh=function(t,e){e&&e.call(this.Ph,t)},i.prototype.qh=function(t){var e;e="touches"in t&&t.touches.length?t.touches[0]:"changedTouches"in t&&t.changedTouches.length?t.changedTouches[0]:t;var n=yi(this.Fh);return{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY,localX:e.clientX-n.left,localY:e.clientY-n.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,type:t.type.startsWith("mouse")?"mouse":"touch",target:e.target,view:t.view}},i}();function yi(i){return i.getBoundingClientRect()||{left:0,top:0}}function mi(i,t){var e=i.clientX-t.clientX,n=i.clientY-t.clientY;return Math.sqrt(e*e+n*n)}function lt(i){return Boolean(i.touches)}function me(i){i.cancelable&&i.preventDefault()}var gi,ar=function(){function i(t,e,n,r){if(this.Qh=0,this.tr=0,this.ir=0,this.nr=0,this.sr=0,this.hr=0,this.rr=0,this.ur=t,this.er=t.paneWidgets()[e],this.or=t.paneWidgets()[n],this.ar=document.createElement("tr"),this.ar.style.height="1px",this.cr=document.createElement("td"),this.cr.style.padding="0",this.cr.setAttribute("colspan","3"),this.lr(),this.ar.appendChild(this.cr),r)this.vr=null,this.dr=null;else{this.vr=document.createElement("div"),this.vr.style.position="absolute",this.vr.style.zIndex="50",this.vr.style.height="5px",this.vr.style.width="100%",this.vr.style.backgroundColor="rgba(255, 255, 255, 0.02)",this.vr.style.cursor="ns-resize",this.cr.appendChild(this.vr);var s={mouseDownEvent:this.Mr.bind(this),pressedMouseMoveEvent:this.wr.bind(this),mouseUpEvent:this.br.bind(this)};this.dr=new qt(this.vr,s,{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0})}}return i.prototype.destroy=function(){this.dr!==null&&this.dr.destroy()},i.prototype.getElement=function(){return this.ar},i.prototype.getSize=function(){return new j(this.er.getSize().w,1)},i.prototype.getImage=function(){var t=this.getSize(),e=ye(document,t),n=nt(e);return n.fillStyle=this.ur.options().timeScale.borderColor,n.fillRect(0,0,t.w,t.h),e},i.prototype.update=function(){this.lr()},i.prototype.lr=function(){this.cr.style.background=this.ur.options().timeScale.borderColor},i.prototype.Mr=function(t){this.Qh=t.pageY,this.tr=0,this.ir=this.er.getSize().h+this.or.getSize().h,this.nr=this.er.stretchFactor()+this.or.stretchFactor(),this.sr=30,this.hr=this.ir-this.sr,this.rr=this.nr/this.ir},i.prototype.wr=function(t){this.tr=t.pageY-this.Qh;var e=this.er.getSize().h,n=oe(e+this.tr,this.sr,this.hr)*this.rr,r=this.nr-n;this.er.setStretchFactor(n),this.or.setStretchFactor(r),this.ur.adjustSize(),this.er.getSize().h!==e&&(this.Qh=t.pageY)},i.prototype.br=function(t){this.Qh=0,this.tr=0,this.ir=0,this.nr=0,this.sr=0,this.hr=0,this.rr=0},i}(),bi=function(){function i(t,e,n,r){this.$t=new Ut(200),this.Zt=0,this.mr="",this.pr="",this.gr=[],this.yr=new Map,this.Zt=t,this.mr=e,this.pr=dt(t,n,r)}return i.prototype.destroy=function(){delete this.$t,this.gr=[],this.yr.clear()},i.prototype.paintTo=function(t,e,n,r,s){var o=this.kr(t,e);if(s!=="left"){var h=Ht(t.canvas);n-=Math.floor(o.textWidth*h)}r-=Math.floor(o.height/2),t.drawImage(o.canvas,n,r,o.width,o.height)},i.prototype.kr=function(t,e){var n,r=this;if(this.yr.has(e))n=F(this.yr.get(e));else{if(this.gr.length>=200){var s=F(this.gr.shift());this.yr.delete(s)}var o=Ht(t.canvas),h=Math.ceil(this.Zt/4.5),a=Math.round(this.Zt/10),u=Math.ceil(this.$t.measureText(t,e)),l=he(Math.round(u+2*h)),c=he(this.Zt+2*h),p=ye(document,new j(l,c));n={text:e,textWidth:Math.round(Math.max(1,u)),width:Math.ceil(l*o),height:Math.ceil(c*o),canvas:p},u!==0&&(this.gr.push(n.text),this.yr.set(n.text,n)),rt(t=nt(n.canvas),o,function(){t.font=r.pr,t.fillStyle=r.mr,t.fillText(e,0,c-h-a)})}return n},i}();(function(i){i[i.Default=0]="Default",i[i.NsResize=1]="NsResize"})(gi||(gi={}));var Si,wi,ur=function(){function i(t,e,n,r){var s=this;this.B=null,this.Nr=null,this.Sr=null,this.xr=!1,this.Dr=!0,this.Cr=new Ut(50),this.Tr=new bi(11,"#000"),this.mr=null,this.pr=null,this.Er=0,this.Lr=function(){s.Ar(s.ah.options()),s.I.chart().model().lightUpdate()},this.Br=function(){s.I.chart().model().lightUpdate()},this.I=t,this.$=e,this.ah=n,this.zr=r==="left",this.cr=document.createElement("div"),this.cr.style.height="100%",this.cr.style.overflow="hidden",this.cr.style.width="25px",this.cr.style.left="0",this.cr.style.position="relative",this.Vr=ut(this.cr,new j(16,16)),this.Vr.subscribeCanvasConfigured(this.Lr);var o=this.Vr.canvas;o.style.position="absolute",o.style.zIndex="1",o.style.left="0",o.style.top="0",this.Fr=ut(this.cr,new j(16,16)),this.Fr.subscribeCanvasConfigured(this.Br);var h=this.Fr.canvas;h.style.position="absolute",h.style.zIndex="2",h.style.left="0",h.style.top="0";var a={mouseDownEvent:this.Mr.bind(this),pressedMouseMoveEvent:this.wr.bind(this),mouseDownOutsideEvent:this.Pr.bind(this),mouseUpEvent:this.br.bind(this),mouseDoubleClickEvent:this.Ir.bind(this),mouseEnterEvent:this.Or.bind(this),mouseLeaveEvent:this.Rr.bind(this)};this.dr=new qt(this.Fr.canvas,a,{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0})}return i.prototype.destroy=function(){this.dr.destroy(),this.Fr.unsubscribeCanvasConfigured(this.Br),this.Fr.destroy(),this.Vr.unsubscribeCanvasConfigured(this.Lr),this.Vr.destroy(),this.B!==null&&(this.B.onMarksChanged().unsubscribeAll(this),this.B.optionsChanged().unsubscribeAll(this)),this.B=null,this.Sr!==null&&(clearTimeout(this.Sr),this.Sr=null),this.Tr.destroy()},i.prototype.getElement=function(){return this.cr},i.prototype.backgroundColor=function(){return this.$.backgroundColor},i.prototype.lineColor=function(){return this.I.chart().options().priceScale.borderColor},i.prototype.textColor=function(){return this.$.textColor},i.prototype.fontSize=function(){return this.$.fontSize},i.prototype.baseFont=function(){return dt(this.fontSize(),this.$.fontFamily)},i.prototype.rendererOptions=function(){var t=this.ah.options(),e=this.mr!==t.color,n=this.pr!==t.font;return(e||n)&&(this.Ar(t),this.mr=t.color),n&&(this.Cr.reset(),this.pr=t.font),t},i.prototype.optimalWidth=function(){if(!this.isVisible()||this.B===null)return 0;var t=34,e=this.rendererOptions(),n=nt(this.Vr.canvas),r=this.B.marks();n.font=this.baseFont(),r.length>0&&(t=Math.max(this.Cr.measureText(n,r[0].label),this.Cr.measureText(n,r[r.length-1].label)));for(var s=this.Wr(),o=s.length;o--;){var h=this.Cr.measureText(n,s[o].text());h>t&&(t=h)}var a=Math.ceil(e.borderSize+e.tickLength+e.paddingInner+e.paddingOuter+t);return a+a%2},i.prototype.setSize=function(t){if(t.w<0||t.h<0)throw new Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(t));this.Nr!==null&&this.Nr.equals(t)||(this.Nr=t,this.Vr.resizeCanvas({width:t.w,height:t.h}),this.Fr.resizeCanvas({width:t.w,height:t.h}),this.cr.style.width=t.w+"px",this.cr.style.height=t.h+"px",this.cr.style.minWidth=t.w+"px")},i.prototype.getWidth=function(){return f(this.Nr).w},i.prototype.setPriceScale=function(t){this.B!==t&&(this.B!==null&&(this.B.onMarksChanged().unsubscribeAll(this),this.B.optionsChanged().unsubscribeAll(this)),this.B=t,t.onMarksChanged().subscribe(this.cn.bind(this),this))},i.prototype.priceScale=function(){return this.B},i.prototype.isVisible=function(){return this.Dr},i.prototype.setVisible=function(t){t!==this.Dr&&(this.cr.style.display=t?"table-cell":"none",this.Dr=t)},i.prototype.setAutoScale=function(t){var e=this.I.state();this.I.chart().model().setPriceAutoScale(e,f(this.priceScale()),t)},i.prototype.reset=function(){var t=this.I.state();this.I.chart().model().resetPriceScale(t,f(this.priceScale()))},i.prototype.paint=function(t){if(this.Dr&&this.Nr!==null){if(t!==1){var e=nt(this.Vr.canvas);this.Ur(),this.qr(e,this.Vr.pixelRatio),this.Lt(e,this.Vr.pixelRatio),this.jr(e,this.Vr.pixelRatio),this.Hr(e,this.Vr.pixelRatio)}var n=nt(this.Fr.canvas),r=this.Nr.w,s=this.Nr.h;rt(n,this.Fr.pixelRatio,function(){n.clearRect(0,0,r,s)}),this.Yr(n,this.Fr.pixelRatio)}},i.prototype.getImage=function(){return this.Vr.canvas},i.prototype.isLeft=function(){return this.zr},i.prototype.Mr=function(t){if(this.B!==null&&!this.B.isEmpty()&&this.I.chart().options().handleScale.axisPressedMouseMove){var e=this.I.chart().model(),n=this.I.state();this.xr=!0,e.startScalePrice(n,this.B,t.localY)}},i.prototype.wr=function(t){if(this.B!==null&&this.I.chart().options().handleScale.axisPressedMouseMove){var e=this.I.chart().model(),n=this.I.state(),r=this.B;e.scalePriceTo(n,r,t.localY)}},i.prototype.Pr=function(){if(this.B!==null&&this.I.chart().options().handleScale.axisPressedMouseMove){var t=this.I.chart().model(),e=this.I.state(),n=this.B;this.xr&&(this.xr=!1,t.endScalePrice(e,n))}},i.prototype.br=function(t){if(this.B!==null&&this.I.chart().options().handleScale.axisPressedMouseMove){var e=this.I.chart().model(),n=this.I.state();this.xr=!1,e.endScalePrice(n,this.B)}},i.prototype.Ir=function(t){this.I.chart().options().handleScale.axisDoubleClickReset&&this.reset()},i.prototype.Or=function(t){this.B!==null&&(!this.I.chart().model().options().handleScale.axisPressedMouseMove||this.B.isPercentage()||this.B.isIndexedTo100()||this.Kr(1))},i.prototype.Rr=function(t){this.Kr(0)},i.prototype.Wr=function(){var t=this,e=[],n=this.B===null?void 0:this.B;return function(r){for(var s=0;s<r.length;++s)for(var o=r[s].priceAxisViews(t.I.state(),n),h=0;h<o.length;h++)e.push(o[h])}(this.I.state().orderedSources()),e},i.prototype.qr=function(t,e){var n=this;if(this.Nr!==null){var r=this.Nr.w,s=this.Nr.h;rt(t,e,function(){It(t,0,0,r,s,n.backgroundColor())})}},i.prototype.Lt=function(t,e){if(this.Nr!==null&&this.B!==null&&this.B.options().borderVisible){t.save(),t.fillStyle=this.lineColor();var n,r=Math.max(1,Math.floor(this.rendererOptions().borderSize*e));n=this.zr?Math.floor(this.Nr.w*e)-r:0,t.fillRect(n,0,r,Math.ceil(this.Nr.h*e)),t.restore()}},i.prototype.jr=function(t,e){if(this.Nr!==null&&this.B!==null){var n=this.B.marks();t.save(),t.strokeStyle=this.lineColor(),t.font=this.baseFont(),t.fillStyle=this.lineColor();var r=this.rendererOptions(),s=this.B.options().borderVisible,o=this.zr?Math.floor((this.Nr.w-r.tickLength)*e-r.borderSize*e):Math.floor(r.borderSize*e),h=this.zr?Math.round(o-r.paddingInner*e):Math.round(o+r.tickLength*e+r.paddingInner*e),a=this.zr?"right":"left",u=Math.max(1,Math.floor(e)),l=Math.floor(.5*e);if(s){var c=Math.round(r.tickLength*e);t.beginPath();for(var p=0,d=n;p<d.length;p++){var y=d[p];t.rect(o,Math.round(y.coord*e)-l,c,u)}t.fill()}t.fillStyle=this.textColor();for(var v=0,m=n;v<m.length;v++)y=m[v],this.Tr.paintTo(t,y.label,h,Math.round(y.coord*e),a);t.restore()}},i.prototype.Ur=function(){if(this.Nr!==null&&this.B!==null){var t=this.Nr.h/2,e=[],n=this.B.orderedSources().slice(),r=this.I.state(),s=this.rendererOptions();this.B===r.defaultPriceScale()&&this.I.state().orderedSources().forEach(function(m){r.isOverlay(m)&&n.push(m)});var o=this.B.mainSource(),h=this.B;n.forEach(function(m){var g=m.priceAxisViews(r,h);g.forEach(function(M){M.setFixedCoordinate(null),M.isVisible()&&e.push(M)}),o===m&&g.length>0&&(t=g[0].coordinate())});var a=e.filter(function(m){return m.coordinate()<=t}),u=e.filter(function(m){return m.coordinate()>t});if(a.sort(function(m,g){return g.coordinate()-m.coordinate()}),a.length&&u.length&&u.push(a[0]),u.sort(function(m,g){return m.coordinate()-g.coordinate()}),e.forEach(function(m){return m.setFixedCoordinate(m.coordinate())}),this.B.options().alignLabels){for(var l=1;l<a.length;l++){var c=a[l],p=(y=a[l-1]).height(s,!1);c.coordinate()>(v=y.getFixedCoordinate())-p&&c.setFixedCoordinate(v-p)}for(var d=1;d<u.length;d++){var y,v;c=u[d],p=(y=u[d-1]).height(s,!0),c.coordinate()<(v=y.getFixedCoordinate())+p&&c.setFixedCoordinate(v+p)}}}},i.prototype.Hr=function(t,e){var n=this;if(this.Nr!==null){t.save();var r=this.Nr,s=this.Wr(),o=this.rendererOptions(),h=this.zr?"right":"left";s.forEach(function(a){if(a.isAxisLabelVisible()){var u=a.renderer();t.save(),u.draw(t,o,n.Cr,r.w,h,e),t.restore()}}),t.restore()}},i.prototype.Yr=function(t,e){var n=this;if(this.Nr!==null&&this.B!==null){t.save();var r=this.Nr,s=this.I.chart().model(),o=[],h=this.I.state(),a=s.crosshairSource().priceAxisViews(h,this.B);a.length&&o.push(a);var u=this.rendererOptions(),l=this.zr?"right":"left";o.forEach(function(c){c.forEach(function(p){t.save(),p.renderer().draw(t,u,n.Cr,r.w,l,e),t.restore()})}),t.restore()}},i.prototype.Kr=function(t){this.cr.style.cursor=t===1?"ns-resize":"default"},i.prototype.cn=function(){var t=this,e=this.optimalWidth();if(this.Er<e){var n=this.I.chart();this.Sr===null&&(this.Sr=setTimeout(function(){n&&n.model().fullUpdate(),t.Sr=null},100))}this.Er=e},i.prototype.Ar=function(t){this.Tr.destroy(),this.Tr=new bi(t.fontSize,t.color,t.fontFamily)},i}(),ge=vi,lr=function(){function i(t,e){var n=this;this.Nr=new j(0,0),this.$r=null,this._r=null,this.Xr=!1,this.Zr="none",this.Jr=new W,this.Gr=0,this.Qr=!1,this.tu=null,this.iu=!1,this.nu=null,this.Lr=function(){return n.su&&n.F().lightUpdate()},this.Br=function(){return n.su&&n.F().lightUpdate()},this.hu=t,this.su=e,this.su.onDestroyed().subscribe(this.ru.bind(this),this,!0),this.uu=document.createElement("td"),this.uu.style.padding="0",this.uu.style.position="relative";var r=document.createElement("div");r.style.width="100%",r.style.height="100%",r.style.position="relative",r.style.overflow="hidden",this.eu=document.createElement("td"),this.eu.style.padding="0",this.ou=document.createElement("td"),this.ou.style.padding="0",this.uu.appendChild(r),this.Vr=ut(r,new j(16,16)),this.Vr.subscribeCanvasConfigured(this.Lr);var s=this.Vr.canvas;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.Fr=ut(r,new j(16,16)),this.Fr.subscribeCanvasConfigured(this.Br);var o=this.Fr.canvas;o.style.position="absolute",o.style.zIndex="2",o.style.left="0",o.style.top="0",this.ar=document.createElement("tr"),this.ar.appendChild(this.eu),this.ar.appendChild(this.uu),this.ar.appendChild(this.ou),this.fu(),t.model().mainPriceScaleOptionsChanged().subscribe(this.au.bind(this),this),this.updatePriceAxisWidget();var h=this.chart().options().handleScroll;this.dr=new qt(this.Fr.canvas,this,{treatVertTouchDragAsPageScroll:!h.vertTouchDrag,treatHorzTouchDragAsPageScroll:!h.horzTouchDrag})}return i.prototype.destroy=function(){this.$r!==null&&this.$r.destroy(),this.Fr.unsubscribeCanvasConfigured(this.Br),this.Fr.destroy(),this.Vr.unsubscribeCanvasConfigured(this.Lr),this.Vr.destroy(),this.su!==null&&this.su.onDestroyed().unsubscribeAll(this),this.dr.destroy()},i.prototype.state=function(){return f(this.su)},i.prototype.stateOrNull=function(){return this.su},i.prototype.setState=function(t){this.su!==null&&this.su.onDestroyed().unsubscribeAll(this),this.su=t,this.su!==null&&this.su.onDestroyed().subscribe(i.prototype.ru.bind(this),this,!0),this.updatePriceAxisWidget()},i.prototype.chart=function(){return this.hu},i.prototype.getElement=function(){return this.ar},i.prototype.updatePriceAxisWidget=function(){if(this.su!==null&&this.$r!==null&&this.F().serieses().length!==0){var t=this.su.defaultPriceScale();this.$r.setPriceScale(f(t))}},i.prototype.stretchFactor=function(){return this.su!==null?this.su.stretchFactor():0},i.prototype.setStretchFactor=function(t){this.su&&this.su.setStretchFactor(t)},i.prototype.mouseEnterEvent=function(t){if(this.su){var e=t.localX,n=t.localY;Kt||this.cu(e,n)}},i.prototype.mouseDownEvent=function(t){if(this.Qr=!1,this.iu=this.tu!==null,this.su){if(document.activeElement!==document.body&&document.activeElement!==document.documentElement)f(document.activeElement).blur();else{var e=document.getSelection();e!==null&&e.removeAllRanges()}var n=this.F();if(!this.su.defaultPriceScale().isEmpty()&&!n.timeScale().isEmpty()){if(this.tu!==null){var r=n.crosshairSource();this.nu={x:r.appliedX(),y:r.appliedY()},this.tu={x:t.localX,y:t.localY}}Kt||this.cu(t.localX,t.localY)}}},i.prototype.mouseMoveEvent=function(t){if(this.su){var e=t.localX,n=t.localY;if(this.lu()&&this.vu(),!Kt){this.cu(e,n);var r=this.hitTest(e,n);this.F().setHoveredSource(r&&{source:r.source,object:r.object}),r!==null&&r.view.moveHandler!==void 0&&r.view.moveHandler(e,n)}}},i.prototype.mouseClickEvent=function(t){if(this.su!==null){var e=t.localX,n=t.localY,r=this.hitTest(e,n);if(r!==null&&r.view.clickHandler!==void 0&&r.view.clickHandler(e,n),this.Jr.hasListeners()){var s=this.F().crosshairSource().appliedIndex();this.Jr.fire(s,{x:e,y:n})}this.du()}},i.prototype.pressedMouseMoveEvent=function(t){if(this.su!==null){var e=this.F(),n=t.localX,r=t.localY;if(this.tu!==null){this.iu=!1;var s=f(this.nu),o=s.x+(n-this.tu.x),h=s.y+(r-this.tu.y);this.cu(o,h)}else this.lu()||this.cu(n,r);if(!e.timeScale().isEmpty()){var a=this.hu.options().handleScroll;if(a.pressedMouseMove&&t.type!=="touch"||(a.horzTouchDrag||a.vertTouchDrag)&&t.type!=="mouse"){var u=this.su.defaultPriceScale();this._r!==null||this.Mu()||(this._r={x:t.clientX,y:t.clientY}),this._r===null||this._r.x===t.clientX&&this._r.y===t.clientY||this.Xr||(u.isEmpty()||e.startScrollPrice(this.su,u,t.localY),e.startScrollTime(t.localX),this.Xr=!0),this.Xr&&(u.isEmpty()||e.scrollPriceTo(this.su,u,t.localY),e.scrollTimeTo(t.localX))}}}},i.prototype.mouseUpEvent=function(t){if(this.su!==null){this.Qr=!1;var e=this.F();if(this.Xr){var n=this.su.defaultPriceScale();e.endScrollPrice(this.su,n),e.endScrollTime(),this._r=null,this.Xr=!1}}},i.prototype.longTapEvent=function(t){if(this.Qr=!0,this.tu===null&&ge){var e={x:t.localX,y:t.localY};this.wu(e,e)}},i.prototype.mouseLeaveEvent=function(t){this.su!==null&&(this.su.model().setHoveredSource(null),vi||this.vu())},i.prototype.clicked=function(){return this.Jr},i.prototype.pinchStartEvent=function(){this.Gr=1},i.prototype.pinchEvent=function(t,e){if(this.hu.options().handleScale.pinch){var n=5*(e-this.Gr);this.Gr=e,this.F().zoomTime(t.x,n)}},i.prototype.hitTest=function(t,e){var n=this.su;if(n===null)return null;for(var r=0,s=n.orderedSources();r<s.length;r++){var o=s[r],h=this.bu(o.paneViews(n),t,e);if(h!==null)return{source:o,view:h.view,object:h.object}}return null},i.prototype.setPriceAxisSize=function(t){f(this.$r).setSize(new j(t,this.Nr.h))},i.prototype.getSize=function(){return this.Nr},i.prototype.setSize=function(t){if(t.w<0||t.h<0)throw new Error("Try to set invalid size to PaneWidget "+JSON.stringify(t));this.Nr.equals(t)||(this.Nr=t,this.Vr.resizeCanvas({width:t.w,height:t.h}),this.Fr.resizeCanvas({width:t.w,height:t.h}),this.uu.style.width=t.w+"px",this.uu.style.height=t.h+"px")},i.prototype.recalculatePriceScale=function(){var t=f(this.su);t.recalculatePriceScale(t.defaultPriceScale());for(var e=0,n=t.dataSources();e<n.length;e++){var r=n[e];if(t.isOverlay(r)){var s=r.priceScale();s!==null&&t.recalculatePriceScale(s),r.updateAllViews()}}},i.prototype.getImage=function(){return this.Vr.canvas},i.prototype.paint=function(t){if(t!==0&&this.su!==null){if(t>1&&this.recalculatePriceScale(),this.$r!==null&&this.$r.paint(t),t!==1){var e=nt(this.Vr.canvas);e.save(),this.qr(e,this.mu(),this.Vr.pixelRatio),this.su&&(this.pu(e,this.Vr.pixelRatio),this.gu(e,this.Vr.pixelRatio),this.yu(e,this.Vr.pixelRatio)),e.restore()}var n=nt(this.Fr.canvas);n.clearRect(0,0,Math.ceil(this.Nr.w*this.Fr.pixelRatio),Math.ceil(this.Nr.h*this.Fr.pixelRatio)),this.ku(n,this.Fr.pixelRatio)}},i.prototype.priceAxisWidget=function(){return this.$r},i.prototype.mu=function(){return this.hu.options().layout.backgroundColor},i.prototype.ru=function(){this.su!==null&&this.su.onDestroyed().unsubscribeAll(this),this.su=null},i.prototype.qr=function(t,e,n){var r=this;rt(t,n,function(){It(t,0,0,r.Nr.w,r.Nr.h,e)})},i.prototype.pu=function(t,e){for(var n=f(this.su),r=this.F().gridSource().paneViews(n),s=n.height(),o=n.width(),h=0,a=r;h<a.length;h++){var u=a[h];t.save();var l=u.renderer(s,o);l!==null&&l.draw(t,e,!1),t.restore()}},i.prototype.gu=function(t,e){var n=this.F().watermarkSource();if(n!==null){var r=f(this.su);if(r.containsSeries())for(var s=n.paneViews(),o=r.height(),h=r.width(),a=0,u=s;a<u.length;a++){var l=u[a];t.save();var c=l.renderer(o,h);c!==null&&c.draw(t,e,!1),t.restore()}}},i.prototype.ku=function(t,e){this.Nu(this.F().crosshairSource(),t,e)},i.prototype.yu=function(t,e){for(var n=f(this.su).orderedSources(),r=this.F().crosshairSource(),s=0,o=n;s<o.length;s++){var h=o[s];this.Su(h,t,e)}for(var a=0,u=n;a<u.length;a++)(h=u[a])!==r&&this.Nu(h,t,e)},i.prototype.Nu=function(t,e,n){for(var r=f(this.su),s=t.paneViews(r),o=r.height(),h=r.width(),a=r.model().hoveredSource(),u=a!==null&&a.source===t,l=a!==null&&u&&a.object!==void 0?a.object.hitTestData:void 0,c=0,p=s;c<p.length;c++){var d=p[c].renderer(o,h);d!==null&&(e.save(),d.draw(e,n,u,l),e.restore())}},i.prototype.Su=function(t,e,n){for(var r=f(this.su),s=t.paneViews(r),o=r.height(),h=r.width(),a=r.model().hoveredSource(),u=a!==null&&a.source===t,l=a!==null&&u&&a.object!==void 0?a.object.hitTestData:void 0,c=0,p=s;c<p.length;c++){var d=p[c].renderer(o,h);d!==null&&d.drawBackground!==void 0&&(e.save(),d.drawBackground(e,n,u,l),e.restore())}},i.prototype.bu=function(t,e,n){for(var r=0,s=t;r<s.length;r++){var o=s[r],h=o.renderer(this.Nr.h,this.Nr.w);if(h!==null&&h.hitTest){var a=h.hitTest(e,n);if(a!==null)return{view:o,object:a}}}return null},i.prototype.au=function(){this.fu(),this.hu.adjustSize()},i.prototype.fu=function(){if(this.su!==null){var t=this.hu,e=this.su.defaultPriceScale().options().position;if(this.Zr!==e){if(this.$r!==null&&(this.$r.isLeft()?this.eu.removeChild(this.$r.getElement()):this.ou.removeChild(this.$r.getElement()),this.$r.destroy(),this.$r=null),e!=="none"){var n=t.model().rendererOptionsProvider();this.$r=new ur(this,t.options().layout,n,e),e==="left"&&this.eu.appendChild(this.$r.getElement()),e==="right"&&this.ou.appendChild(this.$r.getElement())}this.Zr=e}}},i.prototype.lu=function(){return ge&&this.tu===null},i.prototype.Mu=function(){return ge&&this.Qr||this.tu!==null},i.prototype.xu=function(t){return Math.max(0,Math.min(t,this.Nr.w-1))},i.prototype.Du=function(t){return Math.max(0,Math.min(t,this.Nr.h-1))},i.prototype.cu=function(t,e){this.F().setAndSaveCurrentPosition(this.xu(t),this.Du(e),f(this.su))},i.prototype.vu=function(){this.F().clearCurrentPosition()},i.prototype.du=function(){this.iu&&(this.tu=null,this.vu())},i.prototype.wu=function(t,e){this.tu=t,this.iu=!1,this.cu(e.x,e.y);var n=this.F().crosshairSource();this.nu={x:n.appliedX(),y:n.appliedY()}},i.prototype.F=function(){return this.hu.model()},i}(),cr=function(){function i(t,e,n,r){var s=this;this.o=!0,this.Nr=new j(0,0),this.Lr=function(){return s.paint(3)},this.zr=t==="left",this.ah=n.rendererOptionsProvider,this.$=e,this.Cu=r,this.cr=document.createElement("div"),this.cr.style.width="25px",this.cr.style.height="100%",this.cr.style.overflow="hidden",this.Vr=ut(this.cr,new j(16,16)),this.Vr.subscribeCanvasConfigured(this.Lr)}return i.prototype.destroy=function(){this.Vr.unsubscribeCanvasConfigured(this.Lr),this.Vr.destroy()},i.prototype.update=function(){this.o=!0},i.prototype.getElement=function(){return this.cr},i.prototype.getSize=function(){return this.Nr},i.prototype.setSize=function(t){if(t.w<0||t.h<0)throw new Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(t));this.Nr.equals(t)||(this.Nr=t,this.Vr.resizeCanvas({width:t.w,height:t.h}),this.cr.style.width=t.w+"px",this.cr.style.minWidth=t.w+"px",this.cr.style.height=t.h+"px",this.o=!0)},i.prototype.paint=function(t){if((!(t<3)||this.o)&&this.Nr.w!==0&&this.Nr.h!==0){this.o=!1;var e=nt(this.Vr.canvas);this.qr(e,this.Vr.pixelRatio),this.Lt(e,this.Vr.pixelRatio)}},i.prototype.getImage=function(){return this.Vr.canvas},i.prototype.isLeft=function(){return this.zr},i.prototype.Lt=function(t,e){if(this.Cu()){var n=this.Nr.w;t.save(),t.fillStyle=this.$.timeScale.borderColor;var r=Math.floor(this.ah.options().borderSize*e),s=this.zr?Math.round(n*e)-r:0;t.fillRect(s,0,r,r),t.restore()}},i.prototype.qr=function(t,e){var n=this;rt(t,e,function(){It(t,0,0,n.Nr.w,n.Nr.h,n.$.layout.backgroundColor)})},i}();function pr(i,t){return i.span>t.span?i:t}(function(i){i[i.BorderSize=1]="BorderSize",i[i.TickLength=3]="TickLength"})(Si||(Si={})),function(i){i[i.Default=0]="Default",i[i.EwResize=1]="EwResize"}(wi||(wi={}));var fr=function(){function i(t){var e=this;this.Tu=null,this.Eu=70,this.Ht=null,this.Lu=!1,this.Nr=new j(0,0),this.Zr="none",this.Lr=function(){return e.hu.model().lightUpdate()},this.Br=function(){return e.hu.model().lightUpdate()},this.hu=t,this.$=t.options().layout,this.Au=document.createElement("tr"),this.Bu=document.createElement("td"),this.Bu.style.padding="0",this.zu=document.createElement("td"),this.zu.style.padding="0",this.cr=document.createElement("td"),this.cr.style.height="25px",this.cr.style.padding="0",this.Vu=document.createElement("div"),this.Vu.style.width="100%",this.Vu.style.height="100%",this.Vu.style.position="relative",this.Vu.style.overflow="hidden",this.cr.appendChild(this.Vu),this.Vr=ut(this.Vu,new j(16,16)),this.Vr.subscribeCanvasConfigured(this.Lr);var n=this.Vr.canvas;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Fr=ut(this.Vu,new j(16,16)),this.Fr.subscribeCanvasConfigured(this.Br);var r=this.Fr.canvas;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.Au.appendChild(this.Bu),this.Au.appendChild(this.cr),this.Au.appendChild(this.zu),this.Fu(),this.hu.model().mainPriceScaleOptionsChanged().subscribe(this.Fu.bind(this),this),this.dr=new qt(this.Fr.canvas,this,{treatVertTouchDragAsPageScroll:!0,treatHorzTouchDragAsPageScroll:!1})}return i.prototype.destroy=function(){this.dr.destroy(),this.Tu!==null&&this.Tu.destroy(),this.Fr.unsubscribeCanvasConfigured(this.Br),this.Fr.destroy(),this.Vr.unsubscribeCanvasConfigured(this.Lr),this.Vr.destroy()},i.prototype.getElement=function(){return this.Au},i.prototype.stub=function(){return this.Tu},i.prototype.mouseDownEvent=function(t){if(!this.Lu){this.Lu=!0;var e=this.hu.model();!e.timeScale().isEmpty()&&this.hu.options().handleScale.axisPressedMouseMove&&e.startScaleTime(t.localX)}},i.prototype.mouseDownOutsideEvent=function(){var t=this.hu.model();!t.timeScale().isEmpty()&&this.Lu&&(this.Lu=!1,this.hu.options().handleScale.axisPressedMouseMove&&t.endScaleTime())},i.prototype.pressedMouseMoveEvent=function(t){var e=this.hu.model();!e.timeScale().isEmpty()&&this.hu.options().handleScale.axisPressedMouseMove&&e.scaleTimeTo(t.localX)},i.prototype.mouseUpEvent=function(t){this.Lu=!1;var e=this.hu.model();e.timeScale().isEmpty()&&!this.hu.options().handleScale.axisPressedMouseMove||e.endScaleTime()},i.prototype.mouseDoubleClickEvent=function(){this.hu.options().handleScale.axisDoubleClickReset&&this.hu.model().resetTimeScale()},i.prototype.mouseEnterEvent=function(t){this.hu.model().options().handleScale.axisPressedMouseMove&&this.Kr(1)},i.prototype.mouseLeaveEvent=function(t){this.Kr(0)},i.prototype.getSize=function(){return this.Nr},i.prototype.setSizes=function(t,e){this.Nr&&this.Nr.equals(t)||(this.Nr=t,this.Vr.resizeCanvas({width:t.w,height:t.h}),this.Fr.resizeCanvas({width:t.w,height:t.h}),this.cr.style.width=t.w+"px",this.cr.style.height=t.h+"px"),this.Tu!==null&&this.Tu.setSize(new j(e,t.h))},i.prototype.width=function(){return this.Nr.w},i.prototype.height=function(){return this.Nr.h},i.prototype.optimalHeight=function(){var t=this.Pu();return Math.ceil(t.borderSize+t.tickLength+t.fontSize+t.paddingTop+t.paddingBottom)},i.prototype.update=function(){var t=this,e=this.hu.model().timeScale().marks();e&&(this.Eu=70,e.forEach(function(n){t.Eu=Math.min(n.span,t.Eu)}))},i.prototype.getImage=function(){return this.Vr.canvas},i.prototype.paint=function(t){if(t!==0){if(t!==1){var e=nt(this.Vr.canvas);this.qr(e,this.Vr.pixelRatio),this.Lt(e,this.Vr.pixelRatio),this.jr(e,this.Vr.pixelRatio),this.Hr(e,this.Vr.pixelRatio),this.Tu!==null&&this.Tu.paint(t)}var n=nt(this.Fr.canvas);this.Yr(n,this.Fr.pixelRatio)}},i.prototype.qr=function(t,e){var n=this;rt(t,e,function(){It(t,0,0,n.Nr.w,n.Nr.h,n.mu())})},i.prototype.Lt=function(t,e){if(this.hu.options().timeScale.borderVisible){t.save(),t.fillStyle=this.Iu();var n=Math.max(1,Math.floor(this.Pu().borderSize*e));t.fillRect(0,0,Math.ceil(this.Nr.w*e),n),t.restore()}},i.prototype.jr=function(t,e){var n=this,r=this.hu.model().timeScale().marks();if(r&&r.length!==0){var s=r.reduce(pr,r[0]).span;s>30&&s<40&&(s=30),t.save(),t.strokeStyle=this.Iu();var o=this.Pu(),h=o.borderSize+o.tickLength+o.paddingTop+o.fontSize-o.baselineOffset;t.textAlign="center",t.fillStyle=this.Iu();var a=Math.floor(this.Pu().borderSize*e),u=Math.max(1,Math.floor(e)),l=Math.floor(.5*e);if(this.hu.model().timeScale().options().borderVisible){t.beginPath();for(var c=Math.round(o.tickLength*e),p=r.length;p--;){var d=Math.round(r[p].coord*e);t.rect(d-l,a,u,c)}t.fill()}t.fillStyle=this.Pn(),rt(t,e,function(){t.font=n.Ou();for(var y=0,v=r;y<v.length;y++)(M=v[y]).span<s&&t.fillText(M.label,M.coord,h);t.font=n.Ru();for(var m=0,g=r;m<g.length;m++){var M;(M=g[m]).span>=s&&t.fillText(M.label,M.coord,h)}})}},i.prototype.Hr=function(t,e){t.save();var n=new Set,r=this.hu.model(),s=r.dataSources();n.add(r.crosshairSource());for(var o=this.Pu(),h=0,a=s;h<a.length;h++){var u=a[h];if(!n.has(u))for(var l=0,c=u.timeAxisViews();l<c.length;l++)c[l].renderer().draw(t,o,e)}t.restore()},i.prototype.Yr=function(t,e){t.save(),t.clearRect(0,0,Math.ceil(this.Nr.w*e),Math.ceil(this.Nr.h*e));var n=[],r=this.hu.model().crosshairSource().timeAxisViews();n.push(r);var s=this.Pu();n.forEach(function(o){o.forEach(function(h){t.save(),h.renderer().draw(t,s,e),t.restore()})}),t.restore()},i.prototype.mu=function(){return this.$.backgroundColor},i.prototype.Iu=function(){return this.hu.options().timeScale.borderColor},i.prototype.Pn=function(){return this.$.textColor},i.prototype.Zt=function(){return this.$.fontSize},i.prototype.Ou=function(){return dt(this.Zt(),this.$.fontFamily)},i.prototype.Ru=function(){return dt(this.Zt(),this.$.fontFamily,"bold")},i.prototype.Pu=function(){this.Ht===null&&(this.Ht={borderSize:1,baselineOffset:NaN,paddingTop:NaN,paddingBottom:NaN,paddingHorizontal:NaN,tickLength:3,fontSize:NaN,font:"",widthCache:new Ut});var t=this.Ht,e=this.Ou();if(t.font!==e){var n=this.Zt();t.fontSize=n,t.font=e,t.paddingTop=Math.ceil(n/2.5),t.paddingBottom=t.paddingTop,t.paddingHorizontal=Math.ceil(n/2),t.baselineOffset=Math.round(this.Zt()/5),t.widthCache.reset()}return this.Ht},i.prototype.Kr=function(t){this.cr.style.cursor=t===1?"ew-resize":"default"},i.prototype.Fu=function(){var t=this.hu.model().mainPriceScale().options().position;if(t!==this.Zr){if(this.Tu!==null&&(this.Tu.isLeft()?this.Bu.removeChild(this.Tu.getElement()):this.zu.removeChild(this.Tu.getElement()),this.Tu.destroy(),this.Tu=null),t!=="none"){var e={rendererOptionsProvider:this.hu.model().rendererOptionsProvider()},n=this.hu.model();this.Tu=new cr(t,this.hu.options(),e,function(){return n.mainPriceScale().options().borderVisible&&n.timeScale().options().borderVisible}),(t==="left"?this.Bu:this.zu).appendChild(this.Tu.getElement())}this.Zr=t}},i}(),dr=function(){function i(t,e){var n=this;this.Wu=[],this.Uu=[],this.qu=0,this.ju=new W,this.nn=0,this.Kt=0,this.Hu=0,this.Yu=null,this.Ku=!1,this.Jr=new W,this.oh=new W,this.$=e,this.Au=document.createElement("div"),this.Au.classList.add("tv-lightweight-charts"),this.Au.style.overflow="hidden",this.Au.style.width="100%",this.Au.style.height="100%",this.$u=document.createElement("table"),this.$u.setAttribute("cellspacing","0"),this.Au.appendChild(this.$u),this._u=this.Xu.bind(this),this.Au.addEventListener("wheel",this._u,{passive:!1}),this.F=new rr(this.fh.bind(this),this.$),this.model().crosshairMoved().subscribe(this.Zu.bind(this),this),this.Ju=new fr(this),this.$u.appendChild(this.Ju.getElement());var r=this.$.width,s=this.$.height;if(r===0&&s===0){var o=t.getBoundingClientRect();(r=Math.floor(o.width))%2&&(r-=1),(s=Math.floor(o.height))%2&&(s-=1)}r=Math.max(70,r),s=Math.max(50,s),this.resize(r,s),this.Gu(),t.appendChild(this.Au),this.Qu(),this.F.timeScale().optionsApplied().subscribe(function(){n.Qu(),n.adjustSize()},this)}return i.prototype.model=function(){return this.F},i.prototype.options=function(){return this.$},i.prototype.paneWidgets=function(){return this.Wu},i.prototype.destroy=function(){this.Au.removeEventListener("wheel",this._u),this.qu!==0&&window.cancelAnimationFrame(this.qu),this.F.crosshairMoved().unsubscribeAll(this),this.F.timeScale().optionsApplied().unsubscribeAll(this),this.F.destroy();for(var t=0,e=this.Wu;t<e.length;t++){var n=e[t];this.$u.removeChild(n.getElement()),n.clicked().unsubscribeAll(this),n.destroy()}this.Wu=[];for(var r=0,s=this.Uu;r<s.length;r++){var o=s[r];this.te(o)}this.Uu=[],f(this.Ju).destroy(),this.Au.parentElement!==null&&this.Au.parentElement.removeChild(this.Au),this.oh.destroy(),this.Jr.destroy(),delete this.Au},i.prototype.resize=function(t,e,n){if(n===void 0&&(n=!1),this.nn!==e||this.Kt!==t){this.nn=e,this.Kt=t;var r=e+"px",s=t+"px";f(this.Au).style.height=r,f(this.Au).style.width=s,this.$u.style.height=r,this.$u.style.width=s,n?this.ie(new ot(3)):this.F.fullUpdate()}},i.prototype.paint=function(t){t===void 0&&(t=new ot(3));for(var e=0;e<this.Wu.length;e++)this.Wu[e].paint(t.invalidateForPane(e).level);this.Ju.paint(t.fullInvalidation())},i.prototype.adjustSize=function(){this.ne(),this.F.fullUpdate()},i.prototype.applyOptions=function(t){this.F.applyOptions(t),this.Qu();var e=t.width||this.Kt,n=t.height||this.nn;this.resize(e,n)},i.prototype.clicked=function(){return this.Jr},i.prototype.crosshairMoved=function(){return this.oh},i.prototype.takeScreenshot=function(){var t=this;this.Yu!==null&&(this.ie(this.Yu),this.Yu=null);var e=this.Wu[0],n=ye(document,new j(this.Kt,this.nn)),r=nt(n),s=Ht(n);return rt(r,s,function(){var o=0,h=0,a=function(){for(var R=0;R<t.Wu.length;R++){var P=t.Wu[R],L=P.getSize().h,Q=f(P.priceAxisWidget()),ct=Q.getImage();r.drawImage(ct,o,h,Q.getWidth(),L),h+=L,R<t.Wu.length-1&&(h+=1)}};t.$.priceScale.position==="left"&&(a(),o=f(e.priceAxisWidget()).getWidth()),h=0;for(var u=0;u<t.Wu.length;u++){var l=t.Wu[u],c=l.getSize(),p=l.getImage();if(r.drawImage(p,o,h,c.w,c.h),h+=c.h,u<t.Wu.length-1){var d=t.Uu[u],y=d.getSize(),v=d.getImage();r.drawImage(v,o,h,y.w,y.h),h+=y.h}}o+=e.getSize().w,t.$.priceScale.position==="right"&&(h=0,a());var m=function(){var R=f(t.Ju.stub()),P=R.getSize(),L=R.getImage();r.drawImage(L,o,h,P.w,P.h)};if(t.$.timeScale.visible){o=0,t.$.priceScale.position==="left"&&(m(),o=f(e.priceAxisWidget()).getWidth());var g=t.Ju.getSize();p=t.Ju.getImage(),r.drawImage(p,o,h,g.w,g.h),t.$.priceScale.position==="right"&&(o=e.getSize().w,m(),r.restore())}}),n},i.prototype.ne=function(){for(var t=0,e=0,n=0,r=this.Wu;n<r.length;n++){var s=r[n];this.$.priceScale.position!=="none"&&(e=Math.max(e,f(s.priceAxisWidget()).optimalWidth())),t+=s.stretchFactor()}var o=this.Kt,h=this.nn,a=Math.max(o-e,0),u=1*this.Uu.length,l=this.$.timeScale.visible?this.Ju.optimalHeight():0;l%2&&(l+=1);for(var c=u+l,p=h<c?0:h-c,d=p/t,y=0,v=0;v<this.Wu.length;++v){(s=this.Wu[v]).setState(this.F.panes()[v]);var m,g;g=v===this.Wu.length-1?p-y:Math.round(s.stretchFactor()*d),y+=m=Math.max(g,2),s.setSize(new j(a,m)),this.$.priceScale.position!=="none"&&s.setPriceAxisSize(e),s.state()&&this.F.setPaneHeight(s.state(),m)}this.Ju.setSizes(new j(a,l),e),this.F.setWidth(a),this.Hu!==e&&(this.Hu=e,this.ju.fire(e))},i.prototype.Xu=function(t){var e=t.deltaX/100,n=-t.deltaY/100;if(e!==0&&this.$.handleScroll.mouseWheel||n!==0&&this.$.handleScale.mouseWheel){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120,n*=120;break;case t.DOM_DELTA_LINE:e*=32,n*=32}if(n!==0&&this.$.handleScale.mouseWheel){var r=Math.sign(n)*Math.min(1,Math.abs(n)),s=t.clientX-this.Au.getBoundingClientRect().left;this.model().zoomTime(s,r)}e!==0&&this.$.handleScroll.mouseWheel&&this.model().scrollChart(-80*e)}},i.prototype.ie=function(t){var e=t.fullInvalidation();if(e===3&&this.se(),e===3||e===2){for(var n=this.F.panes(),r=0;r<n.length;r++)t.invalidateForPane(r).autoScale&&n[r].momentaryAutoScale();t.getFitContent()&&this.F.timeScale().fitContent();var s=t.getTargetTimeRange();s!==null&&this.F.timeScale().setTimePointsRange(s),this.Ju.update()}this.paint(t)},i.prototype.fh=function(t){var e=this;this.Yu!==null?this.Yu.merge(t):this.Yu=t,this.Ku||(this.Ku=!0,this.qu=window.requestAnimationFrame(function(){e.Ku=!1,e.qu=0,e.Yu!==null&&(e.ie(e.Yu),e.Yu=null)}))},i.prototype.se=function(){this.Gu()},i.prototype.te=function(t){this.$u.removeChild(t.getElement()),t.destroy()},i.prototype.Gu=function(){for(var t=this.F.panes(),e=t.length,n=this.Wu.length,r=e;r<n;r++){var s=F(this.Wu.pop());this.$u.removeChild(s.getElement()),s.clicked().unsubscribeAll(this),s.destroy(),(o=this.Uu.pop())!==void 0&&this.te(o)}for(r=n;r<e;r++){if((s=new lr(this,t[r])).clicked().subscribe(this.he.bind(this),this),this.Wu.push(s),r>1){var o=new ar(this,r-1,r,!0);this.Uu.push(o),this.$u.insertBefore(o.getElement(),this.Ju.getElement())}this.$u.insertBefore(s.getElement(),this.Ju.getElement())}for(r=0;r<e;r++){var h=t[r];(s=this.Wu[r]).state()!==h?s.setState(h):s.updatePriceAxisWidget()}this.Qu(),this.ne()},i.prototype.ue=function(t,e){var n,r=new Map;if(t!==null&&this.F.serieses().forEach(function(u){var l=u.dataAt(t);l!==null&&r.set(u,l)}),t!==null){var s=this.F.timeScale().indexToUserTime(t);s!==null&&(n=s)}var o=this.model().hoveredSource(),h=o!==null&&o.source instanceof at?o.source:void 0,a=o!==null&&o.object!==void 0?o.object.externalId:void 0;return{time:n,point:e||void 0,hoveredSeries:h,seriesPrices:r,hoveredObject:a}},i.prototype.he=function(t,e){var n=this;this.Jr.fire(function(){return n.ue(t,e)})},i.prototype.Zu=function(t,e){var n=this;this.oh.fire(function(){return n.ue(t,e)})},i.prototype.Qu=function(){var t=this.$.timeScale.visible?"":"none";this.Ju.getElement().style.display=t},i}();function be(i){if(!Pt(i))throw new Error("time must be of type BusinessDay");var t=new Date(Date.UTC(i.year,i.month-1,i.day,0,0,0,0));return{timestamp:Math.round(t.getTime()/1e3),businessDay:i}}function Mi(i){if(!Yt(i))throw new Error("time must be of type isUTCTimestamp");return{timestamp:i}}function xi(i){return i.length===0?null:Pt(i[0].time)?be:Mi}function Se(i){return Yt(i)?Mi(i):Pt(i)?be(i):be(_i(i))}function we(i,t){var e=i.value,n=null;return"color"in i&&i.color!==void 0&&(n=t.addColor(i.color)),[e,e,e,e,n]}function Ci(i,t){return[i.open,i.high,i.low,i.close,null]}var vr={Candlestick:Ci,Bar:Ci,Area:we,Histogram:we,Line:we};function Ti(i){return vr[i]}function Xt(i){return 60*i*60*1e3}function Me(i){return 60*i*1e3}var Jt=[{divisor:1,span:20},{divisor:1e3,span:19},{divisor:Me(1),span:20},{divisor:Me(5),span:21},{divisor:Me(30),span:22},{divisor:Xt(1),span:30},{divisor:Xt(3),span:31},{divisor:Xt(6),span:32},{divisor:Xt(12),span:33}];function Pi(i,t){if(t!==null){var e=new Date(1e3*t.timestamp),n=new Date(1e3*i.timestamp);if(n.getUTCFullYear()!==e.getUTCFullYear())return 70;if(n.getUTCMonth()!==e.getUTCMonth())return 60;if(n.getUTCDate()!==e.getUTCDate())return 50;for(var r=Jt.length-1;r>=0;--r)if(Math.floor(e.getTime()/Jt[r].divisor)!==Math.floor(n.getTime()/Jt[r].divisor))return Jt[r].span}return 20}function yr(i,t){return i.timestamp<t.timestamp}function _i(i){var t=new Date(i);if(isNaN(t.getTime()))throw new Error("Invalid date string="+i+", expected format=yyyy-mm-dd");return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function Ei(i){Z(i.time)&&(i.time=_i(i.time))}var ki,mr=function(){function i(){this.ee=new Map,this.oe=new Map,this.fe=[]}return i.prototype.destroy=function(){this.ee.clear(),this.oe.clear(),this.fe=[]},i.prototype.setSeriesData=function(t,e){var n=this;t.clearData(),function(o){o.forEach(Ei)}(e),this.ee.forEach(function(o){return o.mapping.delete(t)});var r=xi(e);r!==null&&e.forEach(function(o){var h=r(o.time),a=n.ee.get(h.timestamp)||{index:0,mapping:new Map,timePoint:h};a.mapping.set(t,o),n.ee.set(h.timestamp,a)});var s=new Map;return this.ee.forEach(function(o,h){o.mapping.size>0&&s.set(h,o)}),this.ae(s)},i.prototype.removeSeries=function(t){return this.setSeriesData(t,[])},i.prototype.updateSeriesData=function(t,e){Ei(e);var n=t.data().bars();if(n.size()>0){if(f(n.last()).time.businessDay!==void 0){if(!Pt(e.time))throw new Error("time must be of type BusinessDay")}else if(!Yt(e.time))throw new Error("time must be of type isUTCTimestamp")}var r=f(xi([e]))(e.time),s=this.ee.get(r.timestamp)||{index:0,mapping:new Map,timePoint:r},o=s.mapping.size===0;s.mapping.set(t,e);var h=!1;if(o){var a=this.ee.size;this.fe.length>0&&this.fe[this.fe.length-1].timestamp>r.timestamp?(a=ue(this.fe,r,yr),this.fe.splice(a,0,r),this.ce(a),h=!0):this.fe.push(r),s.index=a,this.oe.set(s.index,r)}this.ee.set(r.timestamp,s);var u=new Map,l=function(v){var m=F(c.oe.get(v));F(c.ee.get(m.timestamp)).mapping.forEach(function(g,M){if(h||M===t){var R=Ti(M.seriesType()),P=u.get(M)||{update:[]},L={index:v,time:m,value:R(g,M.palette())};P.update.push(L),u.set(M,P)}})},c=this;for(a=s.index;a<this.ee.size;++a)l(a);var p=o?this.le(s.index):[],d=o?this.fe.slice(s.index):[];return{timeScaleUpdate:{seriesUpdates:u,changes:d,index:s.index,marks:p}}},i.prototype.ae=function(t){var e=this;this.ee=t,this.fe=Array.from(this.ee.values()).map(function(h){return h.timePoint}),this.fe.sort(function(h,a){return h.timestamp-a.timestamp});var n=new Map;this.fe.forEach(function(h,a){var u=F(e.ee.get(h.timestamp));u.index=a,u.mapping.forEach(function(l,c){var p=Ti(c.seriesType()),d=n.get(c)||{update:[]},y={index:a,time:h,value:p(l,c.palette())};d.update.push(y),n.set(c,d)})});var r=null,s=this.fe.map(function(h,a){var u=Pi(h,r);return r=h,{span:u,time:h,index:a}}),o={seriesUpdates:n,changes:this.fe.slice(),index:0,marks:s};return this.ve(),{timeScaleUpdate:o}},i.prototype.ce=function(t){for(var e=this.oe.size-1;e>=t;--e){var n=F(this.oe.get(e)),r=e+1;F(this.ee.get(n.timestamp)).index=r,this.oe.delete(e),this.oe.set(r,n)}},i.prototype.ve=function(){var t=this;this.oe.clear(),this.ee.forEach(function(e,n){t.oe.set(e.index,e.timePoint)})},i.prototype.le=function(t){for(var e=[],n=this.oe.get(t-1)||null,r=t;r<this.oe.size;++r){var s=F(this.oe.get(r)),o=Pi(s,n);n=s,e.push({span:o,time:s,index:r})}return e},i}(),gr={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,axisLabelVisible:!0},br=function(){function i(t){this.ii=t}return i.prototype.applyOptions=function(t){this.ii.applyOptions(t)},i.prototype.options=function(){return this.ii.options()},i.prototype.priceLine=function(){return this.ii},i}(),_t=function(){function i(t,e){this._series=t,this._dataUpdatesConsumer=e}return i.prototype.destroy=function(){delete this._series,delete this._dataUpdatesConsumer},i.prototype.priceFormatter=function(){return this._series.formatter()},i.prototype.series=function(){return this._series},i.prototype.priceToCoordinate=function(t){var e=this._series.firstValue();return e===null?null:this._series.priceScale().priceToCoordinate(t,e.value)},i.prototype.coordinateToPrice=function(t){var e=this._series.firstValue();return e===null?null:this._series.priceScale().coordinateToPrice(t,e.value)},i.prototype.setData=function(t){this._dataUpdatesConsumer.applyNewData(this._series,t)},i.prototype.update=function(t){this._dataUpdatesConsumer.updateData(this._series,t)},i.prototype.setMarkers=function(t){var e=t.map(function(n){return B(B({},n),{time:Se(n.time)})});this._series.setMarkers(e)},i.prototype.applyOptions=function(t){this._series.applyOptions(t)},i.prototype.options=function(){return K(this._series.options())},i.prototype.createPriceLine=function(t){var e=w(K(gr),t),n=this._series.createPriceLine(e);return new br(n)},i.prototype.removePriceLine=function(t){this._series.removePriceLine(t.priceLine())},i}(),Sr=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return E(t,i),t.prototype.applyOptions=function(e){oi(e),i.prototype.applyOptions.call(this,e)},t}(_t),Di={width:0,height:0,layout:{backgroundColor:"#FFFFFF",textColor:"#191919",fontSize:11,fontFamily:"'Trebuchet MS', Roboto, Ubuntu, sans-serif"},crosshair:{vertLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},horzLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},mode:1},grid:{vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},priceScale:{autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,position:"right",borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,scaleMargins:{bottom:.1,top:.2}},timeScale:{rightOffset:0,barSpacing:6,fixLeftEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0},watermark:{color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,text:"",horzAlign:"center",vertAlign:"center"},localization:{locale:navigator.language,dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:!0,axisDoubleClickReset:!0,mouseWheel:!0,pinch:!0}},wr={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Mr={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},xr={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4},Cr={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4},Tr={color:"#26a69a",base:0},Et={title:"",lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}},Pr=function(){function i(t){this.l=t}return i.prototype.destroy=function(){delete this.l},i.prototype.applyOptions=function(t){this.l.applyOptions({priceScale:t})},i.prototype.options=function(){return this.B().options()},i.prototype.B=function(){return this.l.mainPriceScale()},i}();(function(i){i[i.AnimationDurationMs=1e3]="AnimationDurationMs"})(ki||(ki={}));var _r=function(){function i(t){this.F=t}return i.prototype.destroy=function(){delete this.F},i.prototype.scrollPosition=function(){return this.$n().rightOffset()},i.prototype.scrollToPosition=function(t,e){e?this.$n().scrollToOffsetAnimated(t,1e3):this.$n().setRightOffset(t)},i.prototype.scrollToRealTime=function(){this.$n().scrollToRealTime()},i.prototype.getVisibleRange=function(){var t=this.$n().visibleBars();if(t===null)return null;var e=this.F.timeScale().points(),n=f(e.firstIndex()),r=f(e.lastIndex());return{from:Ri(f(e.valueAt(Math.max(n,t.firstBar())))),to:Ri(f(e.valueAt(Math.min(r,t.lastBar()))))}},i.prototype.setVisibleRange=function(t){var e={from:Se(t.from),to:Se(t.to)};this.F.setTargetTimeRange(e)},i.prototype.resetTimeScale=function(){this.F.resetTimeScale()},i.prototype.fitContent=function(){this.F.fitContent()},i.prototype.applyOptions=function(t){this.$n().applyOptions(t)},i.prototype.options=function(){return K(this.$n().options())},i.prototype.$n=function(){return this.F.timeScale()},i}();function Ri(i){return i.businessDay||i.timestamp}function kt(i){if(i!==void 0&&i.type!=="custom"){var t=i;t.minMove!==void 0&&t.precision===void 0&&(t.precision=function(e){if(e>=1)return 0;for(var n=0;n<8;n++){var r=Math.round(e);if(Math.abs(r-e)<1e-8)return n;e*=10}return n}(t.minMove))}}function Li(i){var t=i.handleScale;Ot(t)&&(i.handleScale={axisDoubleClickReset:t,axisPressedMouseMove:t,mouseWheel:t,pinch:t});var e=i.handleScroll;return Ot(e)&&(i.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e}),i}var Er=function(){function i(t,e){var n=this;this.de=new mr,this.Me=new W,this.we=new Map,this.be=new Map,this.me=new W,this.pe=new W;var r=e===void 0?K(Di):w(K(Di),Li(e));this.ur=new dr(t,r),this.ur.model().timeScale().visibleBarsChanged().subscribe(this.ge.bind(this)),this.ur.clicked().subscribe(function(o){n.me.hasListeners()&&n.me.fire(n.ye(o()))},this),this.ur.crosshairMoved().subscribe(function(o){n.pe.hasListeners()&&n.pe.fire(n.ye(o()))},this);var s=this.ur.model();this.ke=new Pr(s),this.Ne=new _r(s)}return i.prototype.remove=function(){this.ur.model().timeScale().visibleBarsChanged().unsubscribeAll(this),this.ur.clicked().unsubscribeAll(this),this.ur.crosshairMoved().unsubscribeAll(this),this.ke.destroy(),this.Ne.destroy(),this.ur.destroy(),delete this.ur,this.we.forEach(function(t,e){e.destroy()}),this.we.clear(),this.be.clear(),this.Me.destroy(),this.me.destroy(),this.pe.destroy(),this.de.destroy(),delete this.de},i.prototype.resize=function(t,e,n){this.ur.resize(t,e,n)},i.prototype.addAreaSeries=function(t){t===void 0&&(t={}),kt(t.priceFormat);var e=w(K(Et),Cr,t),n=this.ur.model().createSeries("Area",e),r=new _t(n,this);return this.we.set(r,n),this.be.set(n,r),r},i.prototype.addBarSeries=function(t){t===void 0&&(t={}),kt(t.priceFormat);var e=w(K(Et),Mr,t),n=this.ur.model().createSeries("Bar",e),r=new _t(n,this);return this.we.set(r,n),this.be.set(n,r),r},i.prototype.addCandlestickSeries=function(t){t===void 0&&(t={}),oi(t),kt(t.priceFormat);var e=w(K(Et),wr,t),n=this.ur.model().createSeries("Candlestick",e),r=new Sr(n,this);return this.we.set(r,n),this.be.set(n,r),r},i.prototype.addHistogramSeries=function(t){t===void 0&&(t={}),kt(t.priceFormat);var e=w(K(Et),Tr,t),n=this.ur.model().createSeries("Histogram",e),r=new _t(n,this);return this.we.set(r,n),this.be.set(n,r),r},i.prototype.addLineSeries=function(t){t===void 0&&(t={}),kt(t.priceFormat);var e=w(K(Et),xr,t),n=this.ur.model().createSeries("Line",e),r=new _t(n,this);return this.we.set(r,n),this.be.set(n,r),r},i.prototype.removeSeries=function(t){var e=t,n=F(this.we.get(e)),r=this.de.removeSeries(n),s=this.ur.model();s.removeSeries(n);var o=r.timeScaleUpdate;s.updateTimeScale(o.index,o.changes,o.marks,!0),o.seriesUpdates.forEach(function(h,a){a.updateData(h.update)}),s.updateTimeScaleBaseIndex(0),this.we.delete(e),this.be.delete(n)},i.prototype.applyNewData=function(t,e){var n=this.de.setSeriesData(t,e),r=this.ur.model(),s=n.timeScaleUpdate;r.updateTimeScale(s.index,s.changes,s.marks,!0),s.seriesUpdates.forEach(function(o,h){h.updateData(o.update,!0)}),r.updateTimeScaleBaseIndex(0)},i.prototype.updateData=function(t,e){var n=this.de.updateSeriesData(t,e),r=this.ur.model(),s=n.timeScaleUpdate;r.updateTimeScale(s.index,s.changes,s.marks,!1),s.seriesUpdates.forEach(function(o,h){h.updateData(o.update)}),r.updateTimeScaleBaseIndex(0)},i.prototype.subscribeClick=function(t){this.me.subscribe(t)},i.prototype.unsubscribeClick=function(t){this.me.unsubscribe(t)},i.prototype.subscribeCrosshairMove=function(t){this.pe.subscribe(t)},i.prototype.unsubscribeCrosshairMove=function(t){this.pe.unsubscribe(t)},i.prototype.subscribeVisibleTimeRangeChange=function(t){this.Me.subscribe(t)},i.prototype.unsubscribeVisibleTimeRangeChange=function(t){this.Me.unsubscribe(t)},i.prototype.priceScale=function(){return this.ke},i.prototype.timeScale=function(){return this.Ne},i.prototype.applyOptions=function(t){this.ur.applyOptions(Li(t))},i.prototype.options=function(){return this.ur.options()},i.prototype.takeScreenshot=function(){return this.ur.takeScreenshot()},i.prototype.ge=function(){this.Me.hasListeners()&&this.Me.fire(this.timeScale().getVisibleRange())},i.prototype.Se=function(t){return F(this.be.get(t))},i.prototype.ye=function(t){var e=this,n=new Map;t.seriesPrices.forEach(function(s,o){n.set(e.Se(o),s)});var r=t.hoveredSeries===void 0?void 0:this.Se(t.hoveredSeries);return{time:t.time&&(t.time.businessDay||t.time.timestamp),point:t.point,hoveredSeries:r,hoveredMarkerId:t.hoveredObject,seriesPrices:n}},i}();function Oi(i,t){var e=f(Z(i)?document.getElementById(i):i);return new Er(e,t)}function kr(){return"2.0.0"}var Dr=x(1),Fi=x.n(Dr);function Zt(i){return(Zt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(i)}function Vi(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);t&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,n)}return e}function zi(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Vi(Object(e),!0).forEach(function(n){X(i,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Vi(Object(e)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(e,n))})}return i}function Ai(i,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function Bi(i,t){return(Bi=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(i,t)}function Rr(i){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,n=xe(i);if(t){var r=xe(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Lr(this,e)}}function Lr(i,t){return!t||Zt(t)!=="object"&&typeof t!="function"?q(i):t}function q(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function xe(i){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(i)}function X(i,t,e){return t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}var Or={candlestick:"addCandlestickSeries",line:"addLineSeries",area:"addAreaSeries",bar:"addBarSeries",histogram:"addHistogramSeries"},Ii=["#008FFB","#00E396","#FEB019","#FF4560","#775DD0","#F86624","#A5978B"],Ni={layout:{backgroundColor:"#131722",lineColor:"#2B2B43",textColor:"#D9D9D9"},grid:{vertLines:{color:"#363c4e"},horzLines:{color:"#363c4e"}}},$i={layout:{backgroundColor:"#FFFFFF",lineColor:"#2B2B43",textColor:"#191919"},grid:{vertLines:{color:"#e1ecf2"},horzLines:{color:"#e1ecf2"}}},Fr=function(i){(function(o,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(h&&h.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),h&&Bi(o,h)})(s,i);var t,e,n,r=Rr(s);function s(o){var h;return function(a,u){if(!(a instanceof u))throw new TypeError("Cannot call a class as a function")}(this,s),X(q(h=r.call(this,o)),"resizeHandler",function(){var a=h.props.autoWidth&&h.chartDiv.current&&h.chartDiv.current.parentNode.clientWidth,u=h.props.autoHeight&&h.chartDiv.current?h.chartDiv.current.parentNode.clientHeight:h.props.height||500;h.chart.resize(a,u)}),X(q(h),"removeSeries",function(){h.series.forEach(function(a){return h.chart.removeSeries(a)}),h.series=[]}),X(q(h),"addSeries",function(a,u){var l=Or[u],c=a.options&&a.options.color||Ii[h.series.length%Ii.length],p=h.chart[l](zi({color:c},a.options)),d=h.handleLinearInterpolation(a.data,a.linearInterpolation);return p.setData(d),a.markers&&p.setMarkers(a.markers),a.priceLines&&a.priceLines.forEach(function(y){return p.createPriceLine(y)}),a.legend&&h.addLegend(p,c,a.legend),p}),X(q(h),"handleSeries",function(){var a=h.series,u=h.props;u.candlestickSeries&&u.candlestickSeries.forEach(function(l){a.push(h.addSeries(l,"candlestick"))}),u.lineSeries&&u.lineSeries.forEach(function(l){a.push(h.addSeries(l,"line"))}),u.areaSeries&&u.areaSeries.forEach(function(l){a.push(h.addSeries(l,"area"))}),u.barSeries&&u.barSeries.forEach(function(l){a.push(h.addSeries(l,"bar"))}),u.histogramSeries&&u.histogramSeries.forEach(function(l){a.push(h.addSeries(l,"histogram"))})}),X(q(h),"unsubscribeEvents",function(a){var u=h.chart;u.unsubscribeClick(a.onClick),u.unsubscribeCrosshairMove(a.onCrosshairMove),u.timeScale().unsubscribeVisibleTimeRangeChange(a.onTimeRangeMove)}),X(q(h),"handleEvents",function(){var a=h.chart,u=h.props;u.onClick&&a.subscribeClick(u.onClick),u.onCrosshairMove&&a.subscribeCrosshairMove(u.onCrosshairMove),u.onTimeRangeMove&&a.timeScale().subscribeVisibleTimeRangeChange(u.onTimeRangeMove),a.subscribeCrosshairMove(h.handleLegends)}),X(q(h),"handleTimeRange",function(){var a=h.props,u=a.from,l=a.to;u&&l&&h.chart.timeScale().setVisibleRange({from:u,to:l})}),X(q(h),"handleLinearInterpolation",function(a,u){if(!u||a.length<2||!a[0].value)return a;var l=a[0].time,c=a[a.length-1].time,p=new Array(Math.floor((c-l)/u));p[0]=a[0];for(var d=1,y=1;y<a.length;y++){p[d++]=a[y];for(var v=a[y-1].time,m=a[y-1].value,g=a[y],M=g.time,R=g.value,P=v;P<M-u;P+=u){var L=m+(R-m)/(M-v)*(P-v);p[d++]={time:P,value:L}}}return p.filter(function(Q){return Q})}),X(q(h),"handleUpdateChart",function(){window.removeEventListener("resize",h.resizeHandler);var a=q(h),u=a.chart,l=a.chartDiv,c=h.props,p=h.props.darkTheme?Ni:$i;p=Vr(p,zi({width:c.autoWidth?l.current.parentNode.clientWidth:c.width,height:c.autoHeight?l.current.parentNode.clientHeight:c.height||500},c.options)),u.applyOptions(p),h.legendDiv.current&&(h.legendDiv.current.innerHTML=""),h.legends=[],h.props.legend&&h.handleMainLegend(),h.handleSeries(),h.handleEvents(),h.handleTimeRange(),(c.autoWidth||c.autoHeight)&&window.addEventListener("resize",h.resizeHandler)}),X(q(h),"addLegend",function(a,u,l){h.legends.push({series:a,color:u,title:l})}),X(q(h),"handleLegends",function(a){var u=h.legendDiv.current;a.time&&u&&h.legends.length&&(u.innerHTML="",h.legends.forEach(function(l){var c=l.series,p=l.color,d=l.title,y=a.seriesPrices.get(c);if(y!==void 0){Zt(y)=="object"&&(p=y.open<y.close?"rgba(0, 150, 136, 0.8)":"rgba(255,82,82, 0.8)",y="O: ".concat(y.open,", H: ").concat(y.high,", L: ").concat(y.low,", C: ").concat(y.close));var v=document.createElement("div");v.innerText=d+" ";var m=document.createElement("span");m.style.color=p,m.innerText=" "+y,v.appendChild(m),u.appendChild(v)}}))}),X(q(h),"handleMainLegend",function(){if(h.legendDiv.current){var a=document.createElement("div");a.innerText=h.props.legend,h.legendDiv.current.appendChild(a)}}),h.chartDiv=b.a.createRef(),h.legendDiv=b.a.createRef(),h.chart=null,h.series=[],h.legends=[],h}return t=s,(e=[{key:"componentDidMount",value:function(){this.chart=Oi(this.chartDiv.current),this.handleUpdateChart(),this.resizeHandler()}},{key:"componentDidUpdate",value:function(h){this.props.autoWidth||this.props.autoHeight||window.removeEventListener("resize",this.resizeHandler),Fi()([h.onCrosshairMove,h.onTimeRangeMove,h.onClick],[this.props.onCrosshairMove,this.props.onTimeRangeMove,this.props.onClick])||this.unsubscribeEvents(h),Fi()([h.options,h.darkTheme,h.candlestickSeries,h.lineSeries,h.areaSeries,h.barSeries,h.histogramSeries],[this.props.options,this.props.darkTheme,this.props.candlestickSeries,this.props.lineSeries,this.props.areaSeries,this.props.barSeries,this.props.histogramSeries])?h.from===this.props.from&&h.to===this.props.to||this.handleTimeRange():(this.removeSeries(),this.handleUpdateChart())}},{key:"render",value:function(){var h=this.props.darkTheme?Ni.layout.textColor:$i.layout.textColor;return b.a.createElement("div",{ref:this.chartDiv,style:{position:"relative"}},b.a.createElement("div",{ref:this.legendDiv,style:{position:"absolute",zIndex:2,color:h,padding:10}}))}}])&&Ai(t.prototype,e),n&&Ai(t,n),s}(b.a.Component),Ce=(V.default=Fr,function(i){return i&&Zt(i)==="object"&&!Array.isArray(i)}),Vr=function i(t,e){var n=Object.assign({},t);return Ce(t)&&Ce(e)&&Object.keys(e).forEach(function(r){Ce(e[r])&&r in t?n[r]=i(t[r],e[r]):Object.assign(n,X({},r,e[r]))}),n}}])}}]);
